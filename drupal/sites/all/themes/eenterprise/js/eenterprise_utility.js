!function(a){function b(b,c,d){var e=a(c),f=a(d).find(".field-add-more-submit");b||e.find("tr:last").find("td:nth-child(2)").append(f)}function c(){var b=a("#zipcode_description").find(".field-multiple-table"),c=a("#profile-locations"),d=c.find(".field-add-more-submit"),e=b.find("tr:last").find("td:nth-child(2)").find(".field-add-more-submit");0==e.length&&(table_id=b.attr("id")),c.find("tr:last").find("td:nth-child(2)").append(d),c.find("tr:last .field_zip_code").focus()}function d(){var b=!1,c=!1,d=a("#zipcode_description");v.find(".field-multiple-table").removeClass("sticky-enabled"),a("#profile-locations").find(".sticky-header").remove();var f=d.find(".field-multiple-table"),g=f.find("input[type=checkbox]"),h=g.next("div"),i=f.find("input[type=checkbox]:checked");if(!a(h).hasClass("zip-code-primary-holder")){g.after('<div class="zip-code-primary-holder"><a href="javascript:void(0)" title="Set to default location" class="zip-code-primary-select"><i class="fa fa-star-o" aria-hidden="true"></i><span class="sr-only">Set to default location</span></a></div>');var j=i.next(".zip-code-primary-holder").find(".zip-code-primary-select");j.addClass("selected"),j.prop("title","Default location");var k=j.find("i");k.removeClass("fa-star-o"),k.addClass("fa-star");var l=j.find(".sr-only");l.text("Default location")}0==f.find("input[type=checkbox]:checked").length&&e();var m=a(".city-state-lookup-zips");0==m.length?(a(".form-submit").prop("disabled",!1),f.find("tr:last").find(".field_zip_code").focus()):(a(".form-submit").prop("disabled",!0),m.focus());var q;a(".field-suffix").hasClass("error")?(c=!0,q=a(".field-suffix.error").closest("td").find(".field_zip_code"),q.focus()):b=!0,w>0&&(c=!0),c&&o(),b&&!p()&&n();var r=a("#links_description").find(".field-add-more-submit");r.prop("value","New favorite").addClass("usa-button"),a(".field_zip_code").prop("disabled",!1)}function e(){a("#zipcode_description").find(".field-multiple-table").find("tr:nth-child(1)").find(".zip-code-primary-select").click()}function f(b,c){var d=a("#edit-field-community-type-und"),e=a("#edit-field-community-size-und");if(d.val("_none").find('input[value="_none"]').prop("checked",!0),e.find('option[value="_none"]').prop("selected",!0),"undefined"!=typeof b&&""!==b&&parseInt(b)>=0){var f=parseInt(b);f<5e3?e.find('option:contains("0 - 5,000")').prop("selected",!0):f<1e4?e.find('option:contains("5,000 - 10,000")').prop("selected",!0):f<25e3?e.find('option:contains("10,000 - 25,000")').prop("selected",!0):f<1e5?e.find('option:contains("25,000 - 100,000")').prop("selected",!0):f<1e6?e.find('option:contains("100,000 - 1,000,000")').prop("selected",!0):e.find('option:contains("1,000,000+")').prop("selected",!0)}"undefined"!=typeof c&&""!==c&&"NaN"!==c.toString()&&(1===c?d.val("urban").find('input[value="urban"]').prop("checked",!0):0===c?d.val("rural").find('input[value="rural"]').prop("checked",!0):d.val("rural").find('input[value="_none"]').prop("checked",!0))}function g(b){"undefined"==typeof b&&(b=""),z={};var c=0;a("[id*=field-zip-code-values]").find("tr").each(function(d){var e=a(this),g=e.find(".field_zip_code"),h=g.attr("id"),i=e.find(".field-suffix");if(i.hasClass("field-suffix-data")||(i=i.find(".field-suffix-data")),h==b||null==h)return c+=1,!0;if(i.hasClass("error"))return!0;d-=c;var j=e.find(".field_zip_code").val(),k=i.text().trim(),l=e.find(".field-name-field-field-primary input").prop("checked"),m=i.attr("isurban");"_none"!==m&&(m=parseInt(i.attr("isurban")));var n=parseInt(i.attr("commsize"));l?(l=1,C?C=!1:f(n,m)):l=0,""!=k&&""!=j&&(z[k]||(z[k]={}),z[k][j]={},z[k][j].primary=l,z[k][j].delta=d,z[k][j].commsize=n,z[k][j].is_urban=m)});var d=JSON.stringify(z);a("#edit-zip-mapping").val(d)}function h(a,b){return b=parseInt(b),a=a.trim(),z[a]&&z[a][b]}function i(a,b){return a.indexOf(b)>=0}function j(b){if(a(".remove-button").prop("disabled",!0),a("input.field_zip_code").prop("disabled",!0),"all"!=b){var c=b.closest("tr").find(".remove-button").attr("id");a("#"+c).attr("disabled",!1),b.closest("tr").find(".field_zip_code").prop("disabled",!1)}}function k(a,b){u=a.prev().val(),y=!0,a.parent().hasClass("field-suffix")?(a.parent().addClass("error"),a.parent().attr("id","zip-code-error"),a.parent().prev().attr("aria-describedby","zip-code-error")):(a.addClass("error"),a.attr("id","zip-code-error"),a.prev().attr("aria-describedby","zip-code-error")),a.html(b),t=!0,g(),o()}function l(b,c,e,f){var i=f.closest("td").find(".field-add-more-submit"),l=f.closest("td").find(".remove-button"),m=f.closest("td").find(".zip-code-primary-holder"),q=(f.val(),f.next(".field-suffix"));q.hasClass("field-suffix-data")||(q=q.find(".field-suffix-data"));var c,r="";i.hide(),l.hide(),m.hide(),"zip"==b?(r="Select a location for "+f.val()+":",c=a(e.city_select)):(r="Select a zip code for "+f.val()+":",c=a(e.zip_select));var s=a('<label id="zip-label" for="city-state-lookup-zips">'+r+"</label>");c.addClass("city-state-lookup-zips");var t=a('<button type="button" class="usa-button" id ="user-profile-select-zip">Select</button>'),u=a('<button type="button" class="usa-button-outline" id="user-profile-back-zip">Back</button>');f.prop("disabled",!0),0==w&&(f.after(s),s.after(c),w+=1),o(),q.html(t),q.append(u),a(".form-submit").prop("disabled",!0),c.focus(),u.on("click",function(){x=!0,w=0,q.html(""),f.prop("disabled",!1),a("#profile-locations").find("#city-state-lookup-zips").remove(),u.remove(),t.remove(),s.remove(),c.remove(),l.show(),i.show(),m.show(),q.addClass("error"),q.html("Please update your location or remove this field before saving."),j(f),f.prop("disabled",!1),f.focus(),g()}),t.on("click",function(){var a=f.val(),i=c.val(),o="",r="",v="",x="",y=!1;u.remove(),t.remove(),"zip"==b?(o=i,r=a,h(o,r)?(k(q,"Duplicate location name and zip code pairs are not allowed."),j(f),y=!0):(f.val(r),e.zip_attr&&r in e.zip_attr&&(v=e.zip_attr[r].pop,x=e.zip_attr[r].urban),e.city_attr&&o in e.city_attr&&(v=e.city_attr[o].pop),0===parseInt(v)&&(v=-1),"Urban"==x?q.attr("isurban","1"):"Rural"==x&&q.attr("isurban","0"),q.text(o).attr("commsize",v))):(r=i,o=e.zip_attr[i].city,h(o,r)?(k(q,"Duplicate location name and zip code pairs are not allowed."),j(f),y=!0):(q.html("<span>"+o+"</span>"),f.val(r),e.zip_attr&&r in e.zip_attr&&(v=e.zip_attr[r].pop,x=e.zip_attr[r].urban),e.city_attr&&o in e.city_attr&&(v=e.city_attr[o].pop),"Urban"==x?q.attr("isurban","1"):"Rural"==x&&q.attr("isurban","0"),q.text(o).attr("commsize",v))),s.remove(),c.remove(),l.show(),m.show(),w=0,y||(q.attr("commsize",v),"Urban"==x?q.attr("isurban","1"):"Rural"==x&&q.attr("isurban","0"),g(),d(),p()||n()),f.prop("disabled",!1),f.focus()})}function m(b,e){var f;if("button"!=e&&""!=b.val()&&o(),"button"==e||"select"==e){var i=b.id;f=a(i).closest("td").find(".field_zip_code")}if("textfield"==e){f=b;var m=f.next(".field-suffix");if(m.hasClass("field-suffix-data")||(0===m.find(".field-suffix-data").length?m.addClass("field-suffix-data"):m=m.find(".field-suffix-data")),m.hasClass("error")&&m.removeClass("error"),m.parent().hasClass("error")&&m.parent().removeClass("error"),""==a.trim(f.val()))m.html("");else{var q=f.attr("aria-describedby");m.attr("id",q),m.html("Loading..."),j("all"),Drupal.settings.locationInputEngine.lookUpLocation(f.val()).done(function(b){var e,i,o=-1,q="",r=!1;if(g(f.attr("id")),b.zip_codes){var s=b.zip_array.length;if(s>1)return void l("city",b.zip_select,b,f);e=b.zip_array[0],i=b.city,f.val(e),""!=b.state&&(i=i+", "+b.state),h(i,e)&&(k(m,"Duplicate location name ("+i+") and zip code pairs are not allowed."),j(f),r=!0),r||(b.zip_attr&&e in b.zip_attr&&(o=b.zip_attr[e].pop,q=b.zip_attr[e].urban),b.city_attr&&i in b.city_attr&&(o=b.city_attr[i].pop),0===parseInt(o)&&(o=-1),m.html(i),m.attr("commsize",o),"Urban"==q?m.attr("isurban","1"):"Rural"==q&&m.attr("isurban","0"),d(),g())}else{if(b.city_select)return void l("zip",b.city_select,b,f);e=b.zip?b.zip:b.zip_array[0],i=b.city[0],h(i,e)&&(k(m,"Duplicate location name ("+i+") and zip code pairs are not allowed."),j(f),r=!0),r||(m.html(i),b.zip_attr&&e in b.zip_attr&&(o=b.zip_attr[e].pop,q=b.zip_attr[e].urban),b.city_attr&&i in b.city_attr&&(o=b.city_attr[i].pop),0===parseInt(o)&&(o=-1),m.attr("commsize",o),"Urban"==q?m.attr("isurban","1"):"Rural"==q&&m.attr("isurban","0"),g(),a(".remove-button").prop("disabled",!1))}p()||n(),c(),a("#profile-locations").find("tr:last").find(".field_zip_code").focus()}).fail(function(a){k(m,a.error_message),j(f),v.find("#zip-code-error").prev(".field_zip_code").focus()})}}}function n(){v.find(".field-add-more-submit").show(),a("#edit-field-zip-code .field-add-more-submit").prop("disabled",!1),a("#edit-submit").prop("disabled",!1),a("#edit-submit--2").prop("disabled",!1),a("#edit-delete").prop("disabled",!1),a(".field_zip_code").prop("disabled",!1)}function o(){a("#edit-field-zip-code").find(".field-add-more-submit").prop("disabled",!0),a("#edit-submit").prop("disabled",!0),a("#edit-submit--2").prop("disabled",!0),a("#edit-delete").prop("disabled",!0)}function p(){var b=a("#edit-field-zip-code").find(".error").length;return b>0}function q(b){var c,d=b.text(),e=d.replace(/,/g,"").replace(" ","").replace("+",""),f=e.indexOf("-");c=f>-1?e.substr(0,e.indexOf("-")):e;var g=parseInt(c),h=a(".field-name-field-field-primary").find("input:checked"),i=h.closest("tr").find(".field-suffix");i.find(".field-suffix-data").length>0?i.find(".field-suffix-data").attr("commsize",g):i.attr("commsize",g)}function r(b){var c=a(".field-name-field-field-primary").find("input:checked"),d=c.closest("tr").find(".field-suffix"),e="_none";"urban"===b?e=1:"rural"===b&&(e=0),d.find(".field-suffix-data").length<=0?d.attr("isurban",e):d.find(".field-suffix-data").attr("isurban",e)}var s,t,u,v=a("body"),w=0,x=!1,y=!1,z={},A=!1,B=!1,C=!0;Drupal.behaviors.DisableInputEnter={attach:function(b,c){a(".field_zip_code",b).once("disable-input-enter",function(){a(this).keypress(function(b){var c=a(this);13===b.keyCode&&(A=!0,c.blur(),b.preventDefault())})})}},a(document).ready(function(){var e=a("#edit-field-community-type-und");0===e.find("input:checked").length&&e.val("_none").find('input[value="_none"]').prop("checked",!0),e.find("input").change(function(){var b=a(this).val();r(b),g()}),a("#edit-field-community-size-und").change(function(){q(a(this).find("option:selected")),g()}),v.find(".field-multiple-table").removeClass("sticky-enabled"),a("#profile-locations").find(".sticky-header").remove(),a(document).click(function(b){s=a(b.target)}),v.on("click",".zip-code-primary-select",function(){var b=a(this).closest("tr").find(".field-suffix");b.hasClass("field-suffix-data")||(b=b.find(".field-suffix-data"));var c=b.attr("commsize"),d=b.attr("isurban");a(".zip-code-primary-select.selected").removeClass("selected"),a(".zip-code-primary-select").prop("title","Set to default location"),a(".zip-code-primary-select").closest("td").find("input[type=checkbox]:checked").prop("checked",!1);var e=a(".zip-code-primary-select").find("i");e.addClass("fa-star-o"),e.removeClass("fa-star");var h=a(this);h.addClass("selected"),h.prop("title","Default location");var i=h.find("i");i.removeClass("fa-star-o"),i.addClass("fa-star"),i.closest("td").find("input[type=checkbox]").prop("checked",!0);var j=a(this).find(".sr-only");j.text("Default location"),f(c,d),g()}),v.on("click",".zip-code-primary-select.selected",function(){a(this).removeClass("selected"),a(this).prop("title","Set to default location");var b=a(this).find("i");b.removeClass("fa-star"),b.addClass("fa-star-o"),b.closest("td").find("input[type=checkbox]").prop("checked",!1);var c=a(this).find(".sr-only");c.text("Set to default location")}),v.on("focus",".field_zip_code",function(){u=a(this).val(),a(".field_zip_code").on("change",function(){a(".form-submit").prop("disabled",!0)}),a(".field_zip_code").keyup(function(b){""!=a(this).val()&&u!=a(this).val()&&o()})}),a("#user-profile-select-zip").on("keyup",function(b){13==b.which&&a(this).trigger("click")}),v.on("blur",".field_zip_code",function(b){(u!=a(this).val()||A||B)&&(fieldChanged=a(b.target),m(fieldChanged,"textfield"),A=!1,B=!1)}),v.on("click",".form-submit",function(b){s=a(b.target),m(s,"button")}),v.on("click","button",function(b){s=a(b.target),m(s,"button"),a(".field-suffix").hasClass("error")&&o(),a(this).closest(".field_zip_code").focus()});var h=window.location.pathname,j=h.split("/")[1];"user"===j&&(a("#edit-submit").prependTo(".edit-user-profile"),a(document).ajaxSuccess(function(e,f,h){var j=h.url;if("/multifield/field-remove-item/ajax"==j&&(p()?o():n(),g()),"/system/ajax"==j||"/multifield/field-remove-item/ajax"==j){var k="",l="";a(".field-multiple-table").each(function(){var b=a(this),c=b.find("tr:last").find("td:nth-child(2)").find(".field-add-more-submit");0==c.length&&(k=b.attr("id"))}),l=i(k,"zip-code")?"#zipcode_description":"#links_description",""!=k&&b(!1,"#"+k,l),d()}c()}),$org_select=a("#edit-field-organization select"),$org_select.change(function(){$local_gov_opts=a(".local-government-options"),"Local government"==a(this).find("option:selected").text()?$local_gov_opts.show():$local_gov_opts.hide()}),Drupal.tableDrag.prototype.row.prototype.onSwap=function(c){var d=a(c).closest("table"),e="#"+d.attr("id"),f="";f=i(e,"zip-code")?"#zipcode_description":"#links_description",b(!1,e,f)},a("#profile-tabs").tabs(),g()),"app-connect"==j&&a("#app-connect-tabs").tabs(),a("#edit-delete").click(function(b){var c=a(this);a.fancybox({content:a("#delete-holder"),width:400,height:150,autoSize:!1}),a("#confirm-delete-profile").unbind("click").click(function(){c.unbind("click"),c.trigger("click")}),a("#cancel-delete-profile").unbind("click").click(function(){a.fancybox.close()}),b.preventDefault()}),a(".remove-button").click(function(){}),d(),b(!1,"#field-zip-code-values","#zipcode_description"),a("#zipcode_description").show()})}(jQuery);
//# sourceMappingURL=src/eenterprise_utility.js.map