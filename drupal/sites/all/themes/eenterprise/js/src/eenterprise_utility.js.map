{"version":3,"sources":["eenterprise_utility.js"],"names":["$","placeAddAnotherButton","ajax_content","table_id","parent_id","table","input_button","find","append","moveAddButton","$profile_locations","addMoreBtn","add_button","length","attr","focus","processPrimaryFields","reset_buttons","hide_buttons","$zipcode_description","$body","removeClass","remove","checkboxes","starsSpot","next","selection","hasClass","after","primary_indicator","addClass","prop","primary_indicator_star","screenreader_indicator","text","setPrimaryZip","$city_lookup","fixInput","closest","numSelects","hideButtons","existingLocationErrors","resetButtons","$field_add_more_submit","click","setCommunitySizeType","commsize","isurban","$urban_check","$comm_size_select","val","parseInt","selected_pop","toString","update_user_zip_preferences","input_to_ignore","location_obj","count_ignore_tr","each","index","$tr","this","$zip_code_input","zip_id","$field_suffix","zip","name","trim","primary","urban","pop","initial_load","delta","is_urban","json_value","JSON","stringify","check_duplicate","location_name","zip_val","inString","str","substring","indexOf","disable_zip_buttons","remove_to_ignore","print_error_message","message","lastVal","prev","failedLookup","parent","html","are_there_errors","appendSelect","input_type","select","location_data","input","remove_button","field_suffix","label_select_string","hide","city_select","zip_select","label_select","confirm","back","on","removedSelect","show","input_value","select_value","duplicate","zip_attr","city_attr","city","checkLocation","fieldToCheck","type","clicked_id","id","ariaid","Drupal","settings","locationInputEngine","lookUpLocation","done","zip_codes","count_zips_returned","zip_array","state","fail","error_message","num_errors","updatePrimaryLocationDataSize","$select_elem","number_text","select_text","replace_text","replace","location_of_dash","substr","number","$primary","updatePrimaryLocationDataUrban","mouse_click","enter_pressed","show_locations_again","behaviors","DisableInputEnter","attach","context","once","keypress","e","$elem","keyCode","blur","preventDefault","document","ready","change","target","comm_size","original_star","selected_icon","selected_icon_star","keyup","which","trigger","fieldChanged","path","window","location","pathname","page","split","prependTo","ajaxSuccess","event","xhr","target_url","url","$org_select","$local_gov_opts","tableDrag","prototype","row","onSwap","swappedRow","tabs","delete_button","fancybox","content","width","height","autoSize","unbind","close","jQuery"],"mappings":"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","file":"eenterprise_utility.js","sourcesContent":["(function ($) {\n  var $body = $('body');\n  var numSelects = 0;\n  var type;\n  var removedSelect = false;\n  var failedLookup = false;\n  var mouse_click;\n  var are_there_errors;\n  var lastVal;\n  // Map of location and zip data\n  var location_obj = {};\n  // Flags for when to search for location information\n  var enter_pressed = false; // When user deliberately presses enter in a location\n  var show_locations_again = false; // When the location errored but returned multiple options.\n  var initial_load = true;\n\n  // Disables entering the form by key press when focused on an input\n  // Specific to E-Enterprise User Profile forms to disable accidental form submission if user presses Enter key\n  // while ZIP code field is focused  \n  Drupal.behaviors.DisableInputEnter = {\n    attach: function (context, settings) {\n      $('.field_zip_code', context).once('disable-input-enter', function () {\n        $(this).keypress(function (e) {\n          var $elem = $(this);\n          if (e.keyCode === 13) {\n            enter_pressed = true;\n            $elem.blur();\n            e.preventDefault();\n          }\n        });\n      });\n    }\n  };\n\n  function placeAddAnotherButton(ajax_content, table_id, parent_id) {\n    var table = $(table_id);\n    var input_button = $(parent_id).find('.field-add-more-submit');\n    if (!ajax_content) {\n      // Add the + button next to the Remove button\n      table.find(\"tr:last\").find('td:nth-child(2)').append(input_button);\n    }\n  }\n\n  function moveAddButton() {\n    var table = $('#zipcode_description').find('.field-multiple-table');\n    var $profile_locations = $('#profile-locations');\n    var addMoreBtn = $profile_locations.find('.field-add-more-submit');\n    var add_button = table.find('tr:last').find('td:nth-child(2)').find('.field-add-more-submit');\n    if (add_button.length == 0) {\n      table_id = table.attr('id');\n    }\n    $profile_locations.find('tr:last').find('td:nth-child(2)').append(addMoreBtn);\n    $profile_locations.find('tr:last .field_zip_code').focus();\n  }\n\n  function processPrimaryFields() {\n    var reset_buttons = false;\n    var hide_buttons = false;\n    var $zipcode_description = $('#zipcode_description');\n    $body.find('.field-multiple-table').removeClass('sticky-enabled');\n    $('#profile-locations').find('.sticky-header').remove();\n    var table = $zipcode_description.find('.field-multiple-table');        // cache the target table DOM element\n    var checkboxes = table.find('input[type=checkbox]');\n    var starsSpot = checkboxes.next('div');\n    var selection = table.find('input[type=checkbox]:checked');\n\n    if (!$(starsSpot).hasClass('zip-code-primary-holder')) {\n      checkboxes.after('<div class=\"zip-code-primary-holder\"><a href=\"javascript:void(0)\" title=\"Set to default location\" class=\"zip-code-primary-select\"><i class=\"fa fa-star-o\" aria-hidden=\"true\"></i><span class=\"sr-only\">Set to default location</span></a></div>');\n      var primary_indicator = selection.next('.zip-code-primary-holder').find('.zip-code-primary-select');\n      primary_indicator.addClass('selected');\n      primary_indicator.prop('title', 'Default location');\n      var primary_indicator_star = primary_indicator.find('i');\n      primary_indicator_star.removeClass('fa-star-o');\n      primary_indicator_star.addClass('fa-star');\n      var screenreader_indicator = primary_indicator.find('.sr-only');\n      screenreader_indicator.text(\"Default location\");\n    }\n\n    // If no default location exists, set the first row to be the default\n    if (table.find('input[type=checkbox]:checked').length == 0) {\n      setPrimaryZip();\n    }\n\n    // If city select exist, lock submit and focus on select\n    var $city_lookup = $('.city-state-lookup-zips');\n    if ($city_lookup.length == 0) {\n      $('.form-submit').prop(\"disabled\", false);\n      table.find(\"tr:last\").find('.field_zip_code').focus();\n    }\n    else {\n      $('.form-submit').prop(\"disabled\", true);\n      $city_lookup.focus();\n    }\n\n    // If location error exists, lock down buttons to avoid accidental submit\n    var fixInput;\n    if (!$('.field-suffix').hasClass('error')) {\n      reset_buttons = true;\n    } else {\n      hide_buttons = true;\n      fixInput = $('.field-suffix.error').closest('td').find('.field_zip_code');\n      fixInput.focus();\n    }\n\n    if (numSelects > 0) {\n      hide_buttons = true;\n    }\n\n    if (hide_buttons) {\n      hideButtons();\n    }\n    if (reset_buttons && !existingLocationErrors()) {\n      resetButtons();\n    }\n\n    var $field_add_more_submit = $('#links_description').find('.field-add-more-submit');\n    $field_add_more_submit.prop(\"value\", \"New favorite\").addClass(\"usa-button\");\n    $('.field_zip_code').prop(\"disabled\", false);\n  }\n\n  function setPrimaryZip() {\n    $('#zipcode_description').find('.field-multiple-table').find('tr:nth-child(1)').find('.zip-code-primary-select').click();\n  }\n\n  function setCommunitySizeType(commsize, isurban) {\n    var $urban_check =  $('#edit-field-community-type-und');\n    var $comm_size_select =  $('#edit-field-community-size-und');\n    // Reset Population and Urban setting selections\n    $urban_check.val(\"_none\").find('input[value=\"_none\"]').prop(\"checked\", true);\n    $comm_size_select.find('option[value=\"_none\"]').prop('selected', true);\n    if (typeof(commsize) !== 'undefined' && commsize !== '' && parseInt(commsize) >= 0) {\n      var selected_pop = parseInt(commsize);\n      if (selected_pop < 5000) {\n        $comm_size_select.find('option:contains(\"0 - 5,000\")').prop('selected', true);\n      } else if (selected_pop < 10000) {\n        $comm_size_select.find('option:contains(\"5,000 - 10,000\")').prop('selected', true);\n      } else if (selected_pop < 25000) {\n        $comm_size_select.find('option:contains(\"10,000 - 25,000\")').prop('selected', true);\n      } else if (selected_pop < 100000) {\n        $comm_size_select.find('option:contains(\"25,000 - 100,000\")').prop('selected', true);\n      } else if (selected_pop < 1000000) {\n        $comm_size_select.find('option:contains(\"100,000 - 1,000,000\")').prop('selected', true);\n      } else {\n        $comm_size_select.find('option:contains(\"1,000,000+\")').prop('selected', true);\n      }\n    }\n    if ((typeof(isurban) !== 'undefined' && isurban !== '' && isurban.toString() !== \"NaN\")) {\n      if (isurban === 1) {\n        $urban_check.val(\"urban\").find('input[value=\"urban\"]').prop(\"checked\", true);\n      } else if (isurban === 0) {\n        $urban_check.val(\"rural\").find('input[value=\"rural\"]').prop(\"checked\", true);\n      }\n      else {\n        $urban_check.val(\"rural\").find('input[value=\"_none\"]').prop(\"checked\", true);\n      }\n    }\n  }\n\n  /**\n   *\n   * @param location_name\n   * @param commsize\n   * @param isurban\n   */\n  function update_user_zip_preferences(input_to_ignore) {\n    if (typeof(input_to_ignore) === 'undefined') input_to_ignore = \"\";\n    // Reset global location_obj\n    location_obj = {};\n\n    var count_ignore_tr = 0;\n    $(\"[id*=field-zip-code-values]\").find(\"tr\").each(function (index) {\n      var $tr = $(this);\n      var $zip_code_input = $tr.find(\".field_zip_code\");\n      var zip_id = $zip_code_input.attr('id');\n      var $field_suffix = $tr.find('.field-suffix');\n      if (!$field_suffix.hasClass('field-suffix-data')) {\n        $field_suffix = $field_suffix.find('.field-suffix-data');\n      }\n      // Do not add items that have errored or are currently being changed\n      if (zip_id == input_to_ignore || zip_id == null) {\n        count_ignore_tr = count_ignore_tr + 1;\n        return true; // Skip to next iteration\n      }\n      // If the field has an error, we still need to account for the delta, so don't add to count_ignore_tr\n      if ($field_suffix.hasClass('error')) {\n        return true; // Skip to next iteration\n      }\n      index = index - count_ignore_tr;\n      var zip = $tr.find(\".field_zip_code\").val();\n      var name = $field_suffix.text().trim();\n      var primary = $tr.find('.field-name-field-field-primary input').prop('checked');\n      var urban = $field_suffix.attr('isurban');\n      if (urban !== \"_none\") {\n        urban = parseInt($field_suffix.attr('isurban'));\n      }\n      var pop = parseInt($field_suffix.attr('commsize'));\n\n      if (primary) {\n        primary = 1;\n        // If primary set comm size and urban flag\n        if (!initial_load) {\n          setCommunitySizeType(pop, urban);\n        } else {\n          initial_load = false;\n        }\n      }\n      else {\n        primary = 0;\n      }\n      if (name != '' && zip != '') {\n        // Check if name has been previously saved\n        if (!location_obj[name]) {\n          location_obj[name] = {};\n        }\n        // Store zip and primary\n        location_obj[name][zip] = {};\n        location_obj[name][zip].primary = primary;\n        location_obj[name][zip].delta = index;\n        // If this is the latest name, add community data\n        location_obj[name][zip].commsize = pop;\n        location_obj[name][zip].is_urban = urban;\n      }\n    });\n    var json_value = JSON.stringify(location_obj);\n    $('#edit-zip-mapping').val(json_value);\n  }\n\n  function check_duplicate(location_name, zip_val) {\n    zip_val = parseInt(zip_val);\n    location_name = location_name.trim();\n    return (location_obj[location_name] && location_obj[location_name][zip_val]);\n  }\n\n  function inString(str, substring) {\n    return str.indexOf(substring) >= 0;\n  }\n\n  // When an error occurs, disabled removal/ addition of\n  // rows except for the input that is errored\n  function disable_zip_buttons(input_to_ignore) {\n    $('.remove-button').prop('disabled', true);\n    $('input.field_zip_code').prop('disabled', true);\n    if (input_to_ignore != \"all\") {\n      var remove_to_ignore = input_to_ignore.closest('tr').find('.remove-button').attr('id');\n      $('#' + remove_to_ignore).attr('disabled', false);\n      input_to_ignore.closest('tr').find('.field_zip_code').prop('disabled', false);\n    }\n  }\n\n  // Appends error message to given field suffix elem\n  function print_error_message($field_suffix, message) {\n    // Print error message\n    lastVal = $field_suffix.prev().val();\n    failedLookup = true;\n    if ($field_suffix.parent().hasClass('field-suffix')) {\n      $field_suffix.parent().addClass('error');\n      $field_suffix.parent().attr(\"id\", \"zip-code-error\");\n      $field_suffix.parent().prev().attr(\"aria-describedby\", \"zip-code-error\");\n    } else {\n      $field_suffix.addClass('error');\n      $field_suffix.attr(\"id\", \"zip-code-error\");\n      $field_suffix.prev().attr(\"aria-describedby\", \"zip-code-error\");\n    }\n    $field_suffix.html(message);\n    are_there_errors = true;\n    update_user_zip_preferences();\n    hideButtons();\n  }\n\n  function appendSelect(input_type, select, location_data, input) {\n    var add_button = input.closest('td').find('.field-add-more-submit');\n    var remove_button = input.closest('td').find('.remove-button');\n    var primary_indicator = input.closest('td').find('.zip-code-primary-holder');\n    var location = input.val();\n    var field_suffix = input.next('.field-suffix');\n    if (!field_suffix.hasClass('field-suffix-data')) {\n      field_suffix = field_suffix.find('.field-suffix-data');\n    }\n    var label_select_string = \"\";\n    var select;\n\n    // replace input with select list\n    add_button.hide();\n    remove_button.hide();\n    primary_indicator.hide();\n\n    if (input_type == \"zip\") {\n      label_select_string = 'Select a location for ' + input.val() + ':';\n      select = $(location_data.city_select);\n    }\n    else {\n      label_select_string = 'Select a zip code for ' + input.val() + ':';\n      select = $(location_data.zip_select);\n    }\n    var label_select = $('<label id=\"zip-label\" for=\"city-state-lookup-zips\">' + label_select_string + '</label>');\n    select.addClass('city-state-lookup-zips');\n    // select.addClass('city-state-lookup-zips');\n    var confirm = $('<button type=\"button\" class=\"usa-button\" id =\"user-profile-select-zip\">Select</button>');\n    var back = $('<button type=\"button\" class=\"usa-button-outline\" id=\"user-profile-back-zip\">Back</button>');\n    input.prop(\"disabled\", true);\n    if (numSelects == 0) {\n      input.after(label_select);\n      label_select.after(select);\n      numSelects = numSelects + 1;\n    }\n    hideButtons();\n    field_suffix.html(confirm);\n    field_suffix.append(back);\n    $('.form-submit').prop(\"disabled\", true);\n    select.focus();\n    back.on('click', function () {\n      removedSelect = true;\n      numSelects = 0;\n      field_suffix.html('');\n      input.prop(\"disabled\", false);\n      $('#profile-locations').find('#city-state-lookup-zips').remove();\n      back.remove();\n      confirm.remove();\n      label_select.remove();\n      select.remove();\n      remove_button.show();\n      add_button.show();\n      primary_indicator.show();\n      field_suffix.addClass('error');\n      field_suffix.html('Please update your location or remove this field before saving.');\n      disable_zip_buttons(input);\n      input.prop('disabled', false);\n      input.focus();\n      update_user_zip_preferences();\n    });\n    confirm.on('click', function () {\n      var input_value = input.val();\n      var select_value = select.val();\n      var location_name = '';\n      var zip_val = '';\n      var pop = '';\n      var urban = '';\n      var duplicate = false;\n      back.remove();\n      confirm.remove();\n      if (input_type == 'zip') {\n        location_name = select_value;\n        zip_val = input_value;\n        if (check_duplicate(location_name, zip_val)) {\n          print_error_message(field_suffix, \"Duplicate location name and zip code pairs are not allowed.\");\n          disable_zip_buttons(input);\n          duplicate = true;\n        } else {\n          input.val(zip_val);\n          if (location_data.zip_attr && zip_val in location_data.zip_attr) {\n            pop = location_data.zip_attr[zip_val].pop;\n            urban = location_data.zip_attr[zip_val].urban;\n          }\n          if (location_data.city_attr && location_name in location_data.city_attr) {\n            pop = location_data.city_attr[location_name].pop;\n          }\n          // If pop returned 0 rewrite to -1 so it does not select\n          if (parseInt(pop) === 0) {\n            pop = -1;\n          }\n          if (urban == \"Urban\") {\n            field_suffix.attr('isurban', '1');\n          } else if (urban == \"Rural\") {\n            field_suffix.attr('isurban', '0');\n          }\n          field_suffix.text(location_name)\n            .attr('commsize', pop);\n        }\n      }\n      else { // type city or tribe\n        zip_val = select_value;\n        location_name = location_data.zip_attr[select_value].city;\n        // Set duplicate flag if the location and zip has already been entered.\n        if (check_duplicate(location_name, zip_val)) {\n          print_error_message(field_suffix, \"Duplicate location name and zip code pairs are not allowed.\");\n          disable_zip_buttons(input);\n          duplicate = true;\n        } else {\n          field_suffix.html('<span>' + location_name + '</span>');\n          input.val(zip_val);\n          if (location_data.zip_attr && zip_val in location_data.zip_attr) {\n            pop = location_data.zip_attr[zip_val].pop;\n            urban = location_data.zip_attr[zip_val].urban;\n          }\n          if (location_data.city_attr && location_name in location_data.city_attr) {\n            pop = location_data.city_attr[location_name].pop;\n          }\n          if (urban == \"Urban\") {\n            field_suffix.attr('isurban', '1');\n          } else if (urban == \"Rural\") {\n            field_suffix.attr('isurban', '0');\n          }\n          field_suffix.text(location_name)\n            .attr('commsize', pop);\n        }\n      }\n\n      label_select.remove();\n      select.remove();\n      remove_button.show();\n      primary_indicator.show();\n      numSelects = 0;\n\n      if (!duplicate) {\n        field_suffix.attr('commsize', pop);\n        if (urban == \"Urban\") {\n          field_suffix.attr('isurban', '1');\n        } else if (urban == \"Rural\") {\n          field_suffix.attr('isurban', '0');\n        }\n        // Update all location data\n        update_user_zip_preferences();\n        processPrimaryFields();\n        if (!existingLocationErrors()) {\n          resetButtons();\n        }\n      }\n      input.prop(\"disabled\", false);\n      input.focus();\n    });\n  }\n\n  function checkLocation(fieldToCheck, type) {\n    var input;\n    // Lock save and add as to not submit faulty data before processed\n    if (type != 'button' && fieldToCheck.val() != '') {\n      hideButtons();\n    }\n\n    if (type == 'button' || type == 'select') {\n      var clicked_id = fieldToCheck.id;\n      input = $(clicked_id).closest('td').find('.field_zip_code');\n    }\n\n    if (type == 'textfield') {\n      // This is an override of the drupal add and save to allow the zip code data to process before saving\n      input = fieldToCheck;\n      var field_suffix = input.next('.field-suffix');\n      if (!field_suffix.hasClass('field-suffix-data')) {\n        if (field_suffix.find('.field-suffix-data').length === 0) {\n          field_suffix.addClass('field-suffix-data');\n        }\n        else {\n          field_suffix = field_suffix.find('.field-suffix-data');\n        }\n      }\n      if (field_suffix.hasClass('error')) {\n        field_suffix.removeClass('error');\n      }\n      if (field_suffix.parent().hasClass('error')) {\n        field_suffix.parent().removeClass('error');\n      }\n      if ($.trim(input.val()) == '') {\n        field_suffix.html('');\n      }\n      else {\n        var ariaid = input.attr('aria-describedby');\n        field_suffix.attr('id', ariaid);\n        field_suffix.html('Loading...');\n        disable_zip_buttons(\"all\");\n        Drupal.settings.locationInputEngine.lookUpLocation(input.val()).done(function (location_data) {\n          var zip;\n          var location_name;\n          var pop = -1;\n          var urban = \"\";\n          var duplicate = false;\n          // Update location data to check for duplicates, ignoring this input-\n          update_user_zip_preferences(input.attr('id'));\n\n          // If zip codes, then returning zip code data for string input\n          if (location_data.zip_codes) {\n            // Lookup city, state - IF only one zip code, automatically input into input\n            var count_zips_returned = location_data.zip_array.length;\n            if (count_zips_returned > 1) {\n              appendSelect(\"city\", location_data.zip_select, location_data, input);\n              return;\n            }\n            // Count zips returned isn't greater than 1\n            zip = location_data.zip_array[0];\n            location_name = location_data.city;\n\n            input.val(zip);\n\n            // Check if state included. If not, it is a tribe\n            if (location_data.state != '') {\n              // Add state information\n              location_name = location_name + ', ' + location_data.state;\n            }\n            if (check_duplicate(location_name, zip)) {\n              print_error_message(field_suffix, \"Duplicate location name (\" + location_name + \") and zip code pairs are not allowed.\");\n              disable_zip_buttons(input);\n              duplicate = true;\n            }\n            if (!duplicate) {\n              // Gather FRS location data for zip code\n              if (location_data.zip_attr && zip in location_data.zip_attr) {\n                pop = location_data.zip_attr[zip].pop;\n                urban = location_data.zip_attr[zip].urban;\n              }\n              // If city population exists, override FRS zip population\n              if (location_data.city_attr && location_name in location_data.city_attr) {\n                pop = location_data.city_attr[location_name].pop;\n              }\n              // If pop returned 0 rewrite to -1 so it does not select\n              if (parseInt(pop) === 0) {\n                pop = -1;\n              }\n              field_suffix.html(location_name);\n              field_suffix.attr('commsize', pop);\n              if (urban == \"Urban\") {\n                field_suffix.attr('isurban', '1');\n              } else if (urban == \"Rural\") {\n                field_suffix.attr('isurban', '0');\n              }\n              processPrimaryFields();\n              update_user_zip_preferences();\n            }\n          } // Ends if location_data.zip_codes\n          else { // Returning zip codes for selection\n            if (location_data.city_select) {// multiple zip codes found found\n              appendSelect(\"zip\", location_data.city_select, location_data, input);\n              return;\n            }\n\n            if (location_data.zip) {\n              zip = location_data.zip;\n            } else {\n              zip = location_data.zip_array[0];\n            }\n            location_name = location_data.city[0];\n            if (check_duplicate(location_name, zip)) {\n              print_error_message(field_suffix, \"Duplicate location name (\" + location_name + \") and zip code pairs are not allowed.\");\n              disable_zip_buttons(input);\n              duplicate = true;\n            }\n            if (!duplicate) {\n              field_suffix.html(location_name);\n              if (location_data.zip_attr && zip in location_data.zip_attr) {\n                pop = location_data.zip_attr[zip].pop;\n                urban = location_data.zip_attr[zip].urban;\n              }\n              if (location_data.city_attr && location_name in location_data.city_attr) {\n                pop = location_data.city_attr[location_name].pop;\n              }\n              // If pop returned 0 rewrite to -1 so it does not select\n              if (parseInt(pop) === 0) {\n                pop = -1;\n              }\n              field_suffix.attr('commsize', pop);\n              if (urban == \"Urban\") {\n                field_suffix.attr('isurban', '1');\n              } else if (urban == \"Rural\") {\n                field_suffix.attr('isurban', '0');\n              }\n\n              update_user_zip_preferences();\n              $('.remove-button').prop(\"disabled\", false);\n            }\n          }\n          if (!existingLocationErrors()) {\n            resetButtons();\n          }\n          // processPrimaryFields();\n          moveAddButton();\n          $('#profile-locations').find('tr:last').find('.field_zip_code').focus();\n        }).fail(function (location_data) {\n          print_error_message(field_suffix, location_data.error_message);\n          disable_zip_buttons(input);\n          $body.find('#zip-code-error').prev('.field_zip_code').focus();    \n        });\n      }\n    }\n  } // End checkLocation\n\n  // Enable Save button / plus button\n  function resetButtons() {\n    $body.find('.field-add-more-submit').show();\n    $('#edit-field-zip-code .field-add-more-submit').prop(\"disabled\", false);\n    $('#edit-submit').prop(\"disabled\", false);\n    $('#edit-submit--2').prop(\"disabled\", false);\n    $('#edit-delete').prop(\"disabled\", false);\n    $('.field_zip_code').prop(\"disabled\", false);\n  }\n\n  // On an Drupal Ajax call- if there is an error, hide the actual Save and +\n  function hideButtons() {\n    $('#edit-field-zip-code').find('.field-add-more-submit').prop(\"disabled\", true);\n    $('#edit-submit').prop(\"disabled\", true);\n    $('#edit-submit--2').prop(\"disabled\", true);\n    $('#edit-delete').prop(\"disabled\", true);\n  }\n\n  /**\n   * Check if error exists in zip code settings\n   * @returns {boolean}\n   */\n  function existingLocationErrors() {\n    var num_errors = $('#edit-field-zip-code').find('.error').length;\n    return num_errors > 0;\n  }\n\n  /**\n   * When the user edits the location size and urban flag, update the currently select primary setting\n   * @param comm_size\n   * @param isurban\n   */\n  function updatePrimaryLocationDataSize($select_elem) {\n    var select_text = $select_elem.text();\n    var replace_text = select_text.replace(/,/g, '').replace(' ', '').replace('+', '');\n    var location_of_dash = replace_text.indexOf('-');\n    var number_text;\n    if (location_of_dash > -1) {\n      number_text = replace_text.substr(0, replace_text.indexOf('-'));\n    } else {\n      number_text = replace_text;\n    }\n    var number = parseInt(number_text);\n    var $primary = $('.field-name-field-field-primary').find('input:checked');\n    var $field_suffix = $primary.closest('tr').find('.field-suffix');\n    if ($field_suffix.find('.field-suffix-data').length > 0) {\n      $field_suffix.find('.field-suffix-data').attr('commsize', number);\n    } else {\n      $field_suffix.attr('commsize', number);\n    }\n  }\n\n  function updatePrimaryLocationDataUrban(urban) {\n    var $primary = $('.field-name-field-field-primary').find('input:checked');\n    var $field_suffix = $primary.closest('tr').find('.field-suffix');\n    var isurban = \"_none\";\n    if (urban === \"urban\") {\n      isurban  = 1;\n    } else if (urban === \"rural\") {\n      isurban = 0;\n    }\n    if ($field_suffix.find('.field-suffix-data').length <= 0) {\n      $field_suffix.attr(\"isurban\", isurban);\n    } else {\n      $field_suffix.find('.field-suffix-data').attr(\"isurban\", isurban);\n    }\n  }\n\n  $(document).ready(function () {\n    // If No radio selection has been made, select \"N/A\". This has not action in Drupal's db so it is not set by defautl\n    var $urban_check =  $('#edit-field-community-type-und');\n    if ($urban_check.find('input:checked').length === 0) {\n      $urban_check.val(\"_none\").find('input[value=\"_none\"]').prop(\"checked\", true);\n    }\n\n    $urban_check.find('input').change( function() {\n      var isurban = $(this).val();\n      updatePrimaryLocationDataUrban(isurban);\n      update_user_zip_preferences();\n    });\n\n    $('#edit-field-community-size-und').change( function() {\n      updatePrimaryLocationDataSize($(this).find('option:selected'));\n      update_user_zip_preferences();\n    });\n\n    $body.find('.field-multiple-table').removeClass('sticky-enabled');\n    $('#profile-locations').find('.sticky-header').remove();\n\n    $(document).click(function (e) {\n      // The latest element clicked\n      mouse_click = $(e.target);\n    });\n\n    $body.on('click', '.zip-code-primary-select', function () {\n      var $field_suffix = $(this).closest('tr').find('.field-suffix');\n      if (!$field_suffix.hasClass('field-suffix-data')) {\n        $field_suffix = $field_suffix.find('.field-suffix-data');\n      }\n      var comm_size = $field_suffix.attr('commsize');\n      var urban = $field_suffix.attr('isurban');\n      $('.zip-code-primary-select.selected').removeClass('selected');\n      $('.zip-code-primary-select').prop('title', 'Set to default location');\n      $('.zip-code-primary-select').closest('td').find('input[type=checkbox]:checked').prop('checked', false);\n      var original_star = $('.zip-code-primary-select').find('i');\n      original_star.addClass('fa-star-o');\n      original_star.removeClass('fa-star');\n      var selected_icon = $(this);\n      selected_icon.addClass('selected');\n      selected_icon.prop('title', 'Default location');\n      var selected_icon_star = selected_icon.find('i');\n      selected_icon_star.removeClass('fa-star-o');\n      selected_icon_star.addClass('fa-star');\n      selected_icon_star.closest('td').find('input[type=checkbox]').prop('checked', true);\n      var screenreader_indicator = $(this).find('.sr-only');\n      screenreader_indicator.text('Default location');\n      // get location offset by regexing the id\n      setCommunitySizeType(comm_size, urban);\n      //update session data without adding new community data\n      update_user_zip_preferences();\n    });\n\n    $body.on('click', '.zip-code-primary-select.selected', function () {\n      $(this).removeClass('selected');\n      $(this).prop('title', 'Set to default location');\n      var selected_icon = $(this).find('i');\n      selected_icon.removeClass('fa-star');\n      selected_icon.addClass('fa-star-o');\n      selected_icon.closest('td').find('input[type=checkbox]').prop('checked', false);\n      var screenreader_indicator = $(this).find('.sr-only');\n      screenreader_indicator.text('Set to default location');\n    });\n\n\n    $body.on('focus', '.field_zip_code', function () {\n      lastVal = $(this).val();\n      $('.field_zip_code').on('change', function () {\n        $('.form-submit').prop(\"disabled\", true);\n      });\n      $(\".field_zip_code\").keyup(function (e) {\n        if ($(this).val() != '' && (lastVal != $(this).val())) {\n          hideButtons();\n        }\n      });\n    });\n\n    $('#user-profile-select-zip').on('keyup', function (e) {\n      if (e.which == 13) { // Enter key\n        $(this).trigger('click');\n      }\n    });\n\n    $body.on('blur', '.field_zip_code', function (e) {\n      // Search for location on Enter click even if same value\n      if (lastVal != $(this).val() || enter_pressed || show_locations_again) {\n        fieldChanged = $(e.target);\n        checkLocation(fieldChanged, \"textfield\");\n        // Reset flags\n        enter_pressed = false;\n        show_locations_again = false;\n      }\n    });\n\n    $body.on('click', '.form-submit', function (e) {\n      mouse_click = $(e.target);\n      checkLocation(mouse_click, \"button\");\n    });\n\n    $body.on('click', 'button', function (e) {\n      mouse_click = $(e.target);\n      checkLocation(mouse_click, \"button\");\n      if ($('.field-suffix').hasClass('error')) {\n        hideButtons();\n      }\n      $(this).closest('.field_zip_code').focus();\n    });\n\n\n    var path = window.location.pathname;\n    var page = path.split('/')[1];\n    if (page === 'user') {\n      $(\"#edit-submit\").prependTo(\".edit-user-profile\");\n      $(document).ajaxSuccess(function (event, xhr, settings) {\n        var target_url = settings.url;\n\n        if (target_url == '/multifield/field-remove-item/ajax') {\n          if (existingLocationErrors()) {\n            hideButtons();\n          }\n          else {\n            resetButtons();\n          }\n          // Update zip session data\n          update_user_zip_preferences();\n        }\n        // determine which table to place the Add Another button\n        if (target_url == '/system/ajax' || target_url == '/multifield/field-remove-item/ajax') {\n          var table_id = '';\n          var parent_id = '';\n          $('.field-multiple-table').each(function () {\n            var table = $(this);\n            var add_button = table.find('tr:last').find('td:nth-child(2)').find('.field-add-more-submit');\n            if (add_button.length == 0) {\n              table_id = table.attr('id');\n            }\n          });\n          if (inString(table_id, 'zip-code')) {\n            parent_id = '#zipcode_description';\n          }\n          else {\n            parent_id = '#links_description';\n          }\n\n          if (table_id != '') {\n            placeAddAnotherButton(false, '#' + table_id, parent_id);\n          }\n          processPrimaryFields();\n        }\n        moveAddButton();\n      });\n\n      //Add hide and show functionality for the local government user options\n      $org_select = $('#edit-field-organization select');\n\n      $org_select.change(function () {\n        $local_gov_opts = $('.local-government-options');\n        if ($(this).find('option:selected').text() == 'Local government') {\n          $local_gov_opts.show();\n        }\n        else {\n          $local_gov_opts.hide();\n        }\n      });\n\n      Drupal.tableDrag.prototype.row.prototype.onSwap = function (swappedRow) {\n        var table = $(swappedRow).closest('table');\n        var table_id = '#' + table.attr('id');\n        var parent_id = '';\n        if (inString(table_id, 'zip-code')) {\n          parent_id = '#zipcode_description';\n        }\n        else {\n          parent_id = '#links_description';\n        }\n        placeAddAnotherButton(false, table_id, parent_id);\n      };\n      $('#profile-tabs').tabs();\n      // Update session on page load for zip mapping\n      update_user_zip_preferences();\n    }\n\n    if (page == 'app-connect') {\n      $('#app-connect-tabs').tabs();\n    }\n\n\n    // Delete user profile\n    $('#edit-delete').click(function (e) {\n      var delete_button = $(this);\n      $.fancybox({\n        content: $('#delete-holder'),\n        'width': 400,\n        'height': 150,\n        'autoSize': false\n      });\n\n      // If confirmed delete, unbind prevent default and trigger click to continue action\n      $('#confirm-delete-profile').unbind('click').click(function () {\n        delete_button.unbind('click');\n        delete_button.trigger('click');\n      });\n\n      $('#cancel-delete-profile').unbind('click').click(function () {\n        $.fancybox.close();\n      });\n\n      e.preventDefault();\n    });\n\n    $('.remove-button').click(function () {\n\n    });\n\n    processPrimaryFields();\n    placeAddAnotherButton(false, '#field-zip-code-values', '#zipcode_description');\n    $('#zipcode_description').show();\n  });\n})(jQuery);\n"]}