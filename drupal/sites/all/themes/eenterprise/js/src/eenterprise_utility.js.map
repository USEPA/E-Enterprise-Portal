{"version":3,"sources":["eenterprise_utility.js"],"names":["$","placeAddAnotherButton","ajax_content","table_id","parent_id","table","input_button","find","append","moveAddButton","$profile_locations","addMoreBtn","add_button","length","attr","processPrimaryFields","reset_buttons","hide_buttons","$zipcode_description","removeClass","remove","checkboxes","starsSpot","next","selection","hasClass","after","primary_indicator","addClass","prop","primary_indicator_star","screenreader_indicator","text","setPrimaryZip","$city_lookup","focus","fixInput","closest","numSelects","hideButtons","existingLocationErrors","resetButtons","$field_add_more_submit","click","setCommunitySizeType","commsize","isurban","$urban_check","$comm_size_select","val","parseInt","selected_pop","toString","update_user_zip_preferences","input_to_ignore","location_obj","count_ignore_tr","each","index","$tr","this","$zip_code_input","zip_id","$field_suffix","zip","name","trim","primary","urban","pop","initial_load","delta","is_urban","json_value","JSON","stringify","check_duplicate","location_name","zip_val","inString","str","substring","indexOf","disable_zip_buttons","remove_to_ignore","print_error_message","message","lastVal","prev","failedLookup","parent","html","are_there_errors","appendSelect","input_type","select","location_data","input","remove_button","field_suffix","label_select_string","hide","city_select","zip_select","label_select","confirm","back","on","removedSelect","show","input_value","select_value","duplicate","zip_attr","city_attr","city","checkLocation","fieldToCheck","type","clicked_id","id","ariaid","Drupal","settings","locationInputEngine","lookUpLocation","done","zip_codes","count_zips_returned","zip_array","state","fail","error_message","num_errors","updatePrimaryLocationDataSize","$select_elem","number_text","select_text","replace_text","replace","location_of_dash","substr","number","$primary","updatePrimaryLocationDataUrban","mouse_click","enter_pressed","show_locations_again","behaviors","DisableInputEnter","attach","context","once","keypress","e","$elem","keyCode","blur","preventDefault","document","ready","change","target","comm_size","original_star","selected_icon","selected_icon_star","keyup","which","trigger","fieldChanged","path","window","location","pathname","page","split","prependTo","ajaxSuccess","event","xhr","target_url","url","$org_select","$local_gov_opts","tableDrag","prototype","row","onSwap","swappedRow","tabs","delete_button","fancybox","content","width","height","autoSize","unbind","close","jQuery"],"mappings":"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","file":"eenterprise_utility.js","sourcesContent":["(function ($) {\r\n  var numSelects = 0;\r\n  var type;\r\n  var removedSelect = false;\r\n  var failedLookup = false;\r\n  var mouse_click;\r\n  var are_there_errors;\r\n  var lastVal;\r\n  // Map of location and zip data\r\n  var location_obj = {};\r\n  // Flags for when to search for location information\r\n  var enter_pressed = false; // When user deliberately presses enter in a location\r\n  var show_locations_again = false; // When the location errored but returned multiple options.\r\n  var initial_load = true;\r\n\r\n  // Disables entering the form by key press when focused on an input\r\n  Drupal.behaviors.DisableInputEnter = {\r\n    attach: function (context, settings) {\r\n      $('input', context).once('disable-input-enter', function () {\r\n        $(this).keypress(function (e) {\r\n          var $elem = $(this);\r\n          if (e.keyCode == 13) {\r\n            enter_pressed = true;\r\n            $elem.blur();\r\n            e.preventDefault();\r\n          }\r\n        });\r\n      });\r\n    }\r\n  };\r\n\r\n  function placeAddAnotherButton(ajax_content, table_id, parent_id) {\r\n    var table = $(table_id);\r\n    var input_button = $(parent_id).find('.field-add-more-submit');\r\n    if (!ajax_content) {\r\n      // Add the + button next to the Remove button\r\n      table.find(\"tr:last\").find('td:nth-child(2)').append(input_button);\r\n    }\r\n  }\r\n\r\n  function moveAddButton() {\r\n    var table = $('#zipcode_description').find('.field-multiple-table');\r\n    var $profile_locations = $('#profile-locations');\r\n    var addMoreBtn = $profile_locations.find('.field-add-more-submit');\r\n    var add_button = table.find('tr:last').find('td:nth-child(2)').find('.field-add-more-submit');\r\n    if (add_button.length == 0) {\r\n      table_id = table.attr('id');\r\n    }\r\n    $profile_locations.find('tr:last').find('td:nth-child(2)').append(addMoreBtn);\r\n  }\r\n\r\n  function processPrimaryFields() {\r\n    var reset_buttons = false;\r\n    var hide_buttons = false;\r\n    var $zipcode_description = $('#zipcode_description');\r\n    $('body').find('.field-multiple-table').removeClass('sticky-enabled');\r\n    $('#profile-locations').find('.sticky-header').remove();\r\n    var table = $zipcode_description.find('.field-multiple-table');        // cache the target table DOM element\r\n    var checkboxes = table.find('input[type=checkbox]');\r\n    var starsSpot = checkboxes.next('div');\r\n\r\n    var selection = table.find('input[type=checkbox]:checked');\r\n\r\n    if (!$(starsSpot).hasClass('zip-code-primary-holder')) {\r\n      checkboxes.after('<div class=\"zip-code-primary-holder\"><a href=\"javascript:void(0)\" title=\"Set to default location\" class=\"zip-code-primary-select\"><i class=\"fa fa-star-o\" aria-hidden=\"true\"></i><span class=\"sr-only\">Set to default location</span></a></div>');\r\n      var primary_indicator = selection.next('.zip-code-primary-holder').find('.zip-code-primary-select');\r\n      primary_indicator.addClass('selected');\r\n      primary_indicator.prop('title', 'Default location');\r\n      var primary_indicator_star = primary_indicator.find('i');\r\n      primary_indicator_star.removeClass('fa-star-o');\r\n      primary_indicator_star.addClass('fa-star');\r\n      var screenreader_indicator = primary_indicator.find('.sr-only');\r\n      screenreader_indicator.text(\"Default location\");\r\n    }\r\n\r\n    // If no default location exists, set the first row to be the default\r\n    if (table.find('input[type=checkbox]:checked').length == 0) {\r\n      setPrimaryZip();\r\n    }\r\n\r\n    // If city select exist, lock submit and focus on select\r\n    var $city_lookup = $('.city-state-lookup-zips');\r\n    if ($city_lookup.length == 0) {\r\n      $('.form-submit').prop(\"disabled\", false);\r\n      table.find(\"tr:last\").find('.field_zip_code').focus();\r\n    }\r\n    else {\r\n      $('.form-submit').prop(\"disabled\", true);\r\n      $city_lookup.focus();\r\n    }\r\n\r\n    // If location error exists, lock down buttons to avoid accidental submit\r\n    var fixInput;\r\n\r\n    if (!$('.field-suffix').hasClass('error')) {\r\n      reset_buttons = true;\r\n    } else {\r\n      hide_buttons = true;\r\n      fixInput = $('.field-suffix.error').closest('td').find('.field_zip_code');\r\n      fixInput.focus();\r\n    }\r\n\r\n    if (numSelects > 0) {\r\n      hide_buttons = true;\r\n    }\r\n\r\n    if (hide_buttons) {\r\n      hideButtons();\r\n    }\r\n    if (reset_buttons && !existingLocationErrors()) {\r\n      resetButtons();\r\n    }\r\n\r\n    var $field_add_more_submit = $('#links_description').find('.field-add-more-submit');\r\n    $field_add_more_submit.prop(\"value\", \"New favorite\").addClass(\"usa-button\");\r\n    $('.field_zip_code').prop(\"disabled\", false);\r\n  }\r\n\r\n  function setPrimaryZip() {\r\n    $('#zipcode_description').find('.field-multiple-table').find('tr:nth-child(1)').find('.zip-code-primary-select').click();\r\n  }\r\n\r\n  function setCommunitySizeType(commsize, isurban) {\r\n    var $urban_check =  $('#edit-field-community-type-und');\r\n    var $comm_size_select =  $('#edit-field-community-size-und');\r\n    // Reset Population and Urban setting selections\r\n    $urban_check.val(\"_none\").find('input[value=\"_none\"]').prop(\"checked\", true);\r\n    $comm_size_select.find('option[value=\"_none\"]').prop('selected', true);\r\n    if (typeof(commsize) !== 'undefined' && commsize !== '' && parseInt(commsize) >= 0) {\r\n      var selected_pop = parseInt(commsize);\r\n      if (selected_pop < 5000) {\r\n        $comm_size_select.find('option:contains(\"0 - 5,000\")').prop('selected', true);\r\n      } else if (selected_pop < 10000) {\r\n        $comm_size_select.find('option:contains(\"5,000 - 10,000\")').prop('selected', true);\r\n      } else if (selected_pop < 25000) {\r\n        $comm_size_select.find('option:contains(\"10,000 - 25,000\")').prop('selected', true);\r\n      } else if (selected_pop < 100000) {\r\n        $comm_size_select.find('option:contains(\"25,000 - 100,000\")').prop('selected', true);\r\n      } else if (selected_pop < 1000000) {\r\n        $comm_size_select.find('option:contains(\"100,000 - 1,000,000\")').prop('selected', true);\r\n      } else {\r\n        $comm_size_select.find('option:contains(\"1,000,000+\")').prop('selected', true);\r\n      }\r\n    }\r\n    if ((typeof(isurban) !== 'undefined' && isurban !== '' && isurban.toString() !== \"NaN\")) {\r\n      if (isurban === 1) {\r\n        $urban_check.val(\"urban\").find('input[value=\"urban\"]').prop(\"checked\", true);\r\n      } else if (isurban === 0) {\r\n        $urban_check.val(\"rural\").find('input[value=\"rural\"]').prop(\"checked\", true);\r\n      }\r\n      else {\r\n        $urban_check.val(\"rural\").find('input[value=\"_none\"]').prop(\"checked\", true);\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n\r\n  /**\r\n   *\r\n   * @param location_name\r\n   * @param commsize\r\n   * @param isurban\r\n   */\r\n  function update_user_zip_preferences(input_to_ignore) {\r\n    if (typeof(input_to_ignore) === 'undefined') input_to_ignore = \"\";\r\n    // Reset global location_obj\r\n    location_obj = {};\r\n\r\n\r\n    var count_ignore_tr = 0;\r\n    $(\"[id*=field-zip-code-values]\").find(\"tr\").each(function (index) {\r\n      var $tr = $(this);\r\n      var $zip_code_input = $tr.find(\".field_zip_code\");\r\n      var zip_id = $zip_code_input.attr('id');\r\n      var $field_suffix = $tr.find('.field-suffix');\r\n      if (!$field_suffix.hasClass('field-suffix-data')) {\r\n        $field_suffix = $field_suffix.find('.field-suffix-data');\r\n      }\r\n      // Do not add items that have errored or are currently being changed\r\n      if (zip_id == input_to_ignore || zip_id == null) {\r\n        count_ignore_tr = count_ignore_tr + 1;\r\n        return true; // Skip to next iteration\r\n      }\r\n      // If the field has an error, we still need to account for the delta, so don't add to count_ignore_tr\r\n      if ($field_suffix.hasClass('error')) {\r\n        return true; // Skip to next iteration\r\n      }\r\n      index = index - count_ignore_tr;\r\n      var zip = $tr.find(\".field_zip_code\").val();\r\n      var name = $field_suffix.text().trim();\r\n      var primary = $tr.find('.field-name-field-field-primary input').prop('checked');\r\n      var urban = $field_suffix.attr('isurban');\r\n      if (urban !== \"_none\") {\r\n        urban = parseInt($field_suffix.attr('isurban'));\r\n      }\r\n      var pop = parseInt($field_suffix.attr('commsize'));\r\n\r\n      if (primary) {\r\n        primary = 1;\r\n        // If primary set comm size and urban flag\r\n        if (!initial_load) {\r\n          setCommunitySizeType(pop, urban);\r\n        } else {\r\n          initial_load = false;\r\n        }\r\n      }\r\n      else {\r\n        primary = 0;\r\n      }\r\n      if (name != '' && zip != '') {\r\n        // Check if name has been previously saved\r\n        if (!location_obj[name]) {\r\n          location_obj[name] = {};\r\n        }\r\n        // Store zip and primary\r\n        location_obj[name][zip] = {};\r\n        location_obj[name][zip].primary = primary;\r\n        location_obj[name][zip].delta = index;\r\n        // If this is the latest name, add community data\r\n        location_obj[name][zip].commsize = pop;\r\n        location_obj[name][zip].is_urban = urban;\r\n      }\r\n    });\r\n    var json_value = JSON.stringify(location_obj);\r\n    $('#edit-zip-mapping').val(json_value);\r\n  }\r\n\r\n  function check_duplicate(location_name, zip_val) {\r\n    zip_val = parseInt(zip_val);\r\n    location_name = location_name.trim();\r\n    return (location_obj[location_name] && location_obj[location_name][zip_val]);\r\n  }\r\n\r\n  function inString(str, substring) {\r\n    return str.indexOf(substring) >= 0;\r\n  }\r\n\r\n  // When an error occurs, disabled removal/ addition of\r\n  // rows except for the input that is errored\r\n  function disable_zip_buttons(input_to_ignore) {\r\n    $('.remove-button').prop('disabled', true);\r\n    $('input.field_zip_code').prop('disabled', true);\r\n    if (input_to_ignore != \"all\") {\r\n      var remove_to_ignore = input_to_ignore.closest('tr').find('.remove-button').attr('id');\r\n      $('#' + remove_to_ignore).attr('disabled', false);\r\n      input_to_ignore.closest('tr').find('.field_zip_code').prop('disabled', false);\r\n    }\r\n  }\r\n\r\n\r\n  // Appends error message to given field suffix elem\r\n  function print_error_message($field_suffix, message) {\r\n    // Print error message\r\n    lastVal = $field_suffix.prev().val();\r\n    failedLookup = true;\r\n    if ($field_suffix.parent().hasClass('field-suffix')) {\r\n      $field_suffix.parent().addClass('error');\r\n      $field_suffix.parent().attr(\"id\", \"zip-code-error\");\r\n      $field_suffix.parent().prev().attr(\"aria-describedby\", \"zip-code-error\");\r\n    } else {\r\n      $field_suffix.addClass('error');\r\n      $field_suffix.attr(\"id\", \"zip-code-error\");\r\n      $field_suffix.prev().attr(\"aria-describedby\", \"zip-code-error\");\r\n    }\r\n    $field_suffix.html(message);\r\n    are_there_errors = true;\r\n    update_user_zip_preferences();\r\n    hideButtons();\r\n  }\r\n\r\n  function appendSelect(input_type, select, location_data, input) {\r\n    var add_button = input.closest('td').find('.field-add-more-submit');\r\n    var remove_button = input.closest('td').find('.remove-button');\r\n    var primary_indicator = input.closest('td').find('.zip-code-primary-holder');\r\n    var location = input.val();\r\n    var field_suffix = input.next('.field-suffix');\r\n    if (!field_suffix.hasClass('field-suffix-data')) {\r\n      field_suffix = field_suffix.find('.field-suffix-data');\r\n    }\r\n    var label_select_string = \"\";\r\n    var select;\r\n\r\n    // replace input with select list\r\n    add_button.hide();\r\n    remove_button.hide();\r\n    primary_indicator.hide();\r\n\r\n    if (input_type == \"zip\") {\r\n      label_select_string = 'Select a location for ' + input.val() + ':';\r\n      select = $(location_data.city_select);\r\n    }\r\n    else {\r\n      label_select_string = 'Select a zip code for ' + input.val() + ':';\r\n      select = $(location_data.zip_select);\r\n    }\r\n    var label_select = $('<label id=\"zip-label\" for=\"city-state-lookup-zips\">' + label_select_string + '</label>');\r\n    select.addClass('city-state-lookup-zips');\r\n    // select.addClass('city-state-lookup-zips');\r\n    var confirm = $('<button type=\"button\" class=\"usa-button\" id =\"user-profile-select-zip\">Select</button>');\r\n    var back = $('<button type=\"button\" class=\"usa-button-outline\" id=\"user-profile-back-zip\">Back</button>');\r\n    input.prop(\"disabled\", true);\r\n    if (numSelects == 0) {\r\n      input.after(label_select);\r\n      label_select.after(select);\r\n      numSelects = numSelects + 1;\r\n    }\r\n    hideButtons();\r\n    field_suffix.html(confirm);\r\n    field_suffix.append(back);\r\n    $('.form-submit').prop(\"disabled\", true);\r\n    select.focus();\r\n    back.on('click', function () {\r\n      removedSelect = true;\r\n      numSelects = 0;\r\n      field_suffix.html('');\r\n      input.prop(\"disabled\", false);\r\n      $('#profile-locations').find('#city-state-lookup-zips').remove();\r\n      back.remove();\r\n      confirm.remove();\r\n      label_select.remove();\r\n      select.remove();\r\n      remove_button.show();\r\n      add_button.show();\r\n      primary_indicator.show();\r\n      field_suffix.addClass('error');\r\n      field_suffix.html('Please update your location or remove this field before saving.');\r\n      disable_zip_buttons(input);\r\n      input.prop('disabled', false);\r\n      input.focus();\r\n      update_user_zip_preferences();\r\n    });\r\n    confirm.on('click', function () {\r\n      var input_value = input.val();\r\n      var select_value = select.val();\r\n      var location_name = '';\r\n      var zip_val = '';\r\n      var pop = '';\r\n      var urban = '';\r\n      var duplicate = false;\r\n      back.remove();\r\n      confirm.remove();\r\n      if (input_type == 'zip') {\r\n        location_name = select_value;\r\n        zip_val = input_value;\r\n        if (check_duplicate(location_name, zip_val)) {\r\n          print_error_message(field_suffix, \"Duplicate location name and zip code pairs are not allowed.\");\r\n          disable_zip_buttons(input);\r\n          duplicate = true;\r\n        } else {\r\n          input.val(zip_val);\r\n          if (location_data.zip_attr && zip_val in location_data.zip_attr) {\r\n            pop = location_data.zip_attr[zip_val].pop;\r\n            urban = location_data.zip_attr[zip_val].urban;\r\n          }\r\n          if (location_data.city_attr && location_name in location_data.city_attr) {\r\n            pop = location_data.city_attr[location_name].pop;\r\n          }\r\n          // If pop returned 0 rewrite to -1 so it does not select\r\n          if (parseInt(pop) === 0) {\r\n            pop = -1;\r\n          }\r\n          if (urban == \"Urban\") {\r\n            field_suffix.attr('isurban', '1');\r\n          } else if (urban == \"Rural\") {\r\n            field_suffix.attr('isurban', '0');\r\n          }\r\n          field_suffix.text(location_name)\r\n            .attr('commsize', pop);\r\n        }\r\n      }\r\n      else { // type city or tribe\r\n        zip_val = select_value;\r\n        location_name = location_data.zip_attr[select_value].city;\r\n        // Set duplicate flag if the location and zip has already been entered.\r\n        if (check_duplicate(location_name, zip_val)) {\r\n          print_error_message(field_suffix, \"Duplicate location name and zip code pairs are not allowed.\");\r\n          disable_zip_buttons(input);\r\n          duplicate = true;\r\n        } else {\r\n          field_suffix.html('<span>' + location_name + '</span>');\r\n          input.val(zip_val);\r\n          if (location_data.zip_attr && zip_val in location_data.zip_attr) {\r\n            pop = location_data.zip_attr[zip_val].pop;\r\n            urban = location_data.zip_attr[zip_val].urban;\r\n          }\r\n          if (location_data.city_attr && location_name in location_data.city_attr) {\r\n            pop = location_data.city_attr[location_name].pop;\r\n          }\r\n          if (urban == \"Urban\") {\r\n            field_suffix.attr('isurban', '1');\r\n          } else if (urban == \"Rural\") {\r\n            field_suffix.attr('isurban', '0');\r\n          }\r\n          field_suffix.text(location_name)\r\n            .attr('commsize', pop);\r\n        }\r\n      }\r\n\r\n      label_select.remove();\r\n      select.remove();\r\n      remove_button.show();\r\n      primary_indicator.show();\r\n      numSelects = 0;\r\n\r\n      if (!duplicate) {\r\n        field_suffix.attr('commsize', pop);\r\n        if (urban == \"Urban\") {\r\n          field_suffix.attr('isurban', '1');\r\n        } else if (urban == \"Rural\") {\r\n          field_suffix.attr('isurban', '0');\r\n        }\r\n        // Update all location data\r\n        update_user_zip_preferences();\r\n        processPrimaryFields();\r\n        if (!existingLocationErrors()) {\r\n          resetButtons();\r\n        }\r\n      }\r\n\r\n      input.prop(\"disabled\", false);\r\n      input.focus();\r\n\r\n    });\r\n\r\n  }\r\n\r\n  function checkLocation(fieldToCheck, type) {\r\n    var input;\r\n    // Lock save and add as to not submit faulty data before processed\r\n    if (type != 'button' && fieldToCheck.val() != '') {\r\n      hideButtons();\r\n    }\r\n\r\n    if (type == 'button' || type == 'select') {\r\n      var clicked_id = fieldToCheck.id;\r\n      input = $(clicked_id).closest('td').find('.field_zip_code');\r\n    }\r\n\r\n    if (type == 'textfield') {\r\n      // This is an override of the drupal add and save to allow the zip code data to process before saving\r\n      input = fieldToCheck;\r\n      var field_suffix = input.next('.field-suffix');\r\n      if (!field_suffix.hasClass('field-suffix-data')) {\r\n        if (field_suffix.find('.field-suffix-data').length === 0) {\r\n          field_suffix.addClass('field-suffix-data');\r\n        }\r\n        else {\r\n          field_suffix = field_suffix.find('.field-suffix-data');\r\n        }\r\n      }\r\n      if (field_suffix.hasClass('error')) {\r\n        field_suffix.removeClass('error');\r\n      }\r\n      if (field_suffix.parent().hasClass('error')) {\r\n        field_suffix.parent().removeClass('error');\r\n      }\r\n      if ($.trim(input.val()) == '') {\r\n        field_suffix.html('');\r\n      }\r\n      else {\r\n        var ariaid = input.attr('aria-describedby');\r\n        field_suffix.attr('id', ariaid);\r\n        field_suffix.html('Loading...');\r\n        disable_zip_buttons(\"all\");\r\n        Drupal.settings.locationInputEngine.lookUpLocation(input.val()).done(function (location_data) {\r\n          var zip;\r\n          var location_name;\r\n          var pop = -1;\r\n          var urban = \"\";\r\n          var duplicate = false;\r\n          // Update location data to check for duplicates, ignoring this input-\r\n          update_user_zip_preferences(input.attr('id'));\r\n\r\n          // If zip codes, then returning zip code data for string input\r\n          if (location_data.zip_codes) {\r\n            // Lookup city, state - IF only one zip code, automatically input into input\r\n            var count_zips_returned = location_data.zip_array.length;\r\n            if (count_zips_returned > 1) {\r\n              appendSelect(\"city\", location_data.zip_select, location_data, input);\r\n              return;\r\n            }\r\n            // Count zips returned isn't greater than 1\r\n            zip = location_data.zip_array[0];\r\n            location_name = location_data.city;\r\n\r\n            input.val(zip);\r\n\r\n            // Check if state included. If not, it is a tribe\r\n            if (location_data.state != '') {\r\n              // Add state information\r\n              location_name = location_name + ', ' + location_data.state;\r\n            }\r\n            if (check_duplicate(location_name, zip)) {\r\n              print_error_message(field_suffix, \"Duplicate location name (\" + location_name + \") and zip code pairs are not allowed.\");\r\n              disable_zip_buttons(input);\r\n              duplicate = true;\r\n            }\r\n            if (!duplicate) {\r\n              // Gather FRS location data for zip code\r\n              if (location_data.zip_attr && zip in location_data.zip_attr) {\r\n                pop = location_data.zip_attr[zip].pop;\r\n                urban = location_data.zip_attr[zip].urban;\r\n              }\r\n              // If city population exists, override FRS zip population\r\n              if (location_data.city_attr && location_name in location_data.city_attr) {\r\n                pop = location_data.city_attr[location_name].pop;\r\n              }\r\n              // If pop returned 0 rewrite to -1 so it does not select\r\n              if (parseInt(pop) === 0) {\r\n                pop = -1;\r\n              }\r\n              field_suffix.html(location_name);\r\n              field_suffix.attr('commsize', pop);\r\n              if (urban == \"Urban\") {\r\n                field_suffix.attr('isurban', '1');\r\n              } else if (urban == \"Rural\") {\r\n                field_suffix.attr('isurban', '0');\r\n              }\r\n              processPrimaryFields();\r\n              update_user_zip_preferences();\r\n            }\r\n          } // Ends if location_data.zip_codes\r\n          else { // Returning zip codes for selection\r\n            if (location_data.city_select) {// multiple zip codes found found\r\n              appendSelect(\"zip\", location_data.city_select, location_data, input);\r\n              return;\r\n            }\r\n\r\n            if (location_data.zip) {\r\n              zip = location_data.zip;\r\n            } else {\r\n              zip = location_data.zip_array[0];\r\n            }\r\n            location_name = location_data.city[0];\r\n            if (check_duplicate(location_name, zip)) {\r\n              print_error_message(field_suffix, \"Duplicate location name (\" + location_name + \") and zip code pairs are not allowed.\");\r\n              disable_zip_buttons(input);\r\n              duplicate = true;\r\n            }\r\n            if (!duplicate) {\r\n              field_suffix.html(location_name);\r\n              if (location_data.zip_attr && zip in location_data.zip_attr) {\r\n                pop = location_data.zip_attr[zip].pop;\r\n                urban = location_data.zip_attr[zip].urban;\r\n              }\r\n              if (location_data.city_attr && location_name in location_data.city_attr) {\r\n                pop = location_data.city_attr[location_name].pop;\r\n              }\r\n              // If pop returned 0 rewrite to -1 so it does not select\r\n              if (parseInt(pop) === 0) {\r\n                pop = -1;\r\n              }\r\n              field_suffix.attr('commsize', pop);\r\n              if (urban == \"Urban\") {\r\n                field_suffix.attr('isurban', '1');\r\n              } else if (urban == \"Rural\") {\r\n                field_suffix.attr('isurban', '0');\r\n              }\r\n\r\n              update_user_zip_preferences();\r\n              $('.remove-button').prop(\"disabled\", false);\r\n            }\r\n          }\r\n          if (!existingLocationErrors()) {\r\n            resetButtons();\r\n          }\r\n          // processPrimaryFields();\r\n          moveAddButton();\r\n          field_suffix.closest(\"td\").find('.field_zip_code').focus();\r\n        }).fail(function (location_data) {\r\n          print_error_message(field_suffix, location_data.error_message);\r\n          disable_zip_buttons(input);\r\n        });\r\n      }\r\n    }\r\n  } // End checkLocation\r\n\r\n  // Enable Save button / plus button\r\n  function resetButtons() {\r\n    $('body').find('.field-add-more-submit').show();\r\n    $('#edit-field-zip-code .field-add-more-submit').prop(\"disabled\", false);\r\n    $('#edit-submit').prop(\"disabled\", false);\r\n    $('#edit-submit--2').prop(\"disabled\", false);\r\n    $('#edit-delete').prop(\"disabled\", false);\r\n    $('.field_zip_code').prop(\"disabled\", false);\r\n  }\r\n\r\n  // On an Drupal Ajax call- if there is an error, hide the actual Save and +\r\n  function hideButtons() {\r\n    $('#edit-field-zip-code').find('.field-add-more-submit').prop(\"disabled\", true);\r\n    $('#edit-submit').prop(\"disabled\", true);\r\n    $('#edit-submit--2').prop(\"disabled\", true);\r\n    $('#edit-delete').prop(\"disabled\", true);\r\n  }\r\n\r\n  /**\r\n   * Check if error exists in zip code settings\r\n   * @returns {boolean}\r\n   */\r\n  function existingLocationErrors() {\r\n    var num_errors = $('#edit-field-zip-code').find('.error').length;\r\n    return num_errors > 0;\r\n  }\r\n\r\n  /**\r\n   * When the user edits the location size and urban flag, update the currently select primary setting\r\n   * @param comm_size\r\n   * @param isurban\r\n   */\r\n  function updatePrimaryLocationDataSize($select_elem) {\r\n    var select_text = $select_elem.text();\r\n    var replace_text = select_text.replace(/,/g, '').replace(' ', '').replace('+', '');\r\n    var location_of_dash = replace_text.indexOf('-');\r\n    var number_text;\r\n    if (location_of_dash > -1) {\r\n      number_text = replace_text.substr(0, replace_text.indexOf('-'));\r\n    } else {\r\n      number_text = replace_text;\r\n    }\r\n    var number = parseInt(number_text);\r\n    var $primary = $('.field-name-field-field-primary').find('input:checked');\r\n    var $field_suffix = $primary.closest('tr').find('.field-suffix');\r\n    if ($field_suffix.find('.field-suffix-data').length > 0) {\r\n      $field_suffix.find('.field-suffix-data').attr('commsize', number);\r\n    } else {\r\n      $field_suffix.attr('commsize', number);\r\n    }\r\n  }\r\n\r\n  function updatePrimaryLocationDataUrban(urban) {\r\n    var $primary = $('.field-name-field-field-primary').find('input:checked');\r\n    var $field_suffix = $primary.closest('tr').find('.field-suffix');\r\n    var isurban = \"_none\";\r\n    if (urban === \"urban\") {\r\n      isurban  = 1;\r\n    } else if (urban === \"rural\") {\r\n      isurban = 0;\r\n    }\r\n    if ($field_suffix.find('.field-suffix-data').length <= 0) {\r\n      $field_suffix.attr(\"isurban\", isurban);\r\n    } else {\r\n      $field_suffix.find('.field-suffix-data').attr(\"isurban\", isurban);\r\n    }\r\n  }\r\n\r\n\r\n  $(document).ready(function () {\r\n\r\n    // If No radio selection has been made, select \"N/A\". This has not action in Drupal's db so it is not set by defautl\r\n    var $urban_check =  $('#edit-field-community-type-und');\r\n    if ($urban_check.find('input:checked').length === 0) {\r\n      $urban_check.val(\"_none\").find('input[value=\"_none\"]').prop(\"checked\", true);\r\n    }\r\n\r\n    $urban_check.find('input').change( function() {\r\n      var isurban = $(this).val();\r\n      updatePrimaryLocationDataUrban(isurban);\r\n      update_user_zip_preferences();\r\n    });\r\n\r\n    $('#edit-field-community-size-und').change( function() {\r\n      updatePrimaryLocationDataSize($(this).find('option:selected'));\r\n      update_user_zip_preferences();\r\n    });\r\n\r\n\r\n    $('body').find('.field-multiple-table').removeClass('sticky-enabled');\r\n    $('#profile-locations').find('.sticky-header').remove();\r\n\r\n    $(document).click(function (e) {\r\n      // The latest element clicked\r\n      mouse_click = $(e.target);\r\n    });\r\n\r\n    $('body').on('click', '.zip-code-primary-select', function () {\r\n      var $field_suffix = $(this).closest('tr').find('.field-suffix');\r\n      if (!$field_suffix.hasClass('field-suffix-data')) {\r\n        $field_suffix = $field_suffix.find('.field-suffix-data');\r\n      }\r\n      var comm_size = $field_suffix.attr('commsize');\r\n      var urban = $field_suffix.attr('isurban');\r\n      $('.zip-code-primary-select.selected').removeClass('selected');\r\n      $('.zip-code-primary-select').prop('title', 'Set to default location');\r\n      $('.zip-code-primary-select').closest('td').find('input[type=checkbox]:checked').prop('checked', false);\r\n      var original_star = $('.zip-code-primary-select').find('i');\r\n      original_star.addClass('fa-star-o');\r\n      original_star.removeClass('fa-star');\r\n      var selected_icon = $(this);\r\n      selected_icon.addClass('selected');\r\n      selected_icon.prop('title', 'Default location');\r\n      var selected_icon_star = selected_icon.find('i');\r\n      selected_icon_star.removeClass('fa-star-o');\r\n      selected_icon_star.addClass('fa-star');\r\n      selected_icon_star.closest('td').find('input[type=checkbox]').prop('checked', true);\r\n      var screenreader_indicator = $(this).find('.sr-only');\r\n      screenreader_indicator.text('Default location');\r\n      // get location offset by regexing the id\r\n      setCommunitySizeType(comm_size, urban);\r\n      //update session data without adding new community data\r\n      update_user_zip_preferences();\r\n    });\r\n\r\n    $('body').on('click', '.zip-code-primary-select.selected', function () {\r\n      $(this).removeClass('selected');\r\n      $(this).prop('title', 'Set to default location');\r\n      var selected_icon = $(this).find('i');\r\n      selected_icon.removeClass('fa-star');\r\n      selected_icon.addClass('fa-star-o');\r\n      selected_icon.closest('td').find('input[type=checkbox]').prop('checked', false);\r\n      var screenreader_indicator = $(this).find('.sr-only');\r\n      screenreader_indicator.text('Set to default location');\r\n    });\r\n\r\n\r\n    $('body').on('focus', '.field_zip_code', function () {\r\n      lastVal = $(this).val();\r\n      $('.field_zip_code').on('change', function () {\r\n        $('.form-submit').prop(\"disabled\", true);\r\n      });\r\n      $(\".field_zip_code\").keyup(function (e) {\r\n        if ($(this).val() != '' && (lastVal != $(this).val())) {\r\n          hideButtons();\r\n        }\r\n      });\r\n    });\r\n\r\n    $('#user-profile-select-zip').on('keyup', function (e) {\r\n      if (e.which == 13) { // Enter key\r\n        $(this).trigger('click');\r\n      }\r\n    });\r\n\r\n    $('body').on('blur', '.field_zip_code', function (e) {\r\n      // Search for location on Enter click even if same value\r\n      if (lastVal != $(this).val() || enter_pressed || show_locations_again) {\r\n        fieldChanged = $(e.target);\r\n        checkLocation(fieldChanged, \"textfield\");\r\n        // Reset flags\r\n        enter_pressed = false;\r\n        show_locations_again = false;\r\n      }\r\n    });\r\n\r\n    $('body').on('click', '.form-submit', function (e) {\r\n      mouse_click = $(e.target);\r\n      checkLocation(mouse_click, \"button\");\r\n    });\r\n\r\n    $('body').on('click', 'button', function (e) {\r\n      mouse_click = $(e.target);\r\n      checkLocation(mouse_click, \"button\");\r\n      if ($('.field-suffix').hasClass('error')) {\r\n        hideButtons();\r\n      }\r\n      mouse_click.closest(\"td\").find(\".field_zip_code\").focus();\r\n    });\r\n\r\n\r\n    var path = window.location.pathname;\r\n    var page = path.split('/')[1];\r\n    if (page == 'user') {\r\n\r\n      $(\"#edit-submit\").prependTo(\".edit-user-profile\");\r\n      $(document).ajaxSuccess(function (event, xhr, settings) {\r\n        var target_url = settings.url;\r\n\r\n        if (target_url == '/multifield/field-remove-item/ajax') {\r\n          if (existingLocationErrors()) {\r\n            hideButtons();\r\n          }\r\n          else {\r\n            resetButtons();\r\n          }\r\n          // Update zip session data\r\n          update_user_zip_preferences();\r\n        }\r\n        // determine which table to place the Add Another button\r\n        if (target_url == '/system/ajax' || target_url == '/multifield/field-remove-item/ajax') {\r\n          var table_id = '';\r\n          var parent_id = '';\r\n          $('.field-multiple-table').each(function () {\r\n            var table = $(this);\r\n            var add_button = table.find('tr:last').find('td:nth-child(2)').find('.field-add-more-submit');\r\n            if (add_button.length == 0) {\r\n              table_id = table.attr('id');\r\n            }\r\n          });\r\n          if (inString(table_id, 'zip-code')) {\r\n            parent_id = '#zipcode_description';\r\n          }\r\n          else {\r\n            parent_id = '#links_description';\r\n          }\r\n\r\n          if (table_id != '') {\r\n            placeAddAnotherButton(false, '#' + table_id, parent_id);\r\n          }\r\n          processPrimaryFields();\r\n        }\r\n        moveAddButton();\r\n      });\r\n\r\n      //Add hide and show functionality for the local government user options\r\n      $org_select = $('#edit-field-organization select');\r\n\r\n      $org_select.change(function () {\r\n        $local_gov_opts = $('.local-government-options');\r\n        if ($(this).find('option:selected').text() == 'Local government') {\r\n          $local_gov_opts.show();\r\n        }\r\n        else {\r\n          $local_gov_opts.hide();\r\n        }\r\n      });\r\n\r\n      Drupal.tableDrag.prototype.row.prototype.onSwap = function (swappedRow) {\r\n        var table = $(swappedRow).closest('table');\r\n        var table_id = '#' + table.attr('id');\r\n        var parent_id = '';\r\n        if (inString(table_id, 'zip-code')) {\r\n          parent_id = '#zipcode_description';\r\n        }\r\n        else {\r\n          parent_id = '#links_description';\r\n        }\r\n        placeAddAnotherButton(false, table_id, parent_id);\r\n      };\r\n      $('#profile-tabs').tabs();\r\n      // Update session on page load for zip mapping\r\n      update_user_zip_preferences();\r\n    }\r\n\r\n    if (page == 'app-connect') {\r\n      $('#app-connect-tabs').tabs();\r\n    }\r\n\r\n\r\n    // Delete user profile\r\n    $('#edit-delete').click(function (e) {\r\n      var delete_button = $(this);\r\n      $.fancybox({\r\n        content: $('#delete-holder'),\r\n        'width': 400,\r\n        'height': 150,\r\n        'autoSize': false\r\n      });\r\n\r\n      // If confirmed delete, unbind prevent default and trigger click to continue action\r\n      $('#confirm-delete-profile').unbind('click').click(function () {\r\n        delete_button.unbind('click');\r\n        delete_button.trigger('click');\r\n      });\r\n\r\n      $('#cancel-delete-profile').unbind('click').click(function () {\r\n        $.fancybox.close();\r\n      });\r\n\r\n      e.preventDefault();\r\n    });\r\n\r\n    $('.remove-button').click(function () {\r\n\r\n    });\r\n\r\n    processPrimaryFields();\r\n    placeAddAnotherButton(false, '#field-zip-code-values', '#zipcode_description');\r\n    $('#zipcode_description').show();\r\n  });\r\n})(jQuery);\r\n"]}