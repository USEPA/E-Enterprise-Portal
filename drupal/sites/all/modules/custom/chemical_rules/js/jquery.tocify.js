!function(tocify){"use strict";tocify(window.jQuery,window,document)}(function($,window,document,undefined){"use strict";var tocClassName="tocify",tocFocusClassName="tocify-focus",tocHoverClassName="tocify-hover",hideTocClassName="tocify-hide",headerClassName="tocify-header",headerClass="."+headerClassName,subheaderClassName="tocify-subheader",subheaderClass="."+subheaderClassName,itemClassName="tocify-item",itemClass="."+itemClassName,extendPageClassName="tocify-extend-page",extendPageClass="."+extendPageClassName;$.widget("toc.tocify",{version:"1.9.0",options:{context:"body",ignoreSelector:null,selectors:"h1, h2, h3",showAndHide:!0,showEffect:"slideDown",showEffectSpeed:"medium",hideEffect:"slideUp",hideEffectSpeed:"medium",smoothScroll:!0,smoothScrollSpeed:"medium",scrollTo:0,showAndHideOnScroll:!0,highlightOnScroll:!0,highlightOffset:40,theme:"bootstrap",extendPage:!0,extendPageOffset:100,history:!0,scrollHistory:!1,hashGenerator:"compact",highlightDefault:!0},_create:function(){var self=this;self.extendPageScroll=!0,self.items=[],self._generateToc(),self._addCSSClasses(),self.webkit=function(){for(var prop in window)if(prop&&prop.toLowerCase().indexOf("webkit")!==-1)return!0;return!1}(),self._setEventHandlers(),$(window).load(function(){self._setActiveElement(!0),$("html, body").promise().done(function(){setTimeout(function(){self.extendPageScroll=!1},0)})})},_generateToc:function(){var firstElem,ul,self=this,ignoreSelector=self.options.ignoreSelector;return firstElem=this.options.selectors.indexOf(",")!==-1?$(this.options.context).find(this.options.selectors.replace(/ /g,"").substr(0,this.options.selectors.indexOf(","))):$(this.options.context).find(this.options.selectors.replace(/ /g,"")),firstElem.length?(self.element.addClass(tocClassName),void firstElem.each(function(index){$(this).is(ignoreSelector)||(ul=$("<ul/>",{id:headerClassName+index,class:headerClassName}).append(self._nestElements($(this),index)),self.element.append(ul),$(this).nextUntil(this.nodeName.toLowerCase()).each(function(){0===$(this).find(self.options.selectors).length?$(this).filter(self.options.selectors).each(function(){$(this).is(ignoreSelector)||self._appendSubheaders.call(this,self,ul)}):$(this).find(self.options.selectors).each(function(){$(this).is(ignoreSelector)||self._appendSubheaders.call(this,self,ul)})}))})):void self.element.addClass(hideTocClassName)},_setActiveElement:function(pageload){var self=this,hash=window.location.hash.substring(1),elem=self.element.find('li[data-unique="'+hash+'"]');return hash.length?(self.element.find("."+self.focusClass).removeClass(self.focusClass),elem.addClass(self.focusClass),self.options.showAndHide&&elem.click()):(self.element.find("."+self.focusClass).removeClass(self.focusClass),!hash.length&&pageload&&self.options.highlightDefault&&self.element.find(itemClass).first().addClass(self.focusClass)),self},_nestElements:function(self,index){var arr,item,hashValue;return arr=$.grep(this.items,function(item){return item===self.text()}),arr.length?this.items.push(self.text()+index):this.items.push(self.text()),hashValue=this._generateHashValue(arr,self,index),item=$("<li/>",{class:itemClassName,"data-unique":hashValue}).append($("<a/>",{text:self.text()})),self.before($("<div/>",{name:hashValue,"data-unique":hashValue})),item},_generateHashValue:function(arr,self,index){var hashValue="",hashGeneratorOption=this.options.hashGenerator;if("pretty"===hashGeneratorOption){for(hashValue=self.text().toLowerCase().replace(/\s/g,"-");hashValue.indexOf("--")>-1;)hashValue=hashValue.replace(/--/g,"-");for(;hashValue.indexOf(":-")>-1;)hashValue=hashValue.replace(/:-/g,"-")}else hashValue="function"==typeof hashGeneratorOption?hashGeneratorOption(self.text(),self):self.text().replace(/\s/g,"");return arr.length&&(hashValue+=""+index),hashValue},_appendSubheaders:function(self,ul){var index=$(this).index(self.options.selectors),previousHeader=$(self.options.selectors).eq(index-1),currentTagName=+$(this).prop("tagName").charAt(1),previousTagName=+previousHeader.prop("tagName").charAt(1);currentTagName<previousTagName?self.element.find(subheaderClass+"[data-tag="+currentTagName+"]").last().append(self._nestElements($(this),index)):currentTagName===previousTagName?ul.find(itemClass).last().after(self._nestElements($(this),index)):ul.find(itemClass).last().after($("<ul/>",{class:subheaderClassName,"data-tag":currentTagName})).next(subheaderClass).append(self._nestElements($(this),index))},_setEventHandlers:function(){var self=this;this.element.on("click.tocify","li",function(event){if(self.options.history&&(window.location.hash=$(this).attr("data-unique")),self.element.find("."+self.focusClass).removeClass(self.focusClass),$(this).addClass(self.focusClass),self.options.showAndHide){var elem=$('li[data-unique="'+$(this).attr("data-unique")+'"]');self._triggerShow(elem)}self._scrollTo($(this))}),this.element.find("li").on({"mouseenter.tocify":function(){$(this).addClass(self.hoverClass),$(this).css("cursor","pointer")},"mouseleave.tocify":function(){"bootstrap"!==self.options.theme&&$(this).removeClass(self.hoverClass)}}),(self.options.extendPage||self.options.highlightOnScroll||self.options.scrollHistory||self.options.showAndHideOnScroll)&&$(window).on("scroll.tocify",function(){$("html, body").promise().done(function(){var elem,lastElem,lastElemOffset,currentElem,winScrollTop=$(window).scrollTop(),winHeight=$(window).height(),docHeight=$(document).height(),scrollHeight=$("body")[0].scrollHeight;if(self.options.extendPage&&(self.webkit&&winScrollTop>=scrollHeight-winHeight-self.options.extendPageOffset||!self.webkit&&winHeight+winScrollTop>docHeight-self.options.extendPageOffset)&&!$(extendPageClass).length){if(lastElem=$('div[data-unique="'+$(itemClass).last().attr("data-unique")+'"]'),!lastElem.length)return;lastElemOffset=lastElem.offset().top,$(self.options.context).append($("<div />",{class:extendPageClassName,height:Math.abs(lastElemOffset-winScrollTop)+"px","data-unique":extendPageClassName})),self.extendPageScroll&&(currentElem=self.element.find("li.active"),self._scrollTo($('div[data-unique="'+currentElem.attr("data-unique")+'"]')))}setTimeout(function(){var anchorText,closestAnchorDistance=null,closestAnchorIdx=null,anchors=$(self.options.context).find("div[data-unique]");anchors.each(function(idx){var distance=Math.abs(($(this).next().length?$(this).next():$(this)).offset().top-winScrollTop-self.options.highlightOffset);return(null==closestAnchorDistance||distance<closestAnchorDistance)&&(closestAnchorDistance=distance,void(closestAnchorIdx=idx))}),anchorText=$(anchors[closestAnchorIdx]).attr("data-unique"),elem=$('li[data-unique="'+anchorText+'"]'),self.options.highlightOnScroll&&elem.length&&(self.element.find("."+self.focusClass).removeClass(self.focusClass),elem.addClass(self.focusClass)),self.options.scrollHistory&&window.location.hash!=="#"+anchorText&&window.location.replace("#"+anchorText),self.options.showAndHideOnScroll&&self.options.showAndHide&&self._triggerShow(elem,!0)},0)})})},show:function(elem,scroll){var self=this;if(!elem.is(":visible"))switch(elem.find(subheaderClass).length||elem.parent().is(headerClass)||elem.parent().is(":visible")?elem.children(subheaderClass).length||elem.parent().is(headerClass)||(elem=elem.closest(subheaderClass)):elem=elem.parents(subheaderClass).add(elem),self.options.showEffect){case"none":elem.show();break;case"show":elem.show(self.options.showEffectSpeed);break;case"slideDown":elem.slideDown(self.options.showEffectSpeed);break;case"fadeIn":elem.fadeIn(self.options.showEffectSpeed);break;default:elem.show()}return elem.parent().is(headerClass)?self.hide($(subheaderClass).not(elem)):self.hide($(subheaderClass).not(elem.closest(headerClass).find(subheaderClass).not(elem.siblings()))),self},hide:function(elem){var self=this;switch(self.options.hideEffect){case"none":elem.hide();break;case"hide":elem.hide(self.options.hideEffectSpeed);break;case"slideUp":elem.slideUp(self.options.hideEffectSpeed);break;case"fadeOut":elem.fadeOut(self.options.hideEffectSpeed);break;default:elem.hide()}return self},_triggerShow:function(elem,scroll){var self=this;return elem.parent().is(headerClass)||elem.next().is(subheaderClass)?self.show(elem.next(subheaderClass),scroll):elem.parent().is(subheaderClass)&&self.show(elem.parent(),scroll),self},_addCSSClasses:function(){return"jqueryui"===this.options.theme?(this.focusClass="ui-state-default",this.hoverClass="ui-state-hover",this.element.addClass("ui-widget").find(".toc-title").addClass("ui-widget-header").end().find("li").addClass("ui-widget-content")):"bootstrap"===this.options.theme?(this.element.find(headerClass+","+subheaderClass).addClass("nav nav-list"),this.focusClass="active"):(this.focusClass=tocFocusClassName,this.hoverClass=tocHoverClassName),this},setOption:function(){$.Widget.prototype._setOption.apply(this,arguments)},setOptions:function(){$.Widget.prototype._setOptions.apply(this,arguments)},_scrollTo:function(elem){var self=this,duration=self.options.smoothScroll||0,scrollTo=self.options.scrollTo,currentDiv=$('div[data-unique="'+elem.attr("data-unique")+'"]');return currentDiv.length?($("html, body").promise().done(function(){$("html, body").animate({scrollTop:currentDiv.offset().top-($.isFunction(scrollTo)?scrollTo.call():scrollTo)+"px"},{duration:duration})}),self):self}})});
//# sourceMappingURL=src/jquery.tocify.js.map