{"version":3,"sources":["chemical_rules.js"],"names":["repair_chemical_rules_profile","cr_showElementOutOfMany","$wrapper_to_show","$common_selector","hide","show","cr_resizeModal","jQuery","dialog","position","my","at","width","$","window","height","css","replace","length","create_favlaw_heart","epaintnum","favs","Drupal","settings","chemical_rules","profile","Chemicals","Laws","NAICS","law_in_favorites","Object","keys","find_matching_favorites","fav_law_holder","check_id","check_type","match_found","i","favID","ID","is_valid_cas_number","stringToCheck","cas","casgroup","exec","checkDigit","split","reduce","previousValue","currentValue","currentIndex","array","lookup_chemical","lookup_value","$body","find","val","trigger","populate_substance_modal","chemical_rules_response_json","json","cas_reg_num","data","error","prop","remove","Substance","CASRegistryNumber","text","ChemicalSubstanceSystematicName","$list","$synonyms","$image","$propertiestable","$substance_lists","html_to_add","substance_lists","favorite_exists","EPAChemicalInternalNumber","attr","EPAChemicalRegistryName","parent","html","cfr_id","SubstanceList","LawsRegs","push","index","cfrId","fav_holder","attributes","URL","Title","append","join","synonym_list","Synonym","each","this","sort","Image","tr_start","tr_end","properties","MolecularWeight","Solubility","VaporPressure","LogP","Stability","pKA","addClass","before","render_favorite_chemicals","num_chem_faves","favorite_chemicals","CAS","link_casnum","include_commonname","CommonName","SysName","render_naics_codes","num_naics_faves","favorite_codes","render_favorite_laws","num_rules_faves","favorite_laws","Citation","reset_cr_form","$form","trigger_law_qTip","findLink","hideQtip","findQtip","err","update_clicked_heart","this_link","filled_if_true","removeClass","update_favorite_lists","type","isValidCasNumber","console","log","originalDialog","tabs","on","render_favorites","$cr_empty","$cr_avail","modal","title","closeOnEscape","dialogClass","draggable","autoOpen","resizable","create","event","ui","resize","open","close","ev","chem_search_form_data","serialize","chem_search_input","preventDefault","stopPropagation","is_valid_chemical","ajax","url","method","beforeSend","complete","success","chemicalNameOrNum","removeAttr","error_message","insertBefore","cas_clicked","clicked_favorite_ID","clicked_favorite_type","updatedFavs","item","hasClass","update_chem_profile","favorite","cas_num","law_text","prev","law_pieces","citation","trim","undefined","basePath","dataType","JSON","stringify","done","arguments","fail","$chemical_loading","$all_wrappers","sticky_gap","offset","top","scroll","scrollTop","toc_bottom","target_top","hash","scroll_amount","animate"],"mappings":"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","file":"chemical_rules.js","sourcesContent":["var originalDialog;\nvar favs = (Drupal.settings.chemical_rules.profile) ? Drupal.settings.chemical_rules.profile : {'Chemicals':[],'Laws':[], 'NAICS':[]};\n\nfunction repair_chemical_rules_profile() {\n\n}\nfunction cr_showElementOutOfMany($wrapper_to_show, $common_selector) {\n  $common_selector.hide();\n  $wrapper_to_show.show();\n  cr_resizeModal()\n}\n\nfunction cr_resizeModal() {\n  jQuery('#chemical-rules-modal').dialog({\n    position: { 'my': 'center', 'at': 'center' },\n    width: $(window).width()-180,\n    height: $(window).height()-180,\n  });\n  if(jQuery('.chemical-rules-modal').css('top').replace('px', '') < 1){\n    jQuery('.chemical-rules-modal').css('top', 0);\n  }\n  if (jQuery('.sticky-toc').length > 0) {\n    jQuery('#cr-modal-toc-icons').css('width', jQuery('#chemical-rules-modal').width()+6);\n  }\n}\n\nfunction create_favlaw_heart(epaintnum) {\n\n  var favs = (Drupal.settings.chemical_rules.profile) ? Drupal.settings.chemical_rules.profile : {'Chemicals':[],'Laws':[], 'NAICS':[]};\n  var law_in_favorites = (Object.keys(favs.Laws).length > 0) ? find_matching_favorites(epaintnum, \"Laws\") : false;\n  var fav_law_holder = '';\n\n  if (law_in_favorites === false) {\n    fav_law_holder = '<a href=\"javascript:void(0);\" class=\"fa fa-heart empty save-favorite\" data-epaintnum=\"' + epaintnum + '\" data-favtype=\"Law\"><span class=\"sr-only\">Click to favorite.</span></a>';\n  }\n  else {\n    fav_law_holder = '<a href=\"javascript:void(0);\" class=\"fa fa-heart filled remove-link remove-favorite\" data-epaintnum=\"' + epaintnum + '\" data-favtype=\"Law\"><span class=\"sr-only\">Favorited. Click to unfavorite.</span></a>';\n  }\n\n  return fav_law_holder;\n\n}\n\nfunction find_matching_favorites(check_id, check_type) {\n  var match_found = false,\n    favs = (Drupal.settings.chemical_rules.profile) ? Drupal.settings.chemical_rules.profile : {'Chemicals':[],'Laws':[], 'NAICS':[]};\n  var length = (favs[check_type]) ? favs[check_type].length : 0;\n\n  for (var i = 0; i < length; i++) {\n  \tfavID = favs[check_type][i].ID;\n    if (favID == check_id) {\n      match_found = true;\n  \t  return i;\n  \t}\n  }\n  if (match_found == false) {\n  \treturn false;\n  }\n}\n\nfunction is_valid_cas_number(stringToCheck) {\n  var cas = /(\\d{2,7}).{0,2}(\\d{2}).{0,2}(\\d)/g;\n  var casgroup = cas.exec(stringToCheck);\n  if(casgroup){\n    var checkDigit = (casgroup[1] + casgroup[2]).split('').reduce(function(previousValue, currentValue, currentIndex, array) {\n      return ((previousValue + (array[array.length - currentIndex -1] * (currentIndex + 1))) % 10)\n    }, 0)\n    return(checkDigit == casgroup[3])\n  }\n  return false\n}\n\nfunction lookup_chemical(lookup_value) {\n\n  var $body = $('body');\n  $body.find('#cr-search_input').val(lookup_value);\n  $body.find('#cr-search-chems-btn').trigger('click');\n\n}\n\nfunction populate_substance_modal(chemical_rules_response_json) {\n  var $body = $('body');\n  var json = chemical_rules_response_json;\n  var cas_reg_num = 'n/a';\n  var chem_reg_name = 'n/a';\n\n  if(json.data !== null && json.error === false){\n    if ($body.find('#search-message').length > 0) {\n      $body.find('#cr-search_input').prop('aria-describedby', false);\n      $body.find('#search-message').remove();\n    }\n    \n    if (json.data.Substance.CASRegistryNumber !== '' && json.data.Substance.CASRegistryNumber !== null) {\n      cas_reg_num = json.data.Substance.CASRegistryNumber + ': ';\n    }\n    \n    // populate our modal\n    $body.find('.cr-chemical-name').text(json.data.Substance.ChemicalSubstanceSystematicName);\n\n    var $list = $body.find('#cr-laws-regs-substances');\n    var $programs = $body.find('#cr-programs-list');\n    var $synonyms = $body.find('#cr-synonyms-list');\n    var $image = $body.find('.cr-structure_image');\n    var $propertiestable = $body.find('#cr-properties-table > tbody');\n    var $substance_lists = $body.find('#cr-substances-list');\n    var lists = [];\n    var cfrs = [];\n    var html_to_add = [];\n    var substance_lists = [];\n    var favorite_exists = (Object.keys(favs.Chemicals).length > 0) ? find_matching_favorites(json.data.Substance.EPAChemicalInternalNumber, \"Chemicals\") : false;\n    var count_all_cfrs = 0;\n    \n    $body.find('#cr-save-favorite').attr('data-epaintnum', json.data.Substance.EPAChemicalInternalNumber).attr('data-sysname', json.data.Substance.ChemicalSubstanceSystematicName);\n    $body.find('#metadata-sys-name').text(json.data.Substance.ChemicalSubstanceSystematicName);\n    if (json.data.Substance.EPAChemicalRegistryName !== null) {\n      $body.find('#cr-save-favorite').attr('data-commonname', json.data.Substance.EPAChemicalRegistryName);\n      $body.find('#metadata-common-name').text(json.data.Substance.EPAChemicalRegistryName);\n    }\n    else {\n      $body.find('#cr-save-favorite').attr('data-commonname', false);\n      $body.find('#metadata-common-name').text('n/a');  \n    }\n    if (json.data.Substance.CASRegistryNumber !== null) {\n      $body.find('#cr-save-favorite').attr('data-casnum', json.data.Substance.CASRegistryNumber);\n      $body.find('#metadata-cas-num').text(json.data.Substance.CASRegistryNumber);\n    }\n    else {\n      $body.find('#cr-save-favorite').attr('data-casnum', false);\n      $body.find('#metadata-cas-num').text('n/a');      \n    }    \n    $body.find('#cr-remove-favorite').attr('data-epaintnum', json.data.Substance.EPAChemicalInternalNumber).attr('data-favtype', 'Chemical');\n\n    if (favorite_exists === false) {\n      $body.find('#cr-save-favorite').parent('li').show();\n      $body.find('#cr-remove-favorite').parent('li').hide();\n    }\n    else {\n      $body.find('#cr-save-favorite').parent('li').hide();\n      $body.find('#cr-remove-favorite').parent('li').show();\n    }\n\n    $list.html('');\n    // Check whether Substance Lists exist.\n    // If so, for each,\n    //    1) get SubstanceList name data.SubstanceList[].substanceListName\n    //    2) then get list of CFRs\n    //    3) loop thru CFRs and look up CFR name and URL (LawsRegs.[variableforcfrnumber].cfrId, attributes.USC Citation, attributes.Title, attributes.URL\n\n    var cfr_id = '';\n    if(!!json.data.SubstanceList && Object.keys(json.data.SubstanceList).length && !!json.data.LawsRegs && Object.keys(json.data.LawsRegs).length) {\n        html_to_add.push('<ul class=\"cr-lists\">');        \n        for(var index in json.data.LawsRegs) {\n          cfr_id = json.data.LawsRegs[index].cfrId;\n          fav_holder = create_favlaw_heart(cfr_id);\n          html_to_add.push('<li><span class=\"law-entry\"><a data-favtype=\"Law\" data-epaintnum=\"' + cfr_id + '\" href=\"'+ json.data.LawsRegs[index].attributes.URL +'\" target=\"_blank\">' + json.data.LawsRegs[index].attributes[\"Citation\"] + \" &mdash; \" + json.data.LawsRegs[index].attributes.Title+'</a>' + fav_holder + '</span>');\n          html_to_add.push('<span class=\"law-citation\">Authority: ' + json.data.LawsRegs[index].attributes[\"CFR Authority\"] + '</span>');\n          html_to_add.push('<span class=\"law-lists\">Substance Lists: ' + json.data.LawsRegs[index]['substanceList'] + '</span></li>');\n        }\n      html_to_add.push('</ul>');\n      $list.append(html_to_add.join(\"\"));\n      $body.find('#count-all-cfrs').text(Object.keys(json.data.LawsRegs).length);\n      $body.find('#results-intro').text('  Relevant laws and regulations include:');\n    }\n    else {\n      // No laws regulations found\n      $body.find('#count-all-cfrs').text('No');\n      $body.find('#results-intro').text('');\n    }\n    \n/*  //@TODO Future - If Programs do Exist\n    $programs.html('');\n    if (json.data.Programs.length > 0) {\n      $(json.data.Programs).each(function(index){\n        //$('#cr-programs-count').text(json.data.Programs.length);\n        $programs.append('<li><a href=\"'+this.source+'\" target=\"_blank\">'+this.name+'</a></li>');\n      });\n    }\n    else {\n      // No programs found   \n    }\n*/\n    var synonym_list = [];\n    $synonyms.html('');\n    if (json.data.Substance.Synonym.length > 0) {\n      $(json.data.Substance.Synonym).each(function(index) {\n        //$('#cr-synonyms-count').text(json.data.Substance.Synonym.length);\n        synonym_list.push('<li>'+this+'</li>');\n      });\n      $synonyms.append(synonym_list.sort());\n    }\n    else {\n      // No synonyms found\n    }\n    \n    $image.html('');\n    if (json.data.Image != null && json.data.Image != '') {\n      $image.append('<img src=\"' + json.data.Image + '\" alt=\"A structure of ' + json.data.Substance.EPAChemicalRegistryName + '\"><p>Powered by <a href=\"https://pubchem.ncbi.nlm.nih.gov\" rel=\"external\" target=\"_blank\">PubChem</a></p>');\n    }\n    else {\n      // No images found\n      $image.append('No image available for this substance.');\n    }\n    \n    var tr_start = '<tr><th scope=\"row\">',\n        tr_end = '</td></tr>';\n\n    $propertiestable.html('');\n    var properties = tr_start + \"Molecular Weight <span class='cr-definition'></span></th><td>\" + json.data.Substance.MolecularWeight + tr_end;\n        properties += tr_start + \"Solubility <span class='cr-definition'>The solubility of a substance is the amount of that substance that will dissolve in a given amount of solvent. The default solvent is water, if not indicated.</span></th><td>\" + json.data.Substance.Solubility + tr_end;\n        properties += tr_start + \"Vapor Pressure <span class='cr-definition'>Vapor pressure is the pressure of a vapor in thermodynamic equilibrium with its condensed phases in a closed system.</span></th><td>\" + json.data.Substance.VaporPressure + tr_end;\n        properties += tr_start + \"LogP <span class='cr-definition'>Octanol/Water Partition Coefficient, used as a measure of molecular lipophilicity</span></th><td>\" + json.data.Substance.LogP + tr_end;\n        properties += tr_start + \"Stability <span class='cr-definition'>Tendency of a material to resist change or decomposition due to internal reaction, or due to the action of air, heat, light, pressure, etc. (See also Stability and Reactivity section under Safety and Hazards)</span></th><td>\" + json.data.Substance.Stability + tr_end;\n        properties += tr_start + \"pKA <span class='cr-definition'></span></th><td>\" + json.data.Substance.pKA + tr_end;\n             \n    $propertiestable.append(properties);\n    \n    $substance_lists.html('');\n    if (Object.keys(json.data.SubstanceList).length > 0) {\n      $(Object.keys(json.data.SubstanceList)).each(function(index) {\n          var substance_list_obj = json.data.SubstanceList[this];\n          substance_lists.push('<li>'+ this +'</li>');\n      });\n      $substance_lists.append(substance_lists.sort());\n    }\n    else {\n      $substance_lists.html('<p>No substance lists found for this chemical.</p>');\n    }\n    \n    $body.addClass('fixed-modal-open');\n  }\n  else {\n    //@TODO Add error msg for when there is bad data\n    $('#chemical-rules-modal').dialog(\"close\");\n    if (!$body.find('#search-message').length > 0) {\n      $body.find('#cr-search_description').before('<div id=\"search-message\" class=\"has-error\">No chemicals found.  Please try a different name or CAS #.</div>');\n      $body.find('#cr-search_input').prop('aria-describedby', 'search-message');\n    }\n  }\n\n}\n\nfunction render_favorite_chemicals(favs) {\n\n  var $body = $('body');\n  var num_chem_faves = (favs.Chemicals) ? favs.Chemicals.length: 0;\n\n  if (num_chem_faves) {\n    var favorite_chemicals = [];\n    $body.find('#cr-count-chemicals').text(num_chem_faves);\n    $.each(favs.Chemicals, function(index, val) {\n      var cas = '';\n      if (val.CAS != null && val.CAS != \"\") {\n        cas = val.CAS;\n        var link_casnum = \" data-casnum='\" + cas + \"' \";\n        cas = cas + \": \";\n      }\n      else {\n        link_casnum = '';\n      }\n      var include_commonname = '';\n      if (val.CommonName != null && val.CommonName != '') {\n        include_commonname = ' ('+ val.CommonName + ')';\n      }\n      favorite_chemicals.push('<li><a class=\"favorite-chemical cr-favorite\" href=\"javascript:void(0);\" data-favtype=\"Chemical\" data-sysname=\"' + val.SysName + '\" data-epaintnum=\"' + val.ID + '\" ' + link_casnum + 'data-commonname=\"' + val.CommonName + '\">' + cas + val.SysName + include_commonname +'</a><a class=\"favorite-chemical-remove remove-link\" data-favtype=\"Chemical\" data-epaintnum=\"' + val.ID + '\" data-commonname=\"' + val.CommonName + '\">Remove<span class=\"sr-only\"> ' + val.SysName + ' from favorites</span></a></li>');\n    });\n    $body.find('.cr-chemicals').show();\n    $body.find('.cr-favorite-chemicals').html(favorite_chemicals).show();\n  }\n\n  else {\n    $body.find('.cr-chemicals').hide();\n    $body.find('.cr-favorite-chemicals').html('').hide();\n  }\n}\n\nfunction render_naics_codes(favs) {\n  var $body = $('body');\n  var num_naics_faves = (favs.NAICS) ? favs.NAICS.length : 0;\n  if(num_naics_faves) {\n    var favorite_codes = [];\n    $.each(favs.NAICS, function(index, val) {\n      favorite_codes.push('<li><a class=\"favorite-code cr-favorite\" href=\"' + val.URL + '\" data-favtype=\"Code\" target=\"_blank\">' + val.ID + '</a></li>');\n    });\n    $body.find('.cr-codes').show();\n    $body.find('.cr-naics-codes').html(favorite_codes).show();\n  } else {\n    $body.find('.cr-codes').hide();\n    $body.find('.cr-naics-codes').html('').hide();\n  }\n}\n\nfunction render_favorite_laws(favs) {\n\n  var $body = $('body');\n  var num_rules_faves = (favs.Laws) ? favs.Laws.length : 0;\n\n  if (num_rules_faves) {\n    var favorite_laws = [];\n    $body.find('#cr-count-laws').text(num_rules_faves);\n    $.each(favs.Laws, function(index, val) {\n      favorite_laws.push('<li><a class=\"favorite-law cr-favorite\" href=\"' + val.URL + '\" data-favtype=\"Law\" data-epaintnum=\"' + val.ID + '\" target=\"_blank\">' + val.Citation + ':  ' + val.Title + '</a><a class=\"favorite-law-remove remove-link\" data-favtype=\"Law\" data-epaintnum=\"' + val.ID + '\">Remove<span class=\"sr-only\"> ' + val.Title + ' from favorites</span></a></li>');\n    });\n    $body.find('.cr-laws').show();\n    $body.find('.cr-favorite-laws').html(favorite_laws).show();\n  }\n  else {\n    $body.find('.cr-laws').hide();\n    $body.find('.cr-favorite-laws').html('').hide();\n  }\n}\n\n/**\n * Clear form inputs and hide warning messages\n */\nfunction reset_cr_form() {\n  var $form = $('#cr-search_input');\n  $form.val('');\n}\n\n/**\n * Manually trigger qTip that holds favorite heart icon to improve accessibility\n */\nfunction trigger_law_qTip(findLink, hideQtip) {\n    try {\n        if (hideQtip == true) {\n            $(findLink).trigger('mouseover');\n            findQtip = '#' + $(findLink).attr('aria-describedby');\n            return findQtip;\n        }\n        else {\n            $(findLink).trigger('mouseout');\n        }\n    }\n    catch (err) {\n        //console.log(\"Error on triggerQtip: \" + err);\n    }\n}\n\nfunction update_clicked_heart(this_link, filled_if_true) {\n\n  if (filled_if_true === true) {\n    this_link.removeClass('empty save-favorite');\n    this_link.addClass('filled remove-favorite remove-link'); \n  }\n  else if (filled_if_true === false) {\n    this_link.addClass('empty save-favorite');\n    this_link.removeClass('filled remove-favorite remove-link');     \n  }\n  \n}\n\nfunction update_favorite_lists(type) {\n  if (type == 'Chemical') {\n    render_favorite_chemicals(Drupal.settings.chemical_rules.profile);\n  }\n  else if (type == 'Law') {\n    render_favorite_laws(Drupal.settings.chemical_rules.profile);\n  }\n  else {\n    render_naics_codes(Drupal.settings.chemical_rules.profile);\n  }\n\n}\n\nfunction isValidCasNumber(stringToCheck) {\n  var cas = /(\\d{2,7}).{0,2}(\\d{2}).{0,2}(\\d)/g;\n  var casgroup = cas.exec(stringToCheck);\n  if(casgroup){\n    var checkDigit = (casgroup[1] + casgroup[2]).split('').reduce(function(previousValue, currentValue, currentIndex, array) {\n      return ((previousValue + (array[array.length - currentIndex -1] * (currentIndex + 1))) % 10)\n    }, 0)\n    return(checkDigit == casgroup[3])\n  }\n  console.log('invalid string')\n  return false\n}\n\n(function($) {\n  var $body = $('body'),\n      $cr_tabs = $('#cr-tabs').tabs(),\n      sampleSetIndex = 0,\n      num_chem_faves = 0,\n      num_rules_faves = 0;\n\n  $('#chem_search_form').on('submit', function() {\n    $('#cr-search-chems-btn').trigger('click');\n    return false;\n  })\n  \n\n  // CHEMICAL ATTRIBUTES\n  // ID = EPAChemicalInternalNumber\n  // CAS = CASRegistryNumber\n  // SysName = ChemicalSubstanceSystematicName (e.g., 2-Propanone)\n  // CommonName = EPAChemicalRegistryName (e.g., Acetone)\n\n  // LAW ATTRIBUTES\n  // ID = LRS ID = cfrID (e.g., 3874781)\n  // Citation (e.g., 40 CFR 711)\n  // Title (e.g., TSCA CHEMICAL DATA REPORTING REQUIREMENTS)\n  // URL (e.g., https:\\/\\/gpo.gov...)\n\n//   var favs = Drupal.settings.chemical_rules.profile;\n\n  // 1) Get favorites\n  // 2) Count number of favorite Chemicals and Laws\n\n  var render_favorites = function(favs) {\n    num_chem_faves = (favs.Chemicals) ? favs.Chemicals.length : 0;\n    num_rules_faves = (favs.Laws) ? favs.Laws.length : 0;\n    $cr_empty = $('.cr-tabs_favorites_empty');\n    $cr_avail = $('.cr-tabs_favorites_available')\n\n    if (num_chem_faves === 0 && num_rules_faves === 0) {\n      $cr_empty.show();\n      $cr_avail.hide();\n    }\n    else {\n      $cr_empty.hide();\n      $cr_avail.show();\n\n      render_favorite_chemicals(favs);\n      render_favorite_laws(favs);\n    }\n  }\n\n  render_favorites(favs);\n\n  // Initialize and open dialog\n  $('#chemical-rules-modal')\n    .html(Drupal.settings.chemical_rules.modal)\n    .dialog({\n      title: 'Results',\n      modal: true,\n      width: $(window).width()-180,\n      height: $(window).width()-180,\n      closeOnEscape: true,\n      position: { 'my': 'left top', 'at': 'left top' },\n      dialogClass: 'chemical-rules-modal',\n      draggable: false,\n      autoOpen: false,\n      resizable: false,      \n      create: function(event, ui) {\n        $(window).resize(function(){cr_resizeModal();})\n      },\n      open: function(event, ui) {\n        $('#chemical-rules-modal').parent().css('position', 'fixed');\n      },\n      close: function(event, ui) {\n        reset_cr_form();\n        $('#chemical-rules-modal').html(originalDialog);\n        $body.removeClass('fixed-modal-open');\n      }\n    });\n\n  // Handle Search chemicals button click\n  $body.on('click', '#cr-search-chems-btn', function(ev) {\n    var chem_search_form_data = $('#chem_search_form').serialize(),\n        chem_search_input = $body.find('#cr-search_input').val();\n    ev.preventDefault();\n    ev.stopPropagation();\n\n    if (chem_search_input !== '') {\n\n      //********\n      //@TODO - Call Create New Node function - may be part of form_submission\n      //********\n\n      var is_valid_chemical = true;\n\n      $.ajax({\n        url: 'chemical_rules/form_submission',\n        method: 'POST',\n        data: chem_search_form_data,\n        beforeSend: function() {\n          $('#chemical-rules-modal').dialog('option','title', 'Searching for ' + chem_search_input);\n          $body.find('#searching-chemical-name').text(chem_search_input);      \n          $('#chemical-rules-modal').dialog(\"open\");          \n          cr_showElementOutOfMany($('#chemical-rules-loading-wrapper'), $('.chemical-rules-modal-wrapper'));    \n        },\n        complete: function() {\n          $('#chemical-rules-modal').dialog('option','title', 'Search results for ' + chem_search_input);\n          cr_showElementOutOfMany($('#chemical-rules-results-wrapper'), $('#chemical-rules-loading-wrapper'));\n          originalDialog = $body.find('#chemical-rules-modal').html();\n        },\n        success: populate_substance_modal\n      });\n  \n      var chemicalNameOrNum = $body.find('#cr-search_input').val();\n      if ($body.find('#chemical-error').length > 0) {\n        $body.find('#chemical-error').remove();\n        $body.find('#cr-search_input').removeAttr('aria-describedby');\n      }\n      \n      if (!is_valid_chemical) {\n        error = true;\n        var error_message = '<p class=\"has-error\" id=\"chemical-error\">No results were found for <b>' + chemicalNameOrNum + '</b>.  Please try another variation.</p>';\n        $(error_message).insertBefore('#cr-search_description');\n        $body.find('#cr-search_input').attr('aria-describedby', 'chemical-error');\n      }  \n      \n      cr_resizeModal();\n    } \n    else {\n      // @TODO Error message - please enter value;\n    }\n    \n  });\n  \n  if ($body.find('.favorite-chemical').length > 0) {\n    $body.on('click', '.favorite-chemical', function(ev) {\n      var cas_clicked = $(this).attr('data-casnum');\n      if (typeof cas_clicked !== typeof undefined && cas_clicked !== false) {\n        lookup_chemical($(this).attr('data-casnum'));\n      }\n      else {\n        //var chem_name = $(this).text();\n        lookup_chemical($(this).attr('data-sysname')); \n      }\n      $('#chemical-rules-modal').dialog(\"open\");\n      $('#searching-chemical-name').text($(this).text());\n      $('#chemical-rules-modal').dialog(\"option\", \"title\", $(this).text());      \n      $body.addClass('fixed-modal-open');\n    });\n  }\n  \n  if ($body.find('.remove-link').length > 0) {\n    $body.on('click', '.remove-link', function(ev) {\n      ev.preventDefault();\n      var clicked_favorite_ID = $(this).data('epaintnum');\n      var clicked_favorite_type = $(this).data('favtype') + 's';\n\n      var updatedFavs = Drupal.settings.chemical_rules.profile[clicked_favorite_type].reduce(function(before, item, index, array){\n        (item.ID != clicked_favorite_ID) ? before.push(item) : before;\n        return before;\n      }, []);\n\n      Drupal.settings.chemical_rules.profile[clicked_favorite_type] = (updatedFavs) ? updatedFavs : [];\n\n      if ($(this).attr('id') == 'cr-remove-favorite') {\n        $body.find('#cr-save-favorite').parent('li').show();\n        $body.find('#cr-remove-favorite').parent('li').hide();\n      }\n      else if ($(this).hasClass('fa-heart')) {\n        update_clicked_heart($(this), false);\n      }\n\n      // Post updated array to Profile and re-render lists\n      render_favorites(Drupal.settings.chemical_rules.profile);\n      update_chem_profile(Drupal.settings.chemical_rules.profile);\n\n    });\n  }\n\n  if ($body.find('.save-favorite').length > 0) {\n    $body.on('click', '.save-favorite', function(ev) {\n      //ev.preventDefault();\n      //alert(\"Clicked the favorite: \" + $(this).data('chemicalid'));\n      var type = $(this).data('favtype') + 's';\n\n      var favorite = [];\n      if (type == 'Chemicals') {\n        if (($(this).data('casnum') !== '') && ($(this).data('casnum') !== null)) {\n          var cas_num = $(this).data('casnum');\n        }\n      \telse {\n        \tvar cas_num = '';\n      \t}\n      \tif (($(this).data('commonname') !== '') && ($(this).data('commonname') !== null)) {\n        \tvar common_name = $(this).data('commonname');\n      \t}\n      \telse {\n        \tvar common_name = '';\n      \t}\n        favorite = {\n        \tID: $(this).data('epaintnum'),\n          CAS: cas_num,\n          SysName: $(this).data('sysname'),\n          CommonName: $(this).data('commonname')\n        };\n        if ($(this).attr('id') == 'cr-save-favorite') {\n          $body.find('#cr-save-favorite').parent('li').hide();\n          $body.find('#cr-remove-favorite').parent('li').show();\n        }\n      }\n      else if (type == 'Laws') {\n        //@TODO - Add button holder container for favorite link heart like other links - or use FavoriteLink.js functionality\n        var law_text = $(this).prev(\"a\").text();\n        var law_pieces = law_text.split('\\u2014');\n        var citation = law_pieces[0].trim();\n        var title = law_pieces[1].trim();\n        favorite = {\n        \tID: $(this).data('epaintnum'),\n          Citation: citation,\n          Title: title,\n          URL: $(this).prev(\"a\").attr('href')\n        };\n        update_clicked_heart($(this), true);\n      }\n      if (favorite != '') {\n        if (!Drupal.settings.chemical_rules.profile) {\n          Drupal.settings.chemical_rules.profile = {'Chemicals':[],'Laws':[]};\n          update_chem_profile(Drupal.settings.chemical_rules.profile);\n        }        \n        if(Drupal.settings.chemical_rules.profile[type] === undefined) {\n          Drupal.settings.chemical_rules.profile[type] = [];\n          update_chem_profile(Drupal.settings.chemical_rules.profile);          \n        }\n        Drupal.settings.chemical_rules.profile[type].push(favorite);\n        update_chem_profile(Drupal.settings.chemical_rules.profile);\n        render_favorites(Drupal.settings.chemical_rules.profile);\n      }\n    });\n  }\n\n  update_chem_profile = function(profile) {\n    $.ajax({\n      method: \"POST\",\n      url: Drupal.settings.basePath + \"chemical_rules/update_chem_profile\",\n      dataType: 'json',\n      data: {\n        profile: JSON.stringify(profile)\n      },\n    }).done(function() {\n      console.log('done', arguments)\n      render_favorites(Drupal.settings.chemical_rules.profile);\n      //render_favorite_chemicals(favs);\n      //render_favorite_laws(favs);\n      //render_naics_codes(favs);\n      // @TODO - Update Modal List - call populate_substance_modal or subset of it!\n\n    }).fail(function() {\n      console.log('fail', arguments)\n    });\n  };\n\n  /**\n   * Close Listener on Chemical Rules Modal\n   * -  Remove Previous Results ?\n   * -  Cancel Pending Form submission\n   */\n  $('#chemical-rules-modal').on('dialogclose', function() {\n    var $chemical_loading = $('#chemical-rules-loading-wrapper');\n    var $all_wrappers = $('.chemical-rules-modal-wrapper');\n\n    cr_showElementOutOfMany($chemical_loading, $all_wrappers);\n    cr_resizeModal();\n  });\n\n  var sticky_gap = $('#cr-modal-toc-icons').offset().top;\n  $('#chemical-rules-modal').scroll(function() {\n    if ($('#chemical-rules-modal').scrollTop() > sticky_gap) {\n      $('#cr-modal-toc-icons').addClass('sticky-toc');\n      $('#cr-modal-toc-icons').css('width', $('#chemical-rules-modal').width()+6).css('top', $('#chemical-rules-modal').offset().top);\n    } \n    else {\n      $('#cr-modal-toc-icons').removeClass('sticky-toc').removeAttr('style');\n    }\n  });\n  \n  var sticky_gap = $('#cr-modal-toc-icons').offset().top;\n  $('#cr-modal-toc-icons li a').on('click', function(ev) {\n    ev.preventDefault();\n    // Scroll the modal to the anchor clicked\n    if (!$('#cr-modal-toc-icons').hasClass('sticky-toc')) {\n      $('#cr-modal-toc-icons').addClass('sticky-toc');\n      $('#cr-modal-toc-icons').css('width', $('#chemical-rules-modal').width()).css('top', $('#chemical-rules-modal').offset().top);\n    }\n    // Use the Laws and Regs heading as a landmark for gauging offset and scrolled amount\n    var toc_bottom = $('#cr-laws-regs').offset().top;\n    var target_top = $(this.hash).offset().top;\n    var scroll_amount = target_top - toc_bottom;\n    $(\"#chemical-rules-modal\").animate({ scrollTop: scroll_amount}, 500);\n  });\n  \n\n})(jQuery);\n\n"]}