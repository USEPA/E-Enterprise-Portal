{"version":3,"sources":["chemical_rules.js"],"names":["showElementOutOfMany","$wrapper_to_show","$common_selector","hide","show","resizeModal","jQuery","dialog","position","my","at","css","replace","checkValues","previous","current","cIndex","keys","previousKeys","Object","indexOf","Value","reduce","length","resetCRForm","$form","$","val","populate_substance_modal","chemical_rules_response_json","$body","data","error","Substance","CASRegistryNumber","ChemicalSubstanceSystematicName","find","text","EPAChemicalRegistryName","$list","$programs","$synonyms","$propertiestable","$substance_lists","EPAChemicalInternalNumber","LawsRegs","each","index","append","this","source","name","Programs","Synonym","tr_start","tr_end","properties","MolecularWeight","Solubility","VaporPressure","LogP","Stability","pKA","SubstanceList","sampleData","num_chem_faves","tabs","num_rules_faves","$cr_empty","$cr_avail","toggleClass","html","Drupal","settings","chemical_rules","modal","title","width","dialogClass","draggable","autoOpen","create","event","ui","close","on","ev","chem_search_form_data","serialize","ajax","url","method","before_send","complete","success","chemicalNameOrNum","remove","removeAttr","is_valid_chemical","toc","selectors","container","itemClass","i","heading","$heading","prefix","tagName","toLowerCase","error_message","insertBefore","attr","$chemical_loading","$all_wrappers"],"mappings":"AAAA,QAASA,sBAAqBC,iBAAkBC,kBAC9CA,iBAAiBC,OACjBF,iBAAiBG,OACjBC,cAGF,QAASA,eACPC,OAAO,yBAAyBC,QAC9BC,UAAYC,GAAM,SAAUC,GAAM,YAEjCJ,OAAO,yBAAyBK,IAAI,OAAOC,QAAQ,KAAM,IAAM,GAChEN,OAAO,yBAAyBK,IAAI,MAAO,GAI/C,QAASE,aAAYC,SAAUC,QAASC,OAAQC,MAC9C,GAAIC,gBAcJ,OAboC,gBAA1BJ,UAASG,KAAKD,WACtBE,aAAeC,OAAOF,KAAKH,SAASG,KAAKD,WAGtCE,aAAaE,QAAQ,UAAW,GAAsC,IAAhCN,SAASG,KAAKD,SAASK,YACzDP,UAASG,KAAKD,UAEb,UAAUI,cAAeN,UAASG,KAAKD,WAAY,IAC3DF,SAASG,KAAKD,SAAWE,aAAaI,OAAOT,YAAaC,SAASG,KAAKD,UACtB,GAA9CG,OAAOF,KAAKH,SAASG,KAAKD,UAAUO,cAC/BT,UAASG,KAAKD,UAGlBF,SAQT,QAASU,eACP,GAAIC,OAAQC,EAAE,aAEdD,OAAME,IAAI,IAGZ,QAASC,0BAAyBC,8BAChC,GAAIC,OAAQJ,EAAE,OAEd,IAAwC,MAArCG,6BAA6BE,MAAsD,GAAtCF,6BAA6BG,MAAe,CAC1FN,EAAE,yBAAyBnB,OAAO,SAAS,QAASsB,6BAA6BE,KAAKE,UAAUC,kBAAoB,KAAQL,6BAA6BE,KAAKE,UAAUE,iCAGxKL,MAAMM,KAAK,qBAAqBC,KAAKR,6BAA6BE,KAAKE,UAAUK,wBAEjF,IAAIC,OAAQT,MAAMM,KAAK,wBACnBI,UAAYV,MAAMM,KAAK,qBACvBK,UAAYX,MAAMM,KAAK,qBACvBM,iBAAmBZ,MAAMM,KAAK,gCAC9BO,iBAAmBb,MAAMM,KAAK,sBAElCV,GAAE,qBAAqBK,KAAK,WAAYF,6BAA6BE,KAAKE,UAAUW,2BAEhFf,6BAA6BE,KAAKc,SAAStB,OAAS,GACtDG,EAAEG,6BAA6BE,KAAKc,UAAUC,KAAK,SAASC,OAE1DR,MAAMS,OAAO,gBAAgBC,KAAKC,OAAO,qBAAqBD,KAAKE,KAAK,eAOxEtB,6BAA6BE,KAAKqB,SAAS7B,OAAS,GACtDG,EAAEG,6BAA6BE,KAAKqB,UAAUN,KAAK,SAASC,OAE1DP,UAAUQ,OAAO,gBAAgBC,KAAKC,OAAO,qBAAqBD,KAAKE,KAAK,eAO5EtB,6BAA6BE,KAAKE,UAAUoB,QAAQ9B,OAAS,GAC/DG,EAAEG,6BAA6BE,KAAKE,UAAUoB,SAASP,KAAK,SAASC,OAEnEN,UAAUO,OAAO,OAAOC,KAAK,UAOjC,IAAIK,UAAW,uBACXC,OAAS,aAETC,WAAaF,SAAW,4BAA8BzB,6BAA6BE,KAAKE,UAAUwB,gBAAkBF,MACpHC,aAAcF,SAAW,sBAAwBzB,6BAA6BE,KAAKE,UAAUyB,WAAaH,OAC1GC,YAAcF,SAAW,0BAA4BzB,6BAA6BE,KAAKE,UAAU0B,cAAgBJ,OACjHC,YAAcF,SAAW,gBAAkBzB,6BAA6BE,KAAKE,UAAU2B,KAAOL,OAC9FC,YAAcF,SAAW,qBAAuBzB,6BAA6BE,KAAKE,UAAU4B,UAAYN,OACxGC,YAAcF,SAAW,eAAiBzB,6BAA6BE,KAAKE,UAAU6B,IAAMP,OAEhGb,iBAAiBM,OAAOQ,YAEpB3B,6BAA6BE,KAAKgC,cAAcxC,OAAS,GAC3DG,EAAEG,6BAA6BE,KAAKgC,eAAejB,KAAK,SAASC,OAE/DJ,iBAAiBK,OAAO,OAAOC,KAAK,WAOxCvB,EAAE,yBAAyBnB,OAAO,SAhFtC,GAAIyD,YAAa,cA0FjB,SAAUtC,GACR,GAAII,OAAQJ,EAAE,QAGVuC,gBAFWvC,EAAE,YAAYwC,OAER,GACjBC,gBAAkB,EAClBC,UAAY1C,EAAE,4BACd2C,UAAY3C,EAAE,+BAOK,KAAnBuC,gBAA4C,IAApBE,iBAC1BC,UAAUE,YAAY,UAAU,GAChCD,UAAUC,YAAY,UAAU,KAGhCF,UAAUE,YAAY,UAAU,GAChCD,UAAUC,YAAY,UAAU,IASlC5C,EAAE,yBACC6C,KAAKC,OAAOC,SAASC,eAAeC,OACpCpE,QACCqE,MAAO,UACPD,OAAO,EACPE,MAAO,OACPrE,UAAYC,GAAM,WAAYC,GAAM,YACpCoE,YAAa,uBACbC,WAAW,EACXC,UAAU,EACVC,OAAQ,SAASC,MAAOC,MAGxBC,MAAO,SAASF,MAAOC,IACrB3D,iBAMNM,MAAMuD,GAAG,QAAS,uBAAwB,SAASC,IAEjD,GAAIC,uBAAwB7D,EAAE,qBAAqB8D,WAEnD9D,GAAE+D,MACAC,IAAK,iCACLC,OAAQ,OACR5D,KAAMwD,sBACNK,YAAa5F,qBAAqB0B,EAAE,mCAAoCA,EAAE,kCAC1EmE,SAAU7F,qBAAqB0B,EAAE,mCAAoCA,EAAE,oCACvEoE,QAASlE,0BAKX,IAAImE,mBAAoBjE,MAAMM,KAAK,oBAAoBT,KACnDG,OAAMM,KAAK,mBAAmBb,OAAS,IACzCO,MAAMM,KAAK,mBAAmB4D,SAC9BlE,MAAMM,KAAK,oBAAoB6D,WAAW,oBAO5C,IAAIC,oBAAoB,CACxB,IAAKA,kBASA,CACOxE,EAAE,uBAAuByE,KACjCC,UAAW,KACXC,UAAW,wBACXC,UAAa,SAASC,EAAGC,QAASC,SAAUC,QAC1C,MAAOD,UAAS,GAAGE,QAAQC,gBAM/BvG,mBApBsB,CACtB2B,OAAQ,CACR,IAAI6E,eAAgB,yEAA2Ed,kBAAoB,0CACnHrE,GAAEmF,eAAeC,aAAa,0BAC9BhF,MAAMM,KAAK,oBAAoB2E,KAAK,mBAAoB,qBAyB5DrF,EAAE,yBAAyB2D,GAAG,cAAe,WAC3C,GAAI2B,mBAAoBtF,EAAE,mCACtBuF,cAAgBvF,EAAE,gCAEtB1B,sBAAqBgH,kBAAmBC,eACxC5G,iBAGDC","file":"chemical_rules.js","sourcesContent":["function showElementOutOfMany($wrapper_to_show, $common_selector) {\n  $common_selector.hide();\n  $wrapper_to_show.show();\n  resizeModal()\n}\n\nfunction resizeModal() {\n  jQuery('#chemical-rules-modal').dialog({\n    position: { 'my': 'center', 'at': 'center' }\n  });\n  if(jQuery('.chemical-rules-modal').css('top').replace('px', '') < 1){\n    jQuery('.chemical-rules-modal').css('top', 0)\n  }\n}\n\nfunction checkValues(previous, current, cIndex, keys) {\n  var previousKeys = [];\n  if(typeof previous[keys[cIndex]] == 'object'){\n    previousKeys = Object.keys(previous[keys[cIndex]])\n  }\n\n  if ((previousKeys.indexOf('Value') > -1 && previous[keys[cIndex]].Value == \"\")) {\n    delete previous[keys[cIndex]];\n  }\n  else if (['object'].indexOf(typeof previous[keys[cIndex]]) > -1) {\n    previous[keys[cIndex]] = previousKeys.reduce(checkValues, previous[keys[cIndex]])\n    if (Object.keys(previous[keys[cIndex]]).length == 0) {\n      delete previous[keys[cIndex]];\n    }\n  }\n  return previous\n}\n\nvar sampleData = function() {};\n\n/**\n * Clear form inputs and hide warning messages\n */\nfunction resetCRForm() {\n  var $form = $('#cr-search');\n  //$form.find('input[type=text]').val('');\n  $form.val('');\n}\n\nfunction populate_substance_modal(chemical_rules_response_json) {\n  var $body = $('body');\n\n  if(chemical_rules_response_json.data != null && chemical_rules_response_json.error == false){\n    $('#chemical-rules-modal').dialog('option','title', chemical_rules_response_json.data.Substance.CASRegistryNumber + ': ' +  chemical_rules_response_json.data.Substance.ChemicalSubstanceSystematicName);\n    \n    // popluate our modal\n    $body.find('.cr-chemical-name').text(chemical_rules_response_json.data.Substance.EPAChemicalRegistryName);\n\n    var $list = $body.find('.cr-rules-regs_lists');\n    var $programs = $body.find('#cr-programs-list');\n    var $synonyms = $body.find('#cr-synonyms-list');\n    var $propertiestable = $body.find('#cr-properties-table > tbody');\n    var $substance_lists = $body.find('#cr-substances-list');\n    \n    $('#cr-save-chemical').data('cr-srsid', chemical_rules_response_json.data.Substance.EPAChemicalInternalNumber);\n    \n    if (chemical_rules_response_json.data.LawsRegs.length > 0) {\n      $(chemical_rules_response_json.data.LawsRegs).each(function(index){\n        //$('#cr-laws-regs_count').text(chemical_rules_response_json.data.LawsRegs.length);\n        $list.append('<li><a href=\"'+this.source+'\" target=\"_blank\">'+this.name+'</a></li>');\n      });\n    }\n    else {\n      // No laws regulations found\n    }\n    \n    if (chemical_rules_response_json.data.Programs.length > 0) {\n      $(chemical_rules_response_json.data.Programs).each(function(index){\n        //$('#cr-programs-count').text(chemical_rules_response_json.data.Programs.length);        \n        $programs.append('<li><a href=\"'+this.source+'\" target=\"_blank\">'+this.name+'</a></li>');\n      });\n    }\n    else {\n      // No programs found   \n    }\n    \n    if (chemical_rules_response_json.data.Substance.Synonym.length > 0) {\n      $(chemical_rules_response_json.data.Substance.Synonym).each(function(index) {\n        //$('#cr-synonyms-count').text(chemical_rules_response_json.data.Substance.Synonym.length);\n        $synonyms.append('<li>'+this+'</li>');\n      });\n    }\n    else {\n      // No synonyms found\n    }\n    \n    var tr_start = '<tr><th scope=\"row\">',\n        tr_end = '</td></tr>';\n\n    var properties = tr_start + \"Molecular Weight</th><td>\" + chemical_rules_response_json.data.Substance.MolecularWeight + tr_end;\n        properties += tr_start + \"Solubility</th><td>\" + chemical_rules_response_json.data.Substance.Solubility + tr_end;\n        properties += tr_start + \"Vapor Pressure</th><td>\" + chemical_rules_response_json.data.Substance.VaporPressure + tr_end;\n        properties += tr_start + \"LogP</th><td>\" + chemical_rules_response_json.data.Substance.LogP + tr_end;\n        properties += tr_start + \"Stability</th><td>\" + chemical_rules_response_json.data.Substance.Stability + tr_end;\n        properties += tr_start + \"pKA</th><td>\" + chemical_rules_response_json.data.Substance.pKA + tr_end;\n             \n    $propertiestable.append(properties);\n    \n    if (chemical_rules_response_json.data.SubstanceList.length > 0) {\n      $(chemical_rules_response_json.data.SubstanceList).each(function(index) {\n        //$('#cr-synonyms-count').text(chemical_rules_response_json.data.Substance.Synonym.length);\n        $substance_lists.append('<li>'+this+'</li>');\n      });\n    }\n    else {\n      // No synonyms found\n    }\n    \n    $('#chemical-rules-modal').dialog(\"open\")\n  }\n  else {\n    //@todo Add error msg for then there is bad data\n  }\n\n\n\n}\n\n(function($) {\n  var $body = $('body'),\n      $cr_tabs = $('#cr-tabs').tabs(),\n      sampleSetIndex = 0,\n      num_chem_faves = 0,\n      num_rules_faves = 0,\n      $cr_empty = $('.cr-tabs_favorites_empty'),\n      $cr_avail = $('.cr-tabs_favorites_available');\n  \n  //@TODO Add logic to count number of Chemical Favorites and Law / Rule Favorites\n  //num_chem_faves = ...;\n  //num_rules_faves = ...;\n  \n  // If no favorites exist, show Search tab\n  if (num_chem_faves === 0 && num_rules_faves === 0) {\n    $cr_empty.toggleClass('hidden', false);\n    $cr_avail.toggleClass('hidden', true);\n  }\n  else {\n    $cr_empty.toggleClass('hidden', false);\n    $cr_avail.toggleClass('hidden', true);\n    //@TODO Print Favorite Chemicals\n    //\n    //@TODO Print Favorite Laws/Regs    \n    //count\n    //ul\n  }\n\n  // Initialize and open dialog\n  $('#chemical-rules-modal')\n    .html(Drupal.settings.chemical_rules.modal)\n    .dialog({\n      title: 'Results',\n      modal: true,\n      width: \"auto\",\n      position: { 'my': 'left top', 'at': 'left top' },\n      dialogClass: 'chemical-rules-modal',\n      draggable: false,\n      autoOpen: false,\n      create: function(event, ui) {\n\n      },\n      close: function(event, ui) {\n        resetCRForm();\n        //$('#chemical-rules-loading-wrapper').hide();\n        //$(this).dialog('destroy');\n      }\n    });\n\n  $body.on('click', '#cr-search-chems-btn', function(ev) {\n\n    var chem_search_form_data = $('#chem_search_form').serialize();\n\n    $.ajax({\n      url: 'chemical_rules/form_submission',\n      method: 'POST',\n      data: chem_search_form_data,\n      before_send: showElementOutOfMany($('#chemical-rules-loading-wrapper'), $('.chemical-rules-modal-wrapper')),\n      complete: showElementOutOfMany($('#chemical-rules-results-wrapper'), $('#chemical-rules-loading-wrapper')),\n      success: populate_substance_modal\n    })\n\n    //ev.preventDefault();\n    //ev.stopPropagation();\n    var chemicalNameOrNum = $body.find('#cr-search_input').val();\n    if ($body.find('#chemical-error').length > 0) {\n      $body.find('#chemical-error').remove();\n      $body.find('#cr-search_input').removeAttr('aria-describedby');\n    }\n  \n    //@TODO - Samuel's logic to handle chemical regex and lookup\n    \n    //////\n    \n    var is_valid_chemical = true;\n    if (!is_valid_chemical) {\n      error = true;\n      var error_message = '<p class=\"has-error\" id=\"chemical-error\">No results were found for <b>' + chemicalNameOrNum + '</b>.  Please try another variation.</p>';\n      $(error_message).insertBefore('#cr-search_description');\n      $body.find('#cr-search_input').attr('aria-describedby', 'chemical-error');\n    }  \n    \n    // Simulate the loading results block switching to results block\n    // @TODO - Change this once Ajax / JSON success call returned - \n    else {\n      var toc = $(\"#cr-modal-toc-icons\").toc({ \n        selectors: \"h2\",\n        container: \"#chemical-rules-modal\",\n        'itemClass': function(i, heading, $heading, prefix) { // custom function for item class\n          return $heading[0].tagName.toLowerCase();\n        } \n      });\n      // POST input field value to lookup service\n      // Render out \n\n      resizeModal();\n    }\n  });    \n\n  /**\n   * Close Listener on Chemical Rules Modal\n   * -  Remove Previous Results ?\n   * -  Cancel Pending Form submission\n   */\n  $('#chemical-rules-modal').on('dialogclose', function() {\n    var $chemical_loading = $('#chemical-rules-loading-wrapper');\n    var $all_wrappers = $('.chemical-rules-modal-wrapper');\n\n    showElementOutOfMany($chemical_loading, $all_wrappers);\n    resizeModal();\n  });\n\n})(jQuery);\n"]}