{"version":3,"sources":["to_do.js"],"names":["$","clearDTSearches","dtTable","search","columns","draw","openDetailsDialog","$anchor_elem","title","data","status_note","due_date","$modal_content","html","Drupal","settings","toDoStatusModal","find","dialog","dialogClass","width","height","autoOpen","modal","$table_wrapper","fn","dataTableExt","oStdClasses","sPageButton","sTable","dataTable","ext","errMode","helpPage","message","console","log","oApi","fnPagingInfo","oSettings","iStart","_iDisplayStart","iEnd","fnDisplayEnd","iLength","_iDisplayLength","iTotal","fnRecordsTotal","iFilteredTotal","fnRecordsDisplay","iPage","Math","ceil","iTotalPages","datatable_options","ajax","basePath","dom","order","bLengthChange","iDisplayLength","processing","language","columnDefs","targets","visible","className","searchable","orderable","autoWidth","pagingType","fnRowCallback","nRow","aData","iDisplayIndex","iDisplayIndexFull","attr","fnDrawCallback","pageInfo","this","pageNo","totalPages","$current_li","class","after","fnInitComplete","yadcf","init","DataTable","column_number","filter_match_mode","filter_reset_button_text","filter_container_id","filter_default_label","cumulative_filtering","show","iterator","ctx","idx","column","header","append","on","nodes","each","cell","i","innerHTML","selected_part_code","val","toLowerCase","$subpart_code_select","$report_type_select","prop","trigger","hide","selected_subpart_code","click","$to_do","text","url","load","hasClass","search_criteria","removeClass","addClass","jQuery"],"mappings":"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","file":"to_do.js","sourcesContent":["(function($) {\n\n  function clearDTSearches(dtTable) {\n    dtTable.search( '' )\n      .columns().search( '' )\n      .draw();\n  }\n\n  function openDetailsDialog($anchor_elem) {\n\n    var title = $anchor_elem.data('title');\n\n\n    var status_note = $anchor_elem.data('statusNote');\n    var due_date = $anchor_elem.data('dueDate');\n    var modal_title = \"Details for \" + title;\n\n    var modal_html = \"\"\n    var $modal_content = $('#to-do-modal-content').html(Drupal.settings.toDoStatusModal);\n\n    $modal_content.find('.td-title').html(title);\n    $modal_content.find('.td-status-note').html(status_note);\n    $modal_content.find('.td-due-date').html(due_date);\n    $modal_content.dialog({\n      dialogClass: 'to-do-modal-content',\n      title: 'Details for ' + title,\n      width: \"auto\",\n      height: \"auto\",\n      autoOpen: true,\n      modal: true      \n    });\n  }\n\n\n  var $table_wrapper = $('#to-do').find('table');\n  $.fn.dataTableExt.oStdClasses.sPageButton = \"favorites-ignore fa\";\n  $.fn.dataTableExt.oStdClasses.sTable = \"eportal-responsive-table\";\n\n  // If the datatables loading has an error gracefully handle with a message\n  $.fn.dataTable.ext.errMode = function(settings, helpPage, message) {\n    $('#progress-tracker').find('.dataTables_empty').html(\"Unable to connect to service.\");\n    console.log(message);\n  };\n  $.fn.dataTableExt.oApi.fnPagingInfo = function(oSettings) {\n    return {\n      \"iStart\": oSettings._iDisplayStart,\n      \"iEnd\": oSettings.fnDisplayEnd(),\n      \"iLength\": oSettings._iDisplayLength,\n      \"iTotal\": oSettings.fnRecordsTotal(),\n      \"iFilteredTotal\": oSettings.fnRecordsDisplay(),\n      \"iPage\": oSettings._iDisplayLength === -1 ?\n        0 : Math.ceil(oSettings._iDisplayStart / oSettings._iDisplayLength),\n      \"iTotalPages\": oSettings._iDisplayLength === -1 ?\n        0 : Math.ceil(oSettings.fnRecordsDisplay() / oSettings._iDisplayLength) - 1\n    };\n  };\n  var datatable_options = {\n    \"ajax\": Drupal.settings.basePath + 'to_do/load_data',\n    \"dom\": 'trp',\n    \"order\": [[3, \"asc\"]],\n    \"bLengthChange\": false,\n    \"iDisplayLength\": 3,\n    \"processing\": true,\n    \"language\": {\n      \"processing\": \"\"\n    },\n    \"columnDefs\": [\n      // Hide last 4 rows (timestamp, part code, sub part code, and report type)\n      {\"targets\": [-1, -2, -3, -4], \"visible\": false},\n      {\"targets\": [2], className: \"text-left\"},\n      {\"targets\": [1], \"width\": \"300px\", className: \"small-screen-td-header text-left\"},\n      {\n        \"targets\": [0],\n        className: \"skinny-col hidden-for-small-screen vertical-top\",\n        \"searchable\": false,\n        \"orderable\": false\n      }\n    ],\n    \"autoWidth\": false,\n    \"pagingType\": \"simple\",\n    \"fnRowCallback\": function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {\n      // Add data-titles for each column\n      $('td:eq(2)', nRow).attr('data-title', \"Domain\");\n      $('td:eq(3)', nRow).attr('data-title', \"Due\");\n\n\n    },\n    \"fnDrawCallback\": function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {\n      var pageInfo = this.fnPagingInfo();\n      var pageNo = pageInfo.iPage + 1;\n      var totalPages = pageInfo.iTotalPages + 1;\n\n      if (totalPages > 1) {\n        var $current_li = $('<li />', {\n          class: 'pager-current'\n        }).html(pageNo + ' of ' + totalPages);\n        $('#to-do').find('.dataTables_paginate li:first').after($current_li);\n      }\n\n    },\n    fnInitComplete: function() {\n      //Initialize YADCF\n      // Overriding datatable class to allow Eportal's custom datatable styling\n      yadcf.init($table_wrapper.DataTable(), [\n          {\n            column_number: 4,\n            filter_match_mode: 'contains',\n            filter_reset_button_text: false,\n            filter_container_id: \"to-do-yadcf-filter-part-code\",\n            filter_default_label: \"- Any -\"\n          },\n        {\n          column_number: 5,\n          filter_match_mode: 'contains',\n          filter_reset_button_text: false,\n          filter_container_id: \"to-do-yadcf-filter-subpart-code\",\n          filter_default_label: \"- Any -\"\n        },\n        {\n          column_number: 6,\n          filter_match_mode: 'contains',\n          filter_reset_button_text: false,\n          filter_container_id: \"to-do-yadcf-filter-report-type\",\n          filter_default_label: \"- Any -\"\n        },\n        ],\n        {\n          cumulative_filtering: true\n        }\n      );\n\n      $('#yadcf-filter-domain').show();\n    }\n  };\n\n  // Create index column that updates on sorting\n  var dtTable = $table_wrapper.DataTable(datatable_options);\n  dtTable.columns().iterator('column', function (ctx, idx) {\n    $(dtTable.column(idx).header()).append('<span class=\"sort-icon\" />');\n  });\n\n  dtTable.on('search.dt', function() {\n    dtTable.column(0, {order: 'applied'}).nodes().each(function(cell, i) {\n      cell.innerHTML = i + 1;\n    });\n  });\n\n  $('#to-do').on('click', '.td-status', function() {\n    openDetailsDialog($(this));\n  });\n\n\n  $('#to-do-yadcf-filter-part-code').on('change', 'select', function() {\n    var selected_part_code = $(this).val().toLowerCase();\n    var $subpart_code_select = $('#to-do-yadcf-filter-subpart-code');\n    var $report_type_select = $('#to-do-yadcf-filter-report-type');\n\n    $subpart_code_select.find('option[value=\"-1\"]').prop('selected', 'selected').trigger('change');\n    $report_type_select.find('option[value=\"-1\"]').prop('selected', 'selected').trigger('change');\n    $report_type_select.hide();\n\n    if (selected_part_code === \"-1\") {\n      $subpart_code_select.hide();\n    } else {\n      $subpart_code_select.show();\n    }\n\n  });\n\n  $('#to-do-yadcf-filter-subpart-code').on('change', 'select', function() {\n    var selected_subpart_code = $(this).val().toLowerCase();\n    var $report_type_select = $('#to-do-yadcf-filter-report-type');\n    $report_type_select.find('option[value=\"-1\"]').prop('selected', 'selected').trigger('change');\n    if (selected_subpart_code === \"-1\") {\n      $report_type_select.hide();\n    } else {\n      $report_type_select.show();\n    }\n  });\n\n\n    $('#refresh-to-do').click(function() {\n    var $to_do = $('#to-do');\n    // Reload datatable, forcing reload of data not using cache\n    $table_wrapper.find('td').hide();\n    $to_do.find('.dataTables_processing').text(\"Loading...\");\n    //Remove data, pass false to not use cache\n    dtTable.ajax.url(Drupal.settings.basePath + 'to_do/load_data/false').load(function() {\n      // Show table after successfully refreshing\n      $table_wrapper.find('td').show();\n      $to_do.find('.dataTables_processing').text(\"\");\n    });\n\n  });\n\n  // Filter results based on \"\" (blank for all, is default), next_week, this_week, and beyond\n  $('.todo_filter_button').click(function() {\n    if (!$(this).hasClass('filter-applied')) {\n      clearDTSearches(dtTable);\n      var search_criteria = $(this).data('search');\n      // Column 7 contains time frame information\n      dtTable.search('')\n        .columns(7).search(search_criteria)\n        .draw();\n      $('.todo_filter_button').removeClass('filter-applied');\n      $(this).addClass('filter-applied');\n    }\n  });\n\n\n})(jQuery);\n"]}