function showElementOutOfMany($wrapper_to_show,$common_selector){$common_selector.hide(),$wrapper_to_show.show(),resizeModal()}function resizeModal(){jQuery("#be-well-informed-modal").dialog({position:{my:"center",at:"center"}}),jQuery(".be-well-informed-modal").css("top").replace("px","")<1&&jQuery(".be-well-informed-modal").css("top",0)}function checkValues(previous,current,cIndex,keys){var previousKeys=[];return"object"==typeof previous[keys[cIndex]]&&(previousKeys=Object.keys(previous[keys[cIndex]])),previousKeys.indexOf("Value")>-1&&""==previous[keys[cIndex]].Value?delete previous[keys[cIndex]]:["object"].indexOf(typeof previous[keys[cIndex]])>-1&&(previous[keys[cIndex]]=previousKeys.reduce(checkValues,previous[keys[cIndex]]),0==Object.keys(previous[keys[cIndex]]).length&&delete previous[keys[cIndex]]),previous}function resetBWIForm(){var $form=$("#water_analysis_results_form");$form.parsley().reset(),$form.find("input[type=number]").val(""),$form.find("input[type=radio]").prop("checked",!1),$form.find("select option").prop("selected",!1),$(".bs-callout-info").toggleClass("hidden",!0),$(".bs-callout-warning").toggleClass("hidden",!0)}jQuery.fn.serializeObject=function(){var o={},a=this.serializeArray();return jQuery.each(a,function(){objRoot=this.name.replace(/]/g,"").split(/\[/g).reduce(function(previous,current,cIndex,original){var newObject={},property=original[original.length-1-cIndex];return newObject[property]=previous,newObject},this.value),jQuery.extend(!0,o,objRoot)}),o},toggleSection=function(){var $this=$(this);$(this).find("i");$this.toggleClass("open close"),resizeModal()};var sampleData=function(){};!function($){var sampleSetIndex=0;sampleData=function(sample){sample||(sampleSet=[{CityName:"Anonymous",RoutineContaminants:{As:{Symbol:"As",Name:"Arsenic",Value:"1",Unit:"mg/L"}}},{CityName:"Anonymous",BacterialContaminants:{Bac:{Symbol:"Bac",Name:"Total Coliform",Value:"1",Unit:"CFU/100 mL"}}},{CityName:"Anonymous",Bac_G:"rdb_Bac_True"},{CityName:"Anonymous",BacterialContaminants:{Ecoli:{Symbol:"Ecoli",Name:"E. Coli",Value:"0",Unit:"CFU/100 mL"}}},{CityName:"Anonymous",RoutineContaminants:{Cl:{Symbol:"Cl",Name:"Chloride",Value:"250",Unit:"mg/L"}}},{CityName:"Anonymous",RoutineContaminants:{Har:{Symbol:"Har",Name:"Hardness as CaCO3",Value:"150",Unit:"mg/L"}}},{CityName:"Anonymous",RoutineContaminants:{Fe:{Symbol:"Fe",Name:"Iron",Value:".3",Unit:"mg/L"}}},{CityName:"Anonymous",RoutineContaminants:{Mn:{Symbol:"Mn",Name:"Manganese",Value:".05",Unit:"mg/L"}}},{CityName:"Anonymous",RoutineContaminants:{pH:{Symbol:"pH",Name:"pH",Value:"8",Unit:"units"}}},{CityName:"Anonymous",RadionuclideContaminants:{AGA:{Symbol:"AGA",Name:"Gross Alpha",Value:"15",Unit:"pCi/L"}}},{CityName:"Anonymous",RoutineContaminants:{As:{Symbol:"As",Name:"Arsenic",Value:"1234",Unit:"mg/L"},Cl:{Symbol:"Cl",Name:"Chloride",Value:"1234",Unit:"mg/L"},Cu:{Symbol:"Cu",Name:"Copper",Value:"1234",Unit:"mg/L"},CuSt:{Symbol:"CuSt",Name:"Copper, Stagnant",Value:"1234",Unit:"mg/L"},Fl:{Symbol:"Fl",Name:"Fluoride",Value:"1234",Unit:"mg/L"},Har:{Symbol:"Har",Name:"Hardness as CaCO3",Value:"1234",Unit:"mg/L"},Fe:{Symbol:"Fe",Name:"Iron",Value:"1234",Unit:"mg/L"},Pb:{Symbol:"Pb",Name:"Lead",Value:"1234",Unit:"mg/L"},PbSt:{Symbol:"PbSt",Name:"Lead, Stagnant",Value:"1234",Unit:"mg/L"},Mn:{Symbol:"Mn",Name:"Manganese",Value:"1234",Unit:"mg/L"},NO3:{Symbol:"NO3",Name:"Nitrate-N",Value:"1234",Unit:"mg/L"},NO2:{Symbol:"NO2",Name:"Nitrite-N",Value:"1234",Unit:"mg/L"},pH:{Symbol:"pH",Name:"pH",Value:"6.1",Unit:"units"},Na:{Symbol:"Na",Name:"Sodium",Value:"1234",Unit:"mg/L"}},BacterialContaminants:{Bac:{Symbol:"Bac",Name:"Total Coliform",Value:"1234",Unit:"CFU/100 mL"},Ecoli:{Symbol:"Ecoli",Name:"E. Coli",Value:"1234",Unit:"CFU/100 mL"}},Bac_G:"rdb_Bac_True",Ecoli_G:"rdb_Ecoli_True",RadionuclideContaminants:{Rn:{Symbol:"Rn",Name:"Radon",Value:"4321",Unit:"pCi/L"},Ur:{Symbol:"Ur",Name:"Uranium",Value:"4321",Unit:"Î¼g/L"},AGA:{Symbol:"AGA",Name:"Gross Alpha",Value:"4321",Unit:"pCi/L"}},InteractivePromptResponses:{0:{InteractionIdentifier:"Cl_True",Symbol:"Cl"},1:{InteractionIdentifier:"Har_True",Symbol:"Har"}}}],sample=sampleSet[sampleSetIndex],sampleSetIndex=++sampleSetIndex%sampleSet.length),resetBWIForm();for(var cat in sample)if("object"==typeof sample[cat]){for(var field in sample[cat])if("object"==typeof sample[cat][field])for(var prop in sample[cat][field]){var selector='[name="'+cat+"["+field+"]["+prop+']"]';$(selector).val(sample[cat][field][prop])}}else{var selector='[name="'+cat+'"]';$(selector+'[type=radio][value="'+sample[cat]+'"]').prop("checked",!0),$("select"+selector).val(sample[cat])}},Parsley.addValidator("checkChildren",{messages:{en:"You must correctly give value or choose a whether the microbe was present!"},requirementType:"integer",validate:function(_value,requirement,instance){for(var i=1;i<=requirement;i++)if(1==i&&instance.$element.find("input").val()||2==i&&instance.$element.find("[type=radio]:checked").length)return!0;return!1}}),$("#be-well-informed-modal").html(Drupal.settings.be_well_informed.modal).dialog({modal:!0,width:"auto",title:"Be Well Informed &mdash Water Analysis Tool",position:{my:"center",at:"center"},dialogClass:"be-well-informed-modal",autoOpen:!1,draggable:!1,create:function(event,ui){$("#bwi-tabs").tabs();var $form=$("#water_analysis_results_form");$form.parsley({inputs:Parsley.options.inputs+",[data-parsley-check-children]"}).on("field:validated",function(){var ok=0===$(".parsley-error").length;$(".bs-callout-info").toggleClass("hidden",!ok),$(".bs-callout-warning").toggleClass("hidden",ok)}).on("form:submit",function(){return!1}),$("#water_analysis_reset").click(function(){resetBWIForm(),resizeModal()}),$(window).resize(function(){resizeModal()})},close:function(event,ui){sampleSetIndex=0,$("#be-well-informed-results-table, #be-well-informed-result-details-table").dataTable({bDestroy:!0}).fnDestroy(),$("#be-well-informed-results-table, #be-well-informed-result-details-table, #be-well-informed-results-table_wrapper, #be-well-informed-result-details-table_wrapper").remove(),$("#routine-contaminants, .or").removeClass("hide"),$("#interactive-prompts").html(""),$("#interactive-prompts, #additional-contaminant-requests, .interactive-prompt, .additional-contaminant-requests").addClass("hide"),$("treatment-header, .treatment-content, .treatment-step, .box-main, .instruction-icon, .caret").addClass("hide"),showElementOutOfMany($("#be-well-informed-form-wrapper"),$(".be-well-informed-modal-wrapper"))}}),$("#bwi-check-water-btn").click(function(){$("#be-well-informed-modal").dialog("open"),resizeModal()}),$("#be-well-informed-modal").on("click","#water_analysis_submit",function(){var $form=$("#water_analysis_results_form");if(!$form.parsley().validate())return!1;var $loading_wrapper=$("#be-well-informed-loading-wrapper"),$results_wrapper=$("#be-well-informed-results-wrapper"),$form_wrapper=$("#be-well-informed-form-wrapper"),$all_wrappers=$(".be-well-informed-modal-wrapper"),formData=$form.serializeObject(),data=Object.keys(formData).reduce(checkValues,formData);showElementOutOfMany($loading_wrapper,$all_wrappers),$("#entry-tab").text("Entry"),$.ajax({url:"be_well_informed/form_submission",method:"POST",data:data,success:function(be_well_response_json){if(be_well_response_json.error)showElementOutOfMany($results_wrapper,$all_wrappers),$("#entry-tab").text("Results");else if($("#routine-contaminants, .or").removeClass("hide"),$("#interactive-prompts, #additional-contaminant-requests, .interactive-prompt, .additional-contaminant-requests").addClass("hide"),$("treatment-header, .treatment-content, .treatment-step, .box-main, .instruction-icon, .caret, .system-type-house, .system-type-water").addClass("hide"),$("#water_analysis_reset").addClass("invisible"),$(".bs-callout-info, .bs-callout-warning").toggleClass("hidden",!0),be_well_response_json.data.InteractivePrompts.length||be_well_response_json.data.AdditionalContaminantRequests.length)$("#routine-contaminants").addClass("hide"),$interactive_prompts=$("#interactive-prompts"),be_well_response_json.data.InteractivePrompts.length&&(be_well_response_json.data.InteractivePrompts.map(function(item,index,prompts){var interaction_string=item.Interaction.replace(/"/g,""),$item=$('[data-interaction="'+interaction_string+'"]'),exists=!!$item.length;if(exists)$item.removeClass("hide");else{var $prompt=$('<div class="section row interactive-prompt"></div>').attr("data-interaction",interaction_string).appendTo($interactive_prompts),$inputs=($('<div class="column usa-width-one-half"><p class="interaction">'+interaction_string+"</p></div>").appendTo($prompt),$('<div class="column usa-width-one-half btn-group"><button for="" class="usa-button-outline" type="button"><input type="radio" value="true">Yes</button><button for="" class="usa-button-outline" type="button"><input type="radio" value="false">No</button></div>').appendTo($prompt).on("click","button",function(e){$inputs.find("button").not(e.currentTarget).removeClass("usa-button-primary").addClass("usa-button-outline"),$(e.currentTarget).addClass("usa-button-primary").removeClass("usa-button-outline")}));$inputs.find("input").attr("name","InteractivePromptResponses["+index+"][Interaction]");$('<input type="hidden">').attr("name","InteractivePromptResponses["+index+"][Symbol]").val(item.Symbol).prependTo($inputs),$('<input type="hidden">').attr("name","InteractivePromptResponses["+index+"][InteractionIdentifier]").val(item.InteractionIdentifier).prependTo($inputs)}}),$interactive_prompts.removeClass("hide")),be_well_response_json.data.AdditionalContaminantRequests.length&&(be_well_response_json.data.AdditionalContaminantRequests.map(function(item,index,prompts){var interaction_string=item.Interaction.replace(/"/g,""),$item=$('[data-interaction="'+interaction_string+'"]'),exists=!!$item.length;if(exists)$item.removeClass("hide");else{var $prompt=$('<div class="section row additional-contaminant-requests"></div>').attr("data-interaction",interaction_string).appendTo($interactive_prompts),$column=($('<div class="column usa-width-one-half"><p class="interaction">'+interaction_string+"</p></div>").appendTo($prompt),$('<div class="column usa-width-one-half"></div>').appendTo($prompt));$('<input class="one-third offset-one-third" type="number" required>').on("change",function(){$('[name="RoutineContaminants['+item.Symbol+'][Value]"]').val($(this).val())}).appendTo($column),$('<select class="one-third" ></select>').html($('[name="RoutineContaminants['+item.Symbol+'][Unit]"]').html()).on("change",function(){$('[name="RoutineContaminants['+item.Symbol+'][Unit]"]').val($(this).val())}).appendTo($column)}}),$interactive_prompts.removeClass("hide")),showElementOutOfMany($form_wrapper,$all_wrappers),$("#entry-tab").text("Entry");else if(be_well_response_json.data.ResultEvaluations){$("#interactive-prompts").html("");var default_datatable_result_details_options={dom:"t",bLengthChange:!1,bAutoWidth:!1,bSort:!1,columnDefs:[{className:"small-screen-td-header",targets:[0]}],createdRow:function(row,data,dataIndex){$(row).find("td:eq(0)").attr("data-title","Result"),$(row).find("td:eq(1)").attr("data-title","Element"),$(row).find("td:eq(2)").attr("data-title","Your Entry"),$(row).find("td:eq(3)").attr("data-title","Limit"),$(row).find("td:eq(4)").attr("data-title","About Your Well Water")},data:be_well_response_json.data.result_summary,paging:!1},default_datatable_result_summary_options={dom:"t",bLengthChange:!1,bAutoWidth:!1,bSort:!1,columnDefs:[{className:"small-screen-td-header",targets:[0]}],createdRow:function(row,data,dataIndex){$(row).find("td:eq(0)").attr("data-title","Result"),$(row).find("td:eq(1)").attr("data-title","Element"),$(row).find("td:eq(2)").attr("data-title","Your Entry"),$(row).find("td:eq(3)").attr("data-title","Limit"),$(row).find("td:eq(4)").attr("data-title","About Your Well Water")},data:be_well_response_json.data.result_summary,paging:!1};$table=$('<table id="be-well-informed-results-table" class="eportal-responsive-table usa-table-borderless"> <thead> <tr> <th>Result</th> <th>Element</th> <th>Your Entry</th> <th>Limit</th> <th>About Your Well Water</th> </tr> </thead> <tbody></tbody> </table>'),$table.appendTo(".be-well-informed-results").DataTable(default_datatable_result_summary_options),$table=$('<table id="be-well-informed-result-details-table" class="eportal-responsive-table usa-table-borderless"> <thead> <tr> <th>Result</th> <th>Element</th> <th>Your Entry</th> <th>Limit</th> <th>About Your Well Water</th> </tr> </thead> <tbody></tbody> </table>'),$table.appendTo(".be-well-informed-result-details").DataTable(default_datatable_result_details_options);var result,row_index=1,titles=["Interpretation of Results:","Health Concerns:","Treatment Options:"];if($.each(be_well_response_json.data.result_details,function(index,detail_obj){if(result=detail_obj.result,detail_obj.data_array.length>0)for(var i=0;i<detail_obj.data_array.length;i++)""!==detail_obj.data_array[i]&&($("#be-well-informed-result-details-table").find("tr:eq("+(row_index+index)+")").after('<tr><td class="bwi-detail-td '+result+'" colspan="5"><h4>'+titles[i]+"</h4>"+detail_obj.data_array[i]+"</td></tr>"),row_index++)}),be_well_response_json.data.TreatmentSteps&&Object.keys(be_well_response_json.data.TreatmentSteps).length>0){$(".treatment-header, .treatment-content").removeClass("hide");var contaminants=[],excluded=["Fe","NO2","Bac","Ecoli"];for(var contaminate in be_well_response_json.data.ResultEvaluations)excluded.indexOf(contaminate)==-1&&"font-red"==be_well_response_json.data.ResultEvaluations[contaminate].GuidelineColor&&contaminants.push(be_well_response_json.data.ResultEvaluations[contaminate].ContaminantFullName);if(contaminants.length>1){var last=contaminants.pop(),title=contaminants.join(", ");title+=" and "+last}else title=contaminants.pop();$(".treatment-text").html(title);var step_label=1,toShow=[];for(var step in be_well_response_json.data.TreatmentSteps){var $treatment=$(".treatment-step").eq(step);$treatment.removeClass("hide").find(".step span").html("Step "+step_label),be_well_response_json.data.TreatmentSteps[step].OrInstructions.map(function(item,index,list){$treatment.find('[title="'+item.Recommendation+'"]').removeClass("hide");var cssClass=".system-type-"+item.SystemType.toLowerCase();toShow.indexOf(cssClass)==-1&&toShow.push(cssClass)}),step_label++}$(toShow.join(", ")).removeClass("hide"),jQuery(".or + .box-main.hide").each(function(){var $this=jQuery(this);$this.prev().addClass("hide")}),$(".treatment-step:visible").eq(0).find(".caret").addClass("hide")}$(".contaminant-link").click(function(){var $this=$(this);$("[id="+$this.attr("data-contaminant")+"]",$(this).parents("td")).slideToggle()}),showElementOutOfMany($results_wrapper,$all_wrappers),$("#entry-tab").text("Results")}resizeModal()}})}),$("#be-well-informed-modal").on("dialogclose",function(){var $form_wrapper=$("#be-well-informed-form-wrapper"),$all_wrappers=$(".be-well-informed-modal-wrapper");$("#be-well-informed-results-table").DataTable().destroy(),$("#be-well-informed-result-details-table").DataTable().destroy(),$("#water_analysis_reset").removeClass("invisible"),showElementOutOfMany($form_wrapper,$all_wrappers),$("#entry-tab").text("Entry"),resizeModal()})}(jQuery);
//# sourceMappingURL=src/be_well_informed.js.map