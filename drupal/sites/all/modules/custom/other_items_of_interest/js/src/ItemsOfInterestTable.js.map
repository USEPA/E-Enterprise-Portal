{"version":3,"sources":["ItemsOfInterestTable.js"],"names":["ItemsOfInterestTable","$","fn","dataTableExt","oApi","fnPagingInfo","oSettings","iStart","_iDisplayStart","iEnd","fnDisplayEnd","iLength","_iDisplayLength","iTotal","fnRecordsTotal","iFilteredTotal","fnRecordsDisplay","iPage","Math","ceil","iTotalPages","$wrapper","ajax_url","location","oStdClasses","sPageButton","hide","datatable_options","bLengthChange","iDisplayLength","oLanguage","sSearch","pagingType","dom","fnDrawCallback","pageInfo","this","pageNo","totalPages","$current_li","class","html","find","after","cached","wrapper","indexOf","state_code","trim","split","hideTable","update_current_location","ajax_request","ajax","beforeSend","url","method","data","state","success","table","newId","each","max","parseInt","attr","substr","length","$table","dataTable","removeClass","addClass","showTable","show","jQuery"],"mappings":"AAAA,GAAIA,uBAEJ,SAAWC,GAGTA,EAAEC,GAAGC,aAAaC,KAAKC,aAAe,SAAUC,GAC9C,OACEC,OAAUD,EAAUE,eACpBC,KAAQH,EAAUI,eAClBC,QAAWL,EAAUM,gBACrBC,OAAUP,EAAUQ,iBACpBC,eAAkBT,EAAUU,mBAC5BC,MAASX,EAAUM,mBAAoB,EACrC,EAAIM,KAAKC,KAAKb,EAAUE,eAAiBF,EAAUM,iBACrDQ,YAAed,EAAUM,mBAAoB,EAC3C,EAAIM,KAAKC,KAAKb,EAAUU,mBAAqBV,EAAUM,mBAK7DZ,qBAAuB,SAAUqB,EAAUC,EAAUC,GACnDtB,EAAEC,GAAGC,aAAaqB,YAAYC,YAAc,sBAC5CJ,EAASK,MAET,IAAIC,IACFC,eAAiB,EACjBC,eAAkB,EAClBC,WACEC,QAAW,WAEbC,WAAc,SACdC,IAAO,OACPC,eAAkB,WAChB,GAAIC,GAAWC,KAAK/B,eAChBgC,EAASF,EAASlB,MAAQ,EAC1BqB,EAAaH,EAASf,YAAc,CAExC,IAAIkB,EAAa,EAAG,CAClB,GAAIC,GAActC,EAAE,UAClBuC,MAAO,kBAENC,KAAKJ,EAAS,OAASC,EAC1BjB,GAASqB,KAAK,iCAAiCC,MAAMJ,MAMvDK,GAAS,CACbR,MAAKS,QAAUxB,EACfe,KAAKd,SAAWA,EAEZC,EAEEA,EAASuB,QAAQ,QAAS,EAC5BV,KAAKW,WAAaxB,EAElBa,KAAKW,WAAa9C,EAAE+C,KAAKzB,EAAS0B,MAAM,KAAK,IAG/Cb,KAAKW,YAAa,EAIpBX,KAAKc,UAAY,WACf7B,EAASK,QAGXU,KAAKe,wBAA0B,SAAU5B,GAEnCA,EAASuB,QAAQ,QAAS,EAC5BV,KAAKW,WAAaxB,EAElBa,KAAKW,WAAa9C,EAAE+C,KAAKzB,EAAS0B,MAAM,KAAK,IAC/Cb,KAAKgB,gBAGPhB,KAAKgB,aAAe,WAClB,GAAIL,GAAaX,KAAKW,UACtB9C,GAAEoD,MACAC,WAAY,WACVjC,EAASoB,KAAK,2BAEhBc,IAAKjC,EACLkC,OAAQ,OACRC,MAAOC,MAAOX,GACdY,QAAS,SAAUC,GAOjB,GAAIC,GAAQ,CACZ5D,GAAE,2BAA2B6D,KAAK,WAChCD,EAAQ3C,KAAK6C,IAAIF,EAAOG,SAAS/D,EAAEmC,MAAM6B,KAAK,MAAMC,OAAO,aAAaC,QAAS,OAEnFN,GACA,IAAIO,GAASnE,EAAE,QAAU2D,EAAQ,SACjCQ,GAAO1B,KAAK,SAASuB,KAAK,KAAM,aAAeJ,GAC/CxC,EAASoB,KAAK2B,EAAO3B,QAErB2B,EAAS/C,EAASqB,KAAK,SACnB0B,EAAOD,OAAS,IAClBC,EAAOC,UAAU1C,GACjByC,EAAOE,YAAY,+BAA+BC,SAAS,sDAE7D3B,GAAS,MAKfR,KAAKoC,UAAY,WACX5B,EACFvB,EAASoD,QAGTrC,KAAKgB,eACL/B,EAASoD,WAMdC","file":"ItemsOfInterestTable.js","sourcesContent":["var ItemsOfInterestTable;\r\n\r\n(function ($) {\r\n\r\n\r\n  $.fn.dataTableExt.oApi.fnPagingInfo = function (oSettings) {\r\n    return {\r\n      \"iStart\": oSettings._iDisplayStart,\r\n      \"iEnd\": oSettings.fnDisplayEnd(),\r\n      \"iLength\": oSettings._iDisplayLength,\r\n      \"iTotal\": oSettings.fnRecordsTotal(),\r\n      \"iFilteredTotal\": oSettings.fnRecordsDisplay(),\r\n      \"iPage\": oSettings._iDisplayLength === -1 ?\r\n        0 : Math.ceil(oSettings._iDisplayStart / oSettings._iDisplayLength),\r\n      \"iTotalPages\": oSettings._iDisplayLength === -1 ?\r\n        0 : Math.ceil(oSettings.fnRecordsDisplay() / oSettings._iDisplayLength)\r\n    };\r\n  };\r\n\r\n\r\n  ItemsOfInterestTable = function ($wrapper, ajax_url, location) {\r\n    $.fn.dataTableExt.oStdClasses.sPageButton = \"favorites-ignore fa\";\r\n    $wrapper.hide();\r\n\r\n    var datatable_options = {\r\n      \"bLengthChange\": false,\r\n      \"iDisplayLength\": 3,\r\n      \"oLanguage\": {\r\n        \"sSearch\": \"Filter:\"\r\n      },\r\n      \"pagingType\": \"simple\",\r\n      \"dom\": 'iftp',\r\n      \"fnDrawCallback\": function () {\r\n        var pageInfo = this.fnPagingInfo();\r\n        var pageNo = pageInfo.iPage + 1;\r\n        var totalPages = pageInfo.iTotalPages + 1;\r\n\r\n        if (totalPages > 1) {\r\n          var $current_li = $('<li />', {\r\n            class: 'pager-current'\r\n          })\r\n            .html(pageNo + ' of ' + totalPages);\r\n          $wrapper.find('.dataTables_paginate li:first').after($current_li);\r\n        }\r\n      }\r\n    };\r\n\r\n\r\n    var cached = false;\r\n    this.wrapper = $wrapper;\r\n    this.ajax_url = ajax_url;\r\n\r\n    if (location) {\r\n      // find if in city, state code pattern\r\n      if (location.indexOf(',') === -1)\r\n        this.state_code = location;\r\n      else\r\n        this.state_code = $.trim(location.split(',')[1]);\r\n    }\r\n    else {\r\n      this.state_code = false;\r\n    }\r\n\r\n\r\n    this.hideTable = function () {\r\n      $wrapper.hide();\r\n    };\r\n\r\n    this.update_current_location = function (location) {\r\n      // find if in city, state code pattern\r\n      if (location.indexOf(',') === -1)\r\n        this.state_code = location;\r\n      else\r\n        this.state_code = $.trim(location.split(',')[1]);\r\n      this.ajax_request();\r\n    };\r\n\r\n    this.ajax_request = function () {\r\n      var state_code = this.state_code;\r\n      $.ajax({\r\n        beforeSend: function () {\r\n          $wrapper.html('<p>Loading&hellip;</p>');\r\n        },\r\n        url: ajax_url,\r\n        method: \"POST\",\r\n        data: {state: state_code},\r\n        success: function (table) {\r\n          /**\r\n           * TODO: refactor - duplicate code block in the following files:\r\n           * other_items_of_interest/js/other_items_of_interest.js\r\n           * recommended_resources/js/LocalResourceTable.js\r\n           */\r\n          // alter the datatable id, one digit larger than the largest id\r\n          var newId = 0;\r\n          $(\"table[id^='datatable-']\").each(function () {\r\n            newId = Math.max(newId, parseInt($(this).attr('id').substr('datatable-'.length), 10));\r\n          });\r\n          newId++;\r\n          var $table = $('<div>' + table + '</div>'); // wrap contents in a div for now, will unwrap later\r\n          $table.find('table').attr('id', 'datatable-' + newId);\r\n          $wrapper.html($table.html()); // unwrap\r\n\r\n          $table = $wrapper.find('table');\r\n          if ($table.length > 0) {\r\n            $table.dataTable(datatable_options);\r\n            $table.removeClass(\"dataTable display no-footer\").addClass('views-table responsive-table usa-table-borderless');\r\n          }\r\n          cached = true;\r\n        }\r\n      });\r\n    };\r\n\r\n    this.showTable = function () {\r\n      if (cached) {\r\n        $wrapper.show();\r\n      }\r\n      else {\r\n        this.ajax_request();\r\n        $wrapper.show();\r\n      }\r\n    }\r\n\r\n  };\r\n\r\n})(jQuery);"]}