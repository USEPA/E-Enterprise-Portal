{"version":3,"sources":["progress_tracker.js"],"names":["$","openDetailsDialog","$anchor_elem","title","data","status","text","status_note","$modal_content","html","Drupal","settings","progressTrackerStatusModal","find","dialog","dialogClass","width","height","autoOpen","modal","$table_wrapper","fn","dataTableExt","oStdClasses","sPageButton","sTable","dataTable","ext","errMode","helpPage","message","console","log","oApi","fnPagingInfo","oSettings","iStart","_iDisplayStart","iEnd","fnDisplayEnd","iLength","_iDisplayLength","iTotal","fnRecordsTotal","iFilteredTotal","fnRecordsDisplay","iPage","Math","ceil","iTotalPages","datatable_options","ajax","basePath","dom","order","bLengthChange","iDisplayLength","processing","language","columnDefs","targets","searchable","orderable","visible","className","autoWidth","pagingType","fnRowCallback","nRow","aData","iDisplayIndex","iDisplayIndexFull","attr","fnDrawCallback","pageInfo","this","pageNo","totalPages","$current_li","class","after","fnInitComplete","yadcf","init","DataTable","column_number","filter_match_mode","filter_reset_button_text","filter_container_id","filter_default_label","cumulative_filtering","show","$table","columns","iterator","ctx","idx","column","header","append","on","nodes","each","cell","i","innerHTML","selected_domain","val","toLowerCase","$part_code_select","$subpart_code_select","$report_type_select","hide","prop","trigger","selected_part_code","selected_subpart_code","click","$progress_tracker","url","load","jQuery"],"mappings":"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","file":"progress_tracker.js","sourcesContent":["(function($) {\n\n  function openDetailsDialog($anchor_elem) {\n\n    var title = $anchor_elem.data('title');\n    var status = $anchor_elem.text();\n\n\n    var status_note = $anchor_elem.data('statusNote');\n    var modal_title = \"Details for \" + title;\n\n    var modal_html = \"\";\n    var $modal_content = $('#progress-tracker-modal-content').html(Drupal.settings.progressTrackerStatusModal);\n\n    $modal_content.find('.pt-title').html(title);\n    $modal_content.find('.pt-status-note').html(status_note);\n    $modal_content.find('.pt-status').html(status);\n    $modal_content.dialog({\n      dialogClass: 'progress-tracker-modal-content',\n      title: 'Details for ' + title,\n      width: \"auto\",\n      height: \"auto\",\n      autoOpen: true,\n      modal: true\n    });\n  }\n\n  var $table_wrapper = $('#progress-tracker').find('table');\n  $.fn.dataTableExt.oStdClasses.sPageButton = \"favorites-ignore fa\";\n  $.fn.dataTableExt.oStdClasses.sTable = \"eportal-responsive-table\";\n\n  // If the datatables loading has an error gracefully handle with a message\n  $.fn.dataTable.ext.errMode = function(settings, helpPage, message) {\n    $('#progress-tracker').find('.dataTables_empty').html(\"Unable to connect to service.\");\n    console.log(message);\n  };\n  $.fn.dataTableExt.oApi.fnPagingInfo = function(oSettings) {\n    return {\n      \"iStart\": oSettings._iDisplayStart,\n      \"iEnd\": oSettings.fnDisplayEnd(),\n      \"iLength\": oSettings._iDisplayLength,\n      \"iTotal\": oSettings.fnRecordsTotal(),\n      \"iFilteredTotal\": oSettings.fnRecordsDisplay(),\n      \"iPage\": oSettings._iDisplayLength === -1 ?\n        0 : Math.ceil(oSettings._iDisplayStart / oSettings._iDisplayLength),\n      \"iTotalPages\": oSettings._iDisplayLength === -1 ?\n        0 : Math.ceil(oSettings.fnRecordsDisplay() / oSettings._iDisplayLength) - 1\n    };\n  };\n  var datatable_options = {\n    \"ajax\": Drupal.settings.basePath + 'progress_tracker/load_data',\n    \"dom\": 'trp',\n    \"order\": [[4, \"desc\"]],\n    \"bLengthChange\": false,\n    \"iDisplayLength\": 3,\n    \"processing\": true,\n    \"language\": {\n      \"processing\": \"\"\n    },\n    \"columnDefs\": [\n      {\"targets\": [0, 5], \"searchable\": false, \"orderable\": false},\n      // Hide last part code, and report type columns\n      {\"targets\": [-1, -2, -3], \"visible\": false},\n      {\"targets\": [2], className: \"text-left\"},\n      {\"targets\": [1], \"width\": \"150px\", className: \"small-screen-td-header text-left\"},\n      {\"targets\": [0], className: \"skinny-col hidden-for-small-screen\"}\n    ],\n    \"autoWidth\": false,\n    \"pagingType\": \"simple\",\n    \"fnRowCallback\": function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {\n      // Add data-titles for each column, Using Attribute to be picked up by CSS\n      $('td:eq(2)', nRow).attr('data-title', \"Domain\");\n      $('td:eq(3)', nRow).attr('data-title', \"Status\");\n      $('td:eq(4)', nRow).attr('data-title', \"Date\");\n      $('td:eq(5)', nRow).attr('data-title', \"Actions\");\n    },\n    \"fnDrawCallback\": function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {\n      var pageInfo = this.fnPagingInfo();\n      var pageNo = pageInfo.iPage + 1;\n      var totalPages = pageInfo.iTotalPages + 1;\n\n      if (totalPages > 1) {\n        var $current_li = $('<li />', {\n          class: 'pager-current'\n        }).html(pageNo + ' of ' + totalPages);\n        $('#progress-tracker').find('.dataTables_paginate li:first').after($current_li);\n      }\n\n    },\n    fnInitComplete: function() {\n      //Initialize YADCF\n      // Overriding datatable class to allow Eportal's custom datatable styling\n      yadcf.init($table_wrapper.DataTable(),\n        [\n          {\n            column_number: 2,\n            filter_match_mode: 'contains',\n            filter_reset_button_text: false,\n            filter_container_id: \"progress-tracker-yadcf-filter-domain\",\n            filter_default_label: \"- Any -\"\n          },\n          {\n            column_number: 6,\n            filter_match_mode: 'contains',\n            filter_reset_button_text: false,\n            filter_container_id: \"progress-tracker-yadcf-filter-part-code\",\n            filter_default_label: \"- Any -\"\n          },\n          {\n            column_number: 7,\n            filter_match_mode: 'contains',\n            filter_reset_button_text: false,\n            filter_container_id: \"progress-tracker-yadcf-filter-subpart-code\",\n            filter_default_label: \"- Any -\"\n          },\n          {\n            column_number: 8,\n            filter_match_mode: 'contains',\n            filter_reset_button_text: false,\n            filter_container_id: \"progress-tracker-yadcf-filter-report-type\",\n            filter_default_label: \"- Any -\"\n          }\n\n        ],\n        {\n          cumulative_filtering: true\n        }\n      );\n\n\n      $('#yadcf-filter-domain').show();\n    }\n  };\n\n  // Create index column that updates on sorting\n  var $table = $table_wrapper.DataTable(datatable_options);\n  $table.columns().iterator('column', function(ctx, idx) {\n    $($table.column(idx).header()).append('<span class=\"sort-icon\" />');\n  });\n\n  $table.on('search.dt', function() {\n    $table.column(0, {order: 'applied'}).nodes().each(function(cell, i) {\n      cell.innerHTML = i + 1;\n    });\n  });\n\n  $('#progress-tracker').on('click', '.pt-status', function() {\n    openDetailsDialog($(this));\n  });\n\n  $('#progress-tracker-yadcf-filter-domain').on('change', 'select', function() {\n    var selected_domain = $(this).val().toLowerCase();\n    var $part_code_select = $('#progress-tracker-yadcf-filter-part-code');\n    var $subpart_code_select = $('#progress-tracker-yadcf-filter-subpart-code');\n    var $report_type_select = $('#progress-tracker-yadcf-filter-report-type');\n    $part_code_select.hide().find('option[value=\"-1\"]').prop('selected', 'selected').trigger('change');\n    $report_type_select.hide().find('option[value=\"-1\"]').prop('selected', 'selected').trigger('change');\n    $subpart_code_select.hide().find('option[value=\"-1\"]').prop('selected', 'selected').trigger('change');\n    if (selected_domain === \"cedri\") {\n      $part_code_select.show();\n    } else if (selected_domain === \"lead\") {\n      $report_type_select.show();\n    }\n  });\n\n  $('#progress-tracker-yadcf-filter-part-code').on('change', 'select', function() {\n    var selected_part_code = $(this).val().toLowerCase();\n    var $subpart_code_select = $('#progress-tracker-yadcf-filter-subpart-code');\n    var $report_type_select = $('#progress-tracker-yadcf-filter-report-type');\n\n    $subpart_code_select.find('option[value=\"-1\"]').prop('selected', 'selected').trigger('change');\n    $report_type_select.find('option[value=\"-1\"]').prop('selected', 'selected').trigger('change');\n    $report_type_select.hide();\n\n    if (selected_part_code === \"-1\") {\n      $subpart_code_select.hide();\n    } else {\n      $subpart_code_select.show();\n    }\n\n  });\n\n  $('#progress-tracker-yadcf-filter-subpart-code').on('change', 'select', function() {\n    var selected_subpart_code = $(this).val().toLowerCase();\n    var $report_type_select = $('#progress-tracker-yadcf-filter-report-type');\n    $report_type_select.find('option[value=\"-1\"]').prop('selected', 'selected').trigger('change');\n\n    if (selected_subpart_code === \"-1\") {\n      $report_type_select.hide();\n    } else {\n      $report_type_select.show();\n    }\n\n  });\n\n\n  $('#refresh-progress-tracker').click(function() {\n    var $progress_tracker = $('#progress-tracker');\n    // Reload datatable, forcing reload of data not using cache\n    $table_wrapper.find('td').hide();\n    $progress_tracker.find('.dataTables_processing').text(\"Loading...\");\n    //Remove data, pass false to not use cache\n    $table_wrapper.DataTable().ajax.url(Drupal.settings.basePath + 'progress_tracker/load_data/false').load(function() {\n      // Show table after successfully refreshing\n      $table_wrapper.find('td').show();\n      $progress_tracker.find('.dataTables_processing').text(\"\");\n\n    });\n  });\n\n})(jQuery);\n"]}