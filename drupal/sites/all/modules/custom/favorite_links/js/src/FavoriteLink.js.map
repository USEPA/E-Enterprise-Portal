{"version":3,"sources":["FavoriteLink.js"],"names":["preload_links","$","hide","data","parseJSON","Drupal","settings","preloaded_link_data","url_data","favorite_urls","urls","favorite_url_mapping","url_mapping","id_label_mapping","label_mapping","createFavoriteButton","url","text_title","id","favorite_button","inArray","jQuery","link_status_changing","document","ready","FavoriteLink","$container","closest","attr","favored","parent","title","this","is_parent","qtip_postion","my","at","target","addClass","addFavoriteButton","after","qtip","content","text","next","fixed","delay","position","style","classes","width","setUrl","in_url","getUrl","setId","in_id","getId","getState","setState","in_favored","triggerParentForRemoval","unfavor","unfavor_children","setTitle","in_title","FavoriteLinkCollection","favorite_links","removeFavoriteLink","id_to_be_removed","favorite_link"],"mappings":"AAQA,QAASA,iBACLC,EAAE,cAAcC,MAChB,IAAIC,GAAOF,EAAEG,UAAUC,OAAOC,SAASC,oBAClB,UAAjBJ,EAAKK,WACLC,cAAgBN,EAAKO,KACrBC,qBAAuBR,EAAKS,YAC5BC,iBAAmBV,EAAKW,eAQhC,QAASC,sBAAqBC,EAAKC,GAE/B,GAAIC,GACAC,CAYJ,OAXIlB,GAAEmB,QAAQJ,EAAKP,gBAAkB,GACjCS,EAAKP,qBAAqBK,GAC1BG,EACI,2FAA6FD,EAAK,iMAItGA,EAAKF,EACLG,EAAkB,wFAA0FD,EAAK,KAAOD,EAAa,0JAGlIE,EArCXlB,EAAIoB,MAEJ,IAAIH,IAAK,EACLT,cACAE,qBACAE,iBACAS,sBAAuB,CAY3BrB,GAAEsB,UAAUC,MAAM,WACdxB,iBAqBJ,IAAIyB,cAAe,SAAUC,GAGzB,GAAIR,IAAK,EACLF,EAAMU,EAAWC,QAAQ,KAAKC,KAAK,QACnCC,GAAU,EACVC,EAAS,KAETC,EAAQL,EAAWE,KAAK,OACxBT,EAAkB,IAItBa,MAAKC,WAAY,EACjBD,KAAKE,cACDC,GAAI,eACJC,GAAI,eACJC,OAAQX,GAIZA,EAAWC,QAAQ,KAAKW,SAAS,sBAGjCN,KAAKO,kBAAoB,WACrBpB,EAAkBJ,qBAAqBC,EAAKe,GAC5CL,EAAWc,MAAMrB,GACjBO,EAAWe,MACPC,SACIC,KAAMjB,EAAWkB,KAAK,QAE1B1C,MACI2C,OAAO,EACPC,MAAO,KAEXC,SAAUf,KAAKE,aACfc,OACIC,QAAS,mBACTC,MAAO,MAKnBlB,KAAKmB,OAAS,SAAUC,GACpBpC,EAAMoC,GAEVpB,KAAKqB,OAAS,WACV,MAAOrC,IAEXgB,KAAKsB,MAAQ,SAAUC,GACnBrC,EAAKqC,GAETvB,KAAKwB,MAAQ,WACT,MAAOtC,IAGXc,KAAKyB,SAAW,WACZ,MAAO5B,IAEXG,KAAK0B,SAAW,SAAUC,GACtB9B,EAAU8B,GAGd3B,KAAK4B,wBAA0B,WAC3B9B,EAAO+B,UACP/B,EAAOgC,oBAGX9B,KAAK+B,SAAW,SAASC,GACrBjC,EAAQiC,IAuBZC,uBAAyB,WAQzB,GAAIC,KAIJlC,MAAKmC,mBAAqB,SAAUC,GAChC,GAAIC,GAAgBH,EAAeE,EAC/BC,GAAcpC,UACdoC,EAAcP,mBAEdO,EAAcT,gCACVM,GAAeE","file":"FavoriteLink.js","sourcesContent":["$ = jQuery;\r\n// global id for link tracking\r\nvar id = 0;\r\nvar favorite_urls;\r\nvar favorite_url_mapping;\r\nvar id_label_mapping;\r\nvar link_status_changing = false;\r\n\r\nfunction preload_links() {\r\n    $('#load_more').hide();\r\n    var data = $.parseJSON(Drupal.settings.preloaded_link_data);\r\n    if (data.url_data != 'false') {\r\n        favorite_urls = data.urls;\r\n        favorite_url_mapping = data.url_mapping;\r\n        id_label_mapping = data.label_mapping;\r\n    }\r\n}\r\n\r\n$(document).ready(function () {\r\n    preload_links();\r\n});\r\n\r\nfunction createFavoriteButton(url, text_title) {\r\n\r\n    var id;\r\n    var favorite_button;\r\n    if ($.inArray(url, favorite_urls) >= 0) {\r\n        id = favorite_url_mapping[url];\r\n        favorite_button =\r\n            \"<div class='button_input_holder' style='display:none'><span title='Remove Favorite' id='\" + id + \"__favorite_link' \" +\r\n            \" class=' remove_link favorite_hover old_link fa fa-heart filled' aria-hidden='true'></span><span class='sr-only'>Favorited. To remove favorite, press Ctrl + D</span></div>\";\r\n    }\r\n    else {\r\n        id = url;\r\n        favorite_button = '<div class=\"button_input_holder\" style=\"display:none\"><span title=\"Add Favorite\" id=\"' + id + '__' + text_title + '\"' +\r\n            \" class='add_link favorite_hover new_link fa fa-heart empty' aria-hidden='true'></span><span class='sr-only'>To favorite, press Ctrl + D</span></div>\";\r\n    }\r\n    return favorite_button;\r\n}\r\n\r\nvar FavoriteLink = function ($container) {\r\n\r\n    // Private\r\n    var id = -1;\r\n    var url = $container.closest('a').attr('href');\r\n    var favored = false;\r\n    var parent = null; // id of\r\n    var children = [];\r\n    var title = $container.attr('alt');\r\n    var favorite_button = null;\r\n\r\n\r\n    // Public\r\n    this.is_parent = false;\r\n    this.qtip_postion = {\r\n        my: 'right bottom',  // Position my top left...\r\n        at: 'right bottom', // at the bottom right of...\r\n        target: $container\r\n    }\r\n\r\n    // initial DOM element processing\r\n    $container.closest('a').addClass('processed-favorite');\r\n\r\n\r\n    this.addFavoriteButton = function () {\r\n        favorite_button = createFavoriteButton(url, title);\r\n        $container.after(favorite_button);\r\n        $container.qtip({ // Grab some elements to apply the tooltip to // add into class\r\n            content: {\r\n                text: $container.next('div')\r\n            },\r\n            hide: {\r\n                fixed: true,\r\n                delay: 300\r\n            },\r\n            position: this.qtip_postion,\r\n            style: {\r\n                classes: 'transparent-qtip',\r\n                width: 4\r\n            }\r\n        });\r\n    }\r\n\r\n    this.setUrl = function (in_url) {\r\n        url = in_url;\r\n    }\r\n    this.getUrl = function () {\r\n        return url;\r\n    }\r\n    this.setId = function (in_id) {\r\n        id = in_id;\r\n    }\r\n    this.getId = function () {\r\n        return id;\r\n    }\r\n\r\n    this.getState = function () {\r\n        return favored;\r\n    }\r\n    this.setState = function (in_favored) {\r\n        favored = in_favored;\r\n    }\r\n\r\n    this.triggerParentForRemoval = function () {\r\n        parent.unfavor();\r\n        parent.unfavor_children();\r\n    }\r\n\r\n    this.setTitle = function(in_title) {\r\n        title = in_title;\r\n    }\r\n\r\n    // Private\r\n\r\n    var unfavor = function () {\r\n        favored = false;\r\n        parent = null;\r\n        $anchor.unfavorHeart();\r\n    }\r\n\r\n    var favor = function () {\r\n        favored = true;\r\n        $anchor.favorHeart();\r\n    }\r\n\r\n    var unfavorChildren = function () {\r\n        $.each(children, function () {\r\n            this.unfavor();\r\n        });\r\n    }\r\n}\r\n\r\nvar FavoriteLinkCollection = function () {\r\n    /**\r\n     *\r\n     * @type {Array}\r\n     */\r\n\r\n\r\n    // favorite links object - look up by id. id points to array of 1 - many ids.\r\n    var favorite_links = {};\r\n\r\n\r\n    // remove favorite link\r\n    this.removeFavoriteLink = function (id_to_be_removed) {\r\n        var favorite_link = favorite_links[id_to_be_removed];\r\n        if (favorite_link.is_parent)\r\n            favorite_link.unfavor_children();\r\n        else\r\n            favorite_link.triggerParentForRemoval();\r\n        delete  favorite_links[id_to_be_removed];\r\n    }\r\n\r\n}"]}