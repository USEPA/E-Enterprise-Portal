{"version":3,"sources":["LocalResourcesTable.js"],"names":["yadtf_topic_configs","source","column","topic","category","tool_type","training_level","data_requirements","relevance","$","methods","init","$ul","insertAfter","this","baseId","prev","andSelf","wrapAll","attr","children","each","index","$option","id","$li","appendTo","$checkbox","change","parents","find","eq","is","prop","parent","after","text","String","toLowerCase","hide","fn","multiSelectToCheckboxes","method","apply","Array","prototype","slice","call","arguments","error","jQuery","LocalResourcesTable","dataTableExt","oApi","fnPagingInfo","oSettings","iStart","_iDisplayStart","iEnd","fnDisplayEnd","iLength","_iDisplayLength","iTotal","fnRecordsTotal","iFilteredTotal","fnRecordsDisplay","iPage","Math","ceil","iTotalPages","$table_wrapper","ajax_url","table_type","oStdClasses","sPageButton","datatable_options","bLengthChange","iDisplayLength","bAutoWidth","oLanguage","sSearch","pagingType","dom","fnDrawCallback","nRow","aData","iDisplayIndex","iDisplayIndexFull","pageInfo","pageNo","totalPages","$current_li","class","html","nTable","addClass","columnDefs","targets","visible","cached","datatable_id","wrapper_id","hideTable","ajax_request","from_embedded_topics","topics","$userFilters","ajax","beforeSend","$table","length","url","data","filters","success","table","shorten_string","str","max_len","substr","min","lastIndexOf","newId","max","parseInt","tableDT","DataTable","removeClass","updateDropdown","$elem_id","wrapperParentId","$wrapper_parent","yadcf","column_number","filter_type","filter_container_selector","filter_match_mode","filter_reset_button_text","your_selections","selection_lbl","$your_selections","facet_type","closest","replace","trim","facet_topic","topic_config_str","indexOf","selection","append","res_t","grep","n","i","click","e","$span_selector","next","$body","css","unbind","selected_selection","selected_id","trigger","on","ev","Drupal","CTools","Modal","show","scrollTop","attachBehaviors","preventDefault","showTable","updateTopics","values","filterTopics","topic_text","columns","search","draw"],"mappings":"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","file":"LocalResourcesTable.js","sourcesContent":["// mapping of topic name to column number, can be expanded as needed\nvar yadtf_topic_configs = {\n  source: {column: 2},\n  topic: {column: 3},\n  category: {column: 4},\n  tool_type: {column: 5},\n  training_level: {column: 6},\n  data_requirements: {column: 7},\n  relevance: {column: 8}\n};\n\n\n// @see https://gist.github.com/cman81/ef1ad79cff899c01160ba7d77f761f13\n// @see https://gist.github.com/jmcd/2284550\n(function ($) {\n\n  var methods = {\n    init: function () {\n      var $ul = $(\"<ul/>\").insertAfter(this);\n      var $container = $ul.prev().andSelf().wrapAll(\"<div class='multiselect-to-checkboxes'></div>\");\n      var baseId = \"_\" + $(this).attr(\"id\");\n      $(this).children(\"option\").each(function (index) {\n        var $option = $(this);\n        var id = baseId + index;\n        var $li = $(\"<li/>\").appendTo($ul);\n        var $checkbox = $(\"<input type='checkbox' id='\" + id + \"'/>\").appendTo($li).change(function () {\n          var $option = $(this).parents('.multiselect-to-checkboxes').find('select option').eq(index);\n          if ($(this).is(\":checked\")) {\n            $option.prop(\"selected\", true).parent().change();\n          } else {\n            $option.prop(\"selected\", false).parent().change();\n          }\n        });\n        if ($option.is(\":selected\")) {\n          $checkbox.prop(\"checked\");\n        }\n        $checkbox.after(\"<label for='\" + id + \"'>\" + $option.text() + \"</label>\");\n\n        // if this is a placeholder item, hide it so that it cannot be selected\n        if (String($option.attr('data-placeholder')).toLowerCase() == 'true') {\n          $li.hide();\n        }\n      });\n      $(this).hide();\n    }\n  };\n\n  $.fn.multiSelectToCheckboxes = function (method) {\n    if (methods[method]) {\n      return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));\n    } else if (typeof method === 'object' || !method) {\n      return methods.init.apply(this, arguments);\n    } else {\n      $.error('Method ' + method + ' does not exist on jQuery.multiSelectToCheckboxes');\n    }\n  };\n\n})(jQuery);\n\nvar LocalResourcesTable;\n\n(function ($) {\n  $.fn.dataTableExt.oApi.fnPagingInfo = function (oSettings) {\n    return {\n      \"iStart\": oSettings._iDisplayStart,\n      \"iEnd\": oSettings.fnDisplayEnd(),\n      \"iLength\": oSettings._iDisplayLength,\n      \"iTotal\": oSettings.fnRecordsTotal(),\n      \"iFilteredTotal\": oSettings.fnRecordsDisplay(),\n      \"iPage\": oSettings._iDisplayLength === -1 ?\n        0 : Math.ceil(oSettings._iDisplayStart / oSettings._iDisplayLength),\n      \"iTotalPages\": oSettings._iDisplayLength === -1 ?\n        0 : Math.ceil(oSettings.fnRecordsDisplay() / oSettings._iDisplayLength) - 1\n    };\n  };\n\n\n  LocalResourcesTable = function ($table_wrapper, ajax_url, table_type) {\n\n    $.fn.dataTableExt.oStdClasses.sPageButton = \"favorites-ignore fa\";\n    var datatable_options = {\n      \"bLengthChange\": false,\n      \"iDisplayLength\": 5,\n      \"bAutoWidth\": false,\n      \"oLanguage\": {\n        \"sSearch\": \"Filter:\"\n      },\n      \"pagingType\": \"simple\",\n      \"dom\": 'iftp',\n      \"fnDrawCallback\": function (nRow, aData, iDisplayIndex, iDisplayIndexFull) {\n        var pageInfo = this.fnPagingInfo();\n        var pageNo = pageInfo.iPage + 1;\n        var totalPages = pageInfo.iTotalPages + 1;\n\n        if (totalPages > 1) {\n          var $current_li = $('<li />', {\n            class: 'pager-current'\n          })\n            .html(pageNo + ' of ' + totalPages);\n          $table_wrapper.find('.dataTables_paginate li:first').after($current_li);\n        }\n        // Add needed classes after the table is rendered\n        $('td:first-child', nRow.nTable).addClass( \"resource-title\" );\n        $('td:nth-child(2)', nRow.nTable).addClass( \"resource-info\" );\n        $('td:nth-child(3)', nRow.nTable).addClass( \"resource-source\" ).attr('data-title', 'Source');\n        $('td:nth-child(4)', nRow.nTable).addClass( \"resource-topic\" ).attr('data-title', 'Topic');\n        $('td:nth-child(5)', nRow.nTable).addClass( \"resource-category\" ).attr('data-title', 'Category');\n      },\n      // hide the following columns, they are only used for faceted filtering\n      \"columnDefs\": [\n        {\n          \"targets\": [5, 6, 7, 8],\n          \"visible\": false\n        }\n      ]\n    };\n\n    var cached = false;\n    var datatable_id = '';\n    var wrapper_id = $table_wrapper.attr('id');\n\n    this.hideTable = function () {\n      $table_wrapper.hide();\n    };\n\n    this.ajax_request = function (from_embedded_topics) {\n      var topics = this.topics,\n          $userFilters = $('#user-local-resources-wrapper').find('[id^=_yadcf-filter]');\n      $.ajax({\n        beforeSend: function () {\n          var $table = $table_wrapper.find('.view-content');\n          if ($table.length > 0) {\n            $table.html('<p>Loading&hellip;</p>');\n          } else {\n            $table_wrapper.html('<p>Loading&hellip;</p>');\n          }\n          // Need to clear and freeze the filters while loading\n          $userFilters.prop('checked', false).prop('disabled', true);\n          $('#user-local-resources-wrapper').find('.your-selections .facet-topic-container').hide();\n        },\n        url: ajax_url,\n        method: \"POST\",\n        data: {filters: topics},\n        success: function (table) {\n          /**\n           * TODO: refactor - duplicate code block in the following files:\n           * other_items_of_interest/js/ItemsOfInterestTable.js\n           * other_items_of_interest/js/other_items_of_interest.js\n           */\n          // alter the datatable id, one digit larger than the largest id\n          var newId = 0;\n          $(\"table[id^='datatable-']\").each(function () {\n            newId = Math.max(newId, parseInt($(this).attr('id').substr('datatable-'.length), 10));\n          });\n          newId++;\n          var $table = $('<div>' + table + '</div>'); // wrap contents in a div for now, will unwrap later\n          datatable_id = 'datatable-' + newId;\n          $table.find('table').attr('id', datatable_id);\n          $table_wrapper.html($table.html()); // unwrap\n\n          $table = $table_wrapper.find('table');\n          if ($table.length > 0) {\n            var tableDT = $table.DataTable(datatable_options);\n            $table.removeClass(\"dataTable display no-footer\").addClass('views-table responsive-table usa-table-borderless');\n            // in embedded_lgc_topics_view.js\n            updateDropdown($('#user-lgc-topics-small-view'));\n            if (from_embedded_topics) {\n              var $elem_id = \"#embed-manage-lgc-\" + topics[0];\n              $($elem_id).addClass('selected');\n            }\n\n            // initialize faceted filtering using Yet Another DataTables Column Filter (yadcf) library\n            // @see views-view--recommended-resources--block.tpl.php\n            var wrapperParentId = $table_wrapper.parents('.local.resources.wrapper').attr('id');\n            var $wrapper_parent = $('#' + wrapperParentId);\n\n            // Remove all previous facets for initialization\n            $('#' + wrapperParentId + ' .facet').html('');\n\n            yadcf.init(tableDT, [\n              {\n                column_number: 2,\n                filter_type: 'multi_select',\n                filter_container_selector: '#' + wrapperParentId + ' .source.facet',\n                filter_match_mode: 'exact',\n                filter_reset_button_text: false\n              },\n              {\n                column_number: 3,\n                filter_type: 'multi_select',\n                filter_container_selector: '#' + wrapperParentId + ' .topic.facet',\n                filter_match_mode: 'exact',\n                filter_reset_button_text: false\n              },\n              {\n                column_number: 4,\n                filter_type: 'multi_select',\n                filter_container_selector: '#' + wrapperParentId + ' .category.facet',\n                filter_match_mode: 'exact',\n                filter_reset_button_text: false\n              },\n              {\n                column_number: 5,\n                filter_type: 'multi_select',\n                filter_container_selector: '#' + wrapperParentId + ' .tool-type.facet',\n                filter_match_mode: 'exact',\n                filter_reset_button_text: false\n              },\n              {\n                column_number: 6,\n                filter_type: 'multi_select',\n                filter_container_selector: '#' + wrapperParentId + ' .training-level.facet',\n                filter_match_mode: 'exact',\n                filter_reset_button_text: false\n              },\n              {\n                column_number: 7,\n                filter_type: 'multi_select',\n                filter_container_selector: '#' + wrapperParentId + ' .data-requirements.facet',\n                filter_match_mode: 'exact',\n                filter_reset_button_text: false\n              },\n              {\n                column_number: 8,\n                filter_type: 'multi_select',\n                filter_container_selector: '#' + wrapperParentId + ' .relevance.facet',\n                filter_match_mode: 'exact',\n                filter_reset_button_text: false\n              }\n            ]);\n            $('#' + wrapperParentId).find('.facet select').each(function () {\n              $(this).multiSelectToCheckboxes();\n            });\n\n            var your_selections = $('.your-selections');\n            if (your_selections.find('.selection-lbl').length === 0) {\n              var selection_lbl = \"<div class='selection-lbl'>\" + your_selections.html() + \"</div>\";\n              your_selections.html(selection_lbl);\n            }\n\n            var $your_selections;\n            if (table_type === 'my') {\n              $your_selections = $wrapper_parent.find('.your-selections.my-resources');\n            } else {\n              $your_selections = $wrapper_parent.find('.your-selections.all-resources');\n            }\n\n            /*Iterate through Source facet, search for the number of occurrences of that facet in the data table and show\n             *count next to each facet. TODO: put this in a function after the MVP is accepted.*/\n            $('div[id^=\"yadcf-filter-wrapper--' + wrapper_id + '-wrapper\"]').find('li').each(function (index) {\n              if (index > 0) {\n                var facet_type = $(this).closest('.facet').attr('class').replace('facet', '').trim();\n                var facet_topic = $(this).children('label').html();\n                // Switch hyphen to underscore for looking up column number\n                var topic_config_str = facet_type.replace('-', '_');\n                var column_number = yadtf_topic_configs[topic_config_str].column;\n\n                if ((facet_topic.indexOf(\"(\")) < 0) {\n                  $(this).children('label').attr('title', facet_topic);\n                  var selection = \"<span class='facet-topic-container' title='\" + facet_topic + \"'><span title = '\" + facet_topic + \"'>\" + facet_topic + \"</span><a href='javascript:void(0)'><span class='sr-only'>Remove \"+ facet_topic +\"</span></a></span>\";\n                  if ($your_selections.find('span[title=\"' + facet_topic + '\"]').length === 0) {\n                    $your_selections.append(selection);\n                    $your_selections.find('span.facet-topic-container').hide();\n                  }\n                }\n                var res_t = $.grep(tableDT.data(), function (n, i) {\n                  return (facet_topic.trim()) == (n[column_number]).trim();\n                }, false);\n                if ((facet_topic.indexOf(\"(\")) < 0) {\n                  $(this).children('label').html(facet_topic + \" (\" + res_t.length + \")\");\n                }\n              }\n            });\n\n\n            /*On Topic Facet click (select), show topic above data table and hide if the click event unchecks the\n             *clicked checkbox TODO: put this in a function after the MVP is accepted.*/\n            $('div[id^=\"yadcf-filter-wrapper--' + wrapperParentId + '\"]').find('input').click(function (e) {\n              var $span_selector = $wrapper_parent.find('span.facet-topic-container[title=\"' + $(this).next().attr('title') + '\"]');\n              var $your_selections = $('.your-selections');\n              var visible = $span_selector.is(\":visible\");\n              // show label if checked\n              if (!visible) {\n                $span_selector.css('display', 'inline-block');\n                $span_selector.find('span').html(shorten_string($(this).next().attr('title'), 40));\n                var remove_link = $(this).next().attr('title');\n                $span_selector.find('a span').html('Remove ' + $(this).next().attr('title'));\n              } else {\n                $span_selector.hide();\n                $body.find('.clear-lgc-resources').hide();\n              }\n            });\n\n\n            /* On Close button click, mimic a checkbox click event. After modifying the \"My Profile Topics\" there is a\n             * chance the close button can have multiply click events added to fake a click on the checkbox.  When an\n             * even number of listeners are created, the button appears to fail.\n             * */\n            $wrapper_parent.find('.your-selections span.facet-topic-container a').unbind('click').click(function (e) {\n              var selected_selection = $(this).parent().attr('title');\n              var selected_id = $wrapper_parent.find('.multiselect-to-checkboxes ul li label[title=\\'' + selected_selection + '\\']').attr('for');\n              $wrapper_parent.find(\"#\" + selected_id).trigger('click')\n            });\n\n            function shorten_string(str, max_len) {\n              if (str.length < max_len) {\n                return str;\n              }\n              else {\n                str = str.substr(0, max_len);\n                str = str.substr(0, Math.min(str.length, str.lastIndexOf(\" \")));\n                return str + \" ...\";\n              }\n            }\n\n            // Click handler for clicking 'i' icon - show modal\n            // @see http://drupal.stackexchange.com/questions/88399/ctools-modals-without-ajax\n            $('#local-resources-tabs').on('click', 'td.views-field-nothing a', function (ev) {\n              Drupal.CTools.Modal.show(\"ee-ctools-popup-style\");\n              $('#modal-title').html('Resource Info');\n              $('#modal-content').html($(this).parent().text()).scrollTop(0);\n              Drupal.attachBehaviors();\n              ev.preventDefault();\n            });\n\n          }\n          else {\n            $table_wrapper.html('<div class=\"no-topics\">You have not selected any local government interests. <a href=\"javascript:void(0);\" id=\"add-more-topics\">Add some here.</a></div>');\n          }\n\n          // Unfreeze filters\n          $userFilters.prop('disabled', false);\n\n          cached = true;\n        }\n      });\n    };\n\n    this.showTable = function () {\n      if (!cached)\n        this.ajax_request();\n      $table_wrapper.show();\n    };\n    this.updateTopics = function (values, from_embedded_topics) {\n      this.topics = values;\n      if (from_embedded_topics) {\n        this.ajax_request(from_embedded_topics);\n      }\n      else {\n        this.ajax_request();\n      }\n    };\n    this.filterTopics = function (topic_text) {\n      if (datatable_id !== '') {\n        var $table = $('#' + datatable_id);\n        $table.DataTable().columns().search(topic_text).draw();\n      }\n    }\n\n  };\n})(jQuery);\n\n\n"]}