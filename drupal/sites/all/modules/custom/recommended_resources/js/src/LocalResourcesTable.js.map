{"version":3,"sources":["LocalResourcesTable.js"],"names":["yadtf_topic_configs","source","column","topic","category","tool_type","training_level","data_requirements","relevance","$","methods","init","$ul","insertAfter","this","baseId","prev","andSelf","wrapAll","attr","children","each","index","$option","id","$li","appendTo","$checkbox","change","parents","find","eq","is","prop","parent","after","text","String","toLowerCase","hide","fn","multiSelectToCheckboxes","method","apply","Array","prototype","slice","call","arguments","error","jQuery","LocalResourcesTable","dataTableExt","oApi","fnPagingInfo","oSettings","iStart","_iDisplayStart","iEnd","fnDisplayEnd","iLength","_iDisplayLength","iTotal","fnRecordsTotal","iFilteredTotal","fnRecordsDisplay","iPage","Math","ceil","iTotalPages","$table_wrapper","ajax_url","table_type","oStdClasses","sPageButton","datatable_options","bLengthChange","iDisplayLength","bAutoWidth","oLanguage","sSearch","pagingType","dom","fnDrawCallback","nRow","aData","iDisplayIndex","iDisplayIndexFull","pageInfo","pageNo","totalPages","$current_li","class","html","nTable","addClass","columnDefs","targets","visible","cached","datatable_id","wrapper_id","hideTable","ajax_request","from_embedded_topics","topics","$userFilters","ajax","beforeSend","$table","length","url","data","filters","success","table","shorten_string","str","max_len","substr","min","lastIndexOf","newId","max","parseInt","tableDT","DataTable","removeClass","updateDropdown","$elem_id","wrapperParentId","$wrapper_parent","yadcf","column_number","filter_type","filter_container_selector","filter_match_mode","filter_reset_button_text","your_selections","selection_lbl","$your_selections","facet_type","closest","replace","trim","facet_topic","topic_config_str","indexOf","selection","append","res_t","grep","n","i","click","e","$span_selector","next","css","unbind","selected_selection","selected_id","trigger","on","ev","Drupal","CTools","Modal","show","scrollTop","attachBehaviors","preventDefault","showTable","updateTopics","values","filterTopics","topic_text","columns","search","draw"],"mappings":"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","file":"LocalResourcesTable.js","sourcesContent":["// mapping of topic name to column number, can be expanded as needed\r\nvar yadtf_topic_configs = {\r\n  source: {column: 2},\r\n  topic: {column: 3},\r\n  category: {column: 4},\r\n  tool_type: {column: 5},\r\n  training_level: {column: 6},\r\n  data_requirements: {column: 7},\r\n  relevance: {column: 8}\r\n};\r\n\r\n\r\n// @see https://gist.github.com/cman81/ef1ad79cff899c01160ba7d77f761f13\r\n// @see https://gist.github.com/jmcd/2284550\r\n(function ($) {\r\n\r\n  var methods = {\r\n    init: function () {\r\n      var $ul = $(\"<ul/>\").insertAfter(this);\r\n      var $container = $ul.prev().andSelf().wrapAll(\"<div class='multiselect-to-checkboxes'></div>\");\r\n      var baseId = \"_\" + $(this).attr(\"id\");\r\n      $(this).children(\"option\").each(function (index) {\r\n        var $option = $(this);\r\n        var id = baseId + index;\r\n        var $li = $(\"<li/>\").appendTo($ul);\r\n        var $checkbox = $(\"<input type='checkbox' id='\" + id + \"'/>\").appendTo($li).change(function () {\r\n          var $option = $(this).parents('.multiselect-to-checkboxes').find('select option').eq(index);\r\n          if ($(this).is(\":checked\")) {\r\n            $option.prop(\"selected\", true).parent().change();\r\n          } else {\r\n            $option.prop(\"selected\", false).parent().change();\r\n          }\r\n        });\r\n        if ($option.is(\":selected\")) {\r\n          $checkbox.prop(\"checked\");\r\n        }\r\n        $checkbox.after(\"<label for='\" + id + \"'>\" + $option.text() + \"</label>\");\r\n\r\n        // if this is a placeholder item, hide it so that it cannot be selected\r\n        if (String($option.attr('data-placeholder')).toLowerCase() == 'true') {\r\n          $li.hide();\r\n        }\r\n      });\r\n      $(this).hide();\r\n    }\r\n  };\r\n\r\n  $.fn.multiSelectToCheckboxes = function (method) {\r\n    if (methods[method]) {\r\n      return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));\r\n    } else if (typeof method === 'object' || !method) {\r\n      return methods.init.apply(this, arguments);\r\n    } else {\r\n      $.error('Method ' + method + ' does not exist on jQuery.multiSelectToCheckboxes');\r\n    }\r\n  };\r\n\r\n})(jQuery);\r\n\r\nvar LocalResourcesTable;\r\n\r\n(function ($) {\r\n  $.fn.dataTableExt.oApi.fnPagingInfo = function (oSettings) {\r\n    return {\r\n      \"iStart\": oSettings._iDisplayStart,\r\n      \"iEnd\": oSettings.fnDisplayEnd(),\r\n      \"iLength\": oSettings._iDisplayLength,\r\n      \"iTotal\": oSettings.fnRecordsTotal(),\r\n      \"iFilteredTotal\": oSettings.fnRecordsDisplay(),\r\n      \"iPage\": oSettings._iDisplayLength === -1 ?\r\n        0 : Math.ceil(oSettings._iDisplayStart / oSettings._iDisplayLength),\r\n      \"iTotalPages\": oSettings._iDisplayLength === -1 ?\r\n        0 : Math.ceil(oSettings.fnRecordsDisplay() / oSettings._iDisplayLength) - 1\r\n    };\r\n  };\r\n\r\n\r\n  LocalResourcesTable = function ($table_wrapper, ajax_url, table_type) {\r\n\r\n    $.fn.dataTableExt.oStdClasses.sPageButton = \"favorites-ignore fa\";\r\n    var datatable_options = {\r\n      \"bLengthChange\": false,\r\n      \"iDisplayLength\": 5,\r\n      \"bAutoWidth\": false,\r\n      \"oLanguage\": {\r\n        \"sSearch\": \"Filter:\"\r\n      },\r\n      \"pagingType\": \"simple\",\r\n      \"dom\": 'iftp',\r\n      \"fnDrawCallback\": function (nRow, aData, iDisplayIndex, iDisplayIndexFull) {\r\n        var pageInfo = this.fnPagingInfo();\r\n        var pageNo = pageInfo.iPage + 1;\r\n        var totalPages = pageInfo.iTotalPages + 1;\r\n\r\n        if (totalPages > 1) {\r\n          var $current_li = $('<li />', {\r\n            class: 'pager-current'\r\n          })\r\n            .html(pageNo + ' of ' + totalPages);\r\n          $table_wrapper.find('.dataTables_paginate li:first').after($current_li);\r\n        }\r\n        // Add needed classes after the table is rendered\r\n        $('td:first-child', nRow.nTable).addClass( \"resource-title\" );\r\n        $('td:nth-child(2)', nRow.nTable).addClass( \"resource-info\" );\r\n        $('td:nth-child(3)', nRow.nTable).addClass( \"resource-source\" ).attr('data-title', 'Source');\r\n        $('td:nth-child(4)', nRow.nTable).addClass( \"resource-topic\" ).attr('data-title', 'Topic');\r\n        $('td:nth-child(5)', nRow.nTable).addClass( \"resource-category\" ).attr('data-title', 'Category');\r\n      },\r\n      // hide the following columns, they are only used for faceted filtering\r\n      \"columnDefs\": [\r\n        {\r\n          \"targets\": [5, 6, 7, 8],\r\n          \"visible\": false\r\n        }\r\n      ]\r\n    };\r\n\r\n    var cached = false;\r\n    var datatable_id = '';\r\n    var wrapper_id = $table_wrapper.attr('id');\r\n\r\n    this.hideTable = function () {\r\n      $table_wrapper.hide();\r\n    };\r\n\r\n    this.ajax_request = function (from_embedded_topics) {\r\n      var topics = this.topics,\r\n          $userFilters = $('#user-local-resources-wrapper').find('[id^=_yadcf-filter]');\r\n      $.ajax({\r\n        beforeSend: function () {\r\n          var $table = $table_wrapper.find('.view-content');\r\n          if ($table.length > 0) {\r\n            $table.html('<p>Loading&hellip;</p>');\r\n          } else {\r\n            $table_wrapper.html('<p>Loading&hellip;</p>');\r\n          }\r\n          // Need to clear and freeze the filters while loading\r\n          $userFilters.prop('checked', false).prop('disabled', true);\r\n          $('#user-local-resources-wrapper').find('.your-selections .facet-topic-container').hide();\r\n        },\r\n        url: ajax_url,\r\n        method: \"POST\",\r\n        data: {filters: topics},\r\n        success: function (table) {\r\n          /**\r\n           * TODO: refactor - duplicate code block in the following files:\r\n           * other_items_of_interest/js/ItemsOfInterestTable.js\r\n           * other_items_of_interest/js/other_items_of_interest.js\r\n           */\r\n          // alter the datatable id, one digit larger than the largest id\r\n          var newId = 0;\r\n          $(\"table[id^='datatable-']\").each(function () {\r\n            newId = Math.max(newId, parseInt($(this).attr('id').substr('datatable-'.length), 10));\r\n          });\r\n          newId++;\r\n          var $table = $('<div>' + table + '</div>'); // wrap contents in a div for now, will unwrap later\r\n          datatable_id = 'datatable-' + newId;\r\n          $table.find('table').attr('id', datatable_id);\r\n          $table_wrapper.html($table.html()); // unwrap\r\n\r\n          $table = $table_wrapper.find('table');\r\n          if ($table.length > 0) {\r\n            var tableDT = $table.DataTable(datatable_options);\r\n            $table.removeClass(\"dataTable display no-footer\").addClass('views-table responsive-table usa-table-borderless');\r\n            // in embedded_lgc_topics_view.js\r\n            updateDropdown($('#user-lgc-topics-small-view'));\r\n            if (from_embedded_topics) {\r\n              var $elem_id = \"#embed-manage-lgc-\" + topics[0];\r\n              $($elem_id).addClass('selected');\r\n            }\r\n\r\n            // initialize faceted filtering using Yet Another DataTables Column Filter (yadcf) library\r\n            // @see views-view--recommended-resources--block.tpl.php\r\n            var wrapperParentId = $table_wrapper.parents('.local.resources.wrapper').attr('id');\r\n            var $wrapper_parent = $('#' + wrapperParentId);\r\n\r\n            // Remove all previous facets for initialization\r\n            $('#' + wrapperParentId + ' .facet').html('');\r\n\r\n            yadcf.init(tableDT, [\r\n              {\r\n                column_number: 2,\r\n                filter_type: 'multi_select',\r\n                filter_container_selector: '#' + wrapperParentId + ' .source.facet',\r\n                filter_match_mode: 'exact',\r\n                filter_reset_button_text: false\r\n              },\r\n              {\r\n                column_number: 3,\r\n                filter_type: 'multi_select',\r\n                filter_container_selector: '#' + wrapperParentId + ' .topic.facet',\r\n                filter_match_mode: 'exact',\r\n                filter_reset_button_text: false\r\n              },\r\n              {\r\n                column_number: 4,\r\n                filter_type: 'multi_select',\r\n                filter_container_selector: '#' + wrapperParentId + ' .category.facet',\r\n                filter_match_mode: 'exact',\r\n                filter_reset_button_text: false\r\n              },\r\n              {\r\n                column_number: 5,\r\n                filter_type: 'multi_select',\r\n                filter_container_selector: '#' + wrapperParentId + ' .tool-type.facet',\r\n                filter_match_mode: 'exact',\r\n                filter_reset_button_text: false\r\n              },\r\n              {\r\n                column_number: 6,\r\n                filter_type: 'multi_select',\r\n                filter_container_selector: '#' + wrapperParentId + ' .training-level.facet',\r\n                filter_match_mode: 'exact',\r\n                filter_reset_button_text: false\r\n              },\r\n              {\r\n                column_number: 7,\r\n                filter_type: 'multi_select',\r\n                filter_container_selector: '#' + wrapperParentId + ' .data-requirements.facet',\r\n                filter_match_mode: 'exact',\r\n                filter_reset_button_text: false\r\n              },\r\n              {\r\n                column_number: 8,\r\n                filter_type: 'multi_select',\r\n                filter_container_selector: '#' + wrapperParentId + ' .relevance.facet',\r\n                filter_match_mode: 'exact',\r\n                filter_reset_button_text: false\r\n              }\r\n            ]);\r\n            $('#' + wrapperParentId).find('.facet select').each(function () {\r\n              $(this).multiSelectToCheckboxes();\r\n            });\r\n\r\n            var your_selections = $('.your-selections');\r\n            if (your_selections.find('.selection-lbl').length == 0) {\r\n\r\n              var selection_lbl = \"<div class='selection-lbl'>\" + your_selections.html() + \"</div>\";\r\n              your_selections.html(selection_lbl);\r\n            }\r\n\r\n            var $your_selections;\r\n            if (table_type === 'my') {\r\n              $your_selections = $wrapper_parent.find('.your-selections.my-resources');\r\n            } else {\r\n              $your_selections = $wrapper_parent.find('.your-selections.all-resources');\r\n            }\r\n\r\n            /*Iterate through Source facet, search for the number of occurrences of that facet in the data table and show\r\n             *count next to each facet. TODO: put this in a function after the MVP is accepted.*/\r\n            $('div[id^=\"yadcf-filter-wrapper--' + wrapper_id + '-wrapper\"]').find('li').each(function (index) {\r\n              if (index > 0) {\r\n                var facet_type = $(this).closest('.facet').attr('class').replace('facet', '').trim();\r\n                var facet_topic = $(this).children('label').html();\r\n                // Switch hyphen to underscore for looking up column number\r\n                var topic_config_str = facet_type.replace('-', '_');\r\n                var column_number = yadtf_topic_configs[topic_config_str].column;\r\n\r\n                if ((facet_topic.indexOf(\"(\")) < 0) {\r\n                  $(this).children('label').attr('title', facet_topic);\r\n                  var selection = \"<span class='facet-topic-container' title='\" + facet_topic + \"'><span title = '\" + facet_topic + \"'>\" + facet_topic + \"</span><a href='javascript:void(0)'></a></span>\";\r\n                  if ($your_selections.find('span[title=\"' + facet_topic + '\"]').length === 0) {\r\n                    $your_selections.append(selection);\r\n                    $your_selections.find('span.facet-topic-container').hide();\r\n                  }\r\n                }\r\n                var res_t = $.grep(tableDT.data(), function (n, i) {\r\n                  return (facet_topic.trim()) == (n[column_number]).trim();\r\n                }, false);\r\n                if ((facet_topic.indexOf(\"(\")) < 0) {\r\n                  $(this).children('label').html(facet_topic + \" (\" + res_t.length + \")\");\r\n                }\r\n              }\r\n            });\r\n\r\n\r\n            /*On Topic Facet click (select), show topic above data table and hide if the click event unchecks the\r\n             *clicked checkbox TODO: put this in a function after the MVP is accepted.*/\r\n            $('div[id^=\"yadcf-filter-wrapper--' + wrapperParentId + '\"]').find('input').click(function (e) {\r\n              var $span_selector = $wrapper_parent.find('span.facet-topic-container[title=\"' + $(this).next().attr('title') + '\"]');\r\n              var $your_selections = $('.your-selections');\r\n              var visible = $span_selector.is(\":visible\");\r\n              // show label if checked\r\n              if (!visible) {\r\n                $span_selector.css('display', 'inline-block');\r\n                $span_selector.find('span').html(shorten_string($(this).next().attr('title'), 40));\r\n              } else {\r\n                $span_selector.hide();\r\n              }\r\n            });\r\n\r\n\r\n            /* On Close button click, mimic a checkbox click event. After modifying the \"My Profile Topics\" there is a\r\n             * chance the close button can have multiply click events added to fake a click on the checkbox.  When an\r\n             * even number of listeners are created, the button appears to fail.\r\n             * */\r\n            $wrapper_parent.find('.your-selections span.facet-topic-container a').unbind('click').click(function (e) {\r\n              var selected_selection = $(this).parent().attr('title');\r\n              var selected_id = $wrapper_parent.find('.multiselect-to-checkboxes ul li label[title=\\'' + selected_selection + '\\']').attr('for');\r\n              $wrapper_parent.find(\"#\" + selected_id).trigger('click')\r\n            });\r\n\r\n            function shorten_string(str, max_len) {\r\n              if (str.length < max_len) {\r\n                return str;\r\n              }\r\n              else {\r\n                str = str.substr(0, max_len);\r\n                str = str.substr(0, Math.min(str.length, str.lastIndexOf(\" \")));\r\n                return str + \" ...\";\r\n              }\r\n            }\r\n\r\n            // Click handler for clicking 'i' icon - show modal\r\n            // @see http://drupal.stackexchange.com/questions/88399/ctools-modals-without-ajax\r\n            $('#local-resources-tabs').on('click', 'td.views-field-nothing a', function (ev) {\r\n              Drupal.CTools.Modal.show(\"ee-ctools-popup-style\");\r\n              $('#modal-title').html('Resource Info');\r\n              $('#modal-content').html($(this).parent().text()).scrollTop(0);\r\n              Drupal.attachBehaviors();\r\n              ev.preventDefault();\r\n            });\r\n\r\n          }\r\n          else {\r\n            $table_wrapper.html('<div class=\"no-topics\">You have not selected any local government interests. <a href=\"javascript:void(0);\" id=\"add-more-topics\">Add some here.</a></div>');\r\n          }\r\n\r\n          // Unfreeze filters\r\n          $userFilters.prop('disabled', false);\r\n\r\n          cached = true;\r\n        }\r\n      });\r\n    };\r\n\r\n    this.showTable = function () {\r\n      if (!cached)\r\n        this.ajax_request();\r\n      $table_wrapper.show();\r\n    };\r\n    this.updateTopics = function (values, from_embedded_topics) {\r\n      this.topics = values;\r\n      if (from_embedded_topics) {\r\n        this.ajax_request(from_embedded_topics);\r\n      }\r\n      else {\r\n        this.ajax_request();\r\n      }\r\n    };\r\n    this.filterTopics = function (topic_text) {\r\n      if (datatable_id !== '') {\r\n        var $table = $('#' + datatable_id);\r\n        $table.DataTable().columns().search(topic_text).draw();\r\n      }\r\n    }\r\n\r\n  };\r\n})(jQuery);\r\n\r\n\r\n"]}