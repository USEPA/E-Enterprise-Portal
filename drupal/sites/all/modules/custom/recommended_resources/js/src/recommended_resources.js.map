{"version":3,"sources":["recommended_resources.js"],"names":["favorite_local_resources_table","all_local_resources_table","pane_class","manage_components_title","$","showLGCResourcesView","$localResourcesTabs","find","removeClass","updateTopics","showTable","hide","text","show","loadManageTopicsView","ajax","url","beforeSend","html","success","html_view","showFocusedTopicView","$lgc_topic_elem","addClass","id","attr","title","tid_array","split","tid","length","filterTopics","document","ready","$body","guest_user","Drupal","settings","is_guest","LocalResourcesTable","$tabs","tabs","on","ev","this","focus","first_time_user_loading","first_time_user_block","ajax_request","updateDropdown","preventDefault","$localResources","parents","toggle","toggleClass","$h3","next","jQuery"],"mappings":"AAAA,GAAIA,gCAAgCC,0BAChCC,WAAa,0CACbC,wBAA0B,4BAE7B,SAAUC,GAET,QAASC,KACP,GAAIC,GAAsBF,EAAE,wBAC5BA,GAAE,+BAA+BG,KAAK,SAASC,YAAY,YAC3DR,+BAA+BS,iBAC/BT,+BAA+BU,YAC/BN,EAAE,6BAA6BO,OAC/BP,EAAE,eAAeQ,KAAK,IACtBR,EAAE,uBAAuBO,OACzBP,EAAE,uBAAuBO,OACzBL,EAAoBO,OACpBT,EAAEF,YAAYK,KAAK,eAAeM,OAClCT,EAAEF,YAAYK,KAAK,gBAAgBM,OAOrC,QAASC,KACP,GAAIR,GAAsBF,EAAE,wBAC5BA,GAAEW,MACAC,IAAK,6BACLC,WAAY,WACVX,EAAoBK,OACpBP,EAAEF,YAAYK,KAAK,eAAeI,OAClCP,EAAE,uBAAuBO,OACzBP,EAAE,uBAAuBS,OACzBT,EAAE,eAAeQ,KAAKT,yBAAyBU,OAC/CT,EAAE,6BAA6Bc,KAAK,cAAcL,QAEpDM,QAAS,SAAUC,GACjBhB,EAAE,6BAA6Bc,KAAKE,MAK1C,QAASC,GAAqBC,GAC5BA,EAAgBC,SAAS,YACzBnB,EAAEF,YAAYK,KAAK,eAAeI,OAClCP,EAAEF,YAAYK,KAAK,gBAAgBI,MACnC,IAAIa,GAAKF,EAAgBG,KAAK,MAC1BC,EAAQJ,EAAgBV,OACxBe,EAAYH,EAAGI,MAAM,KACrBC,EAAMF,EAAUA,EAAUG,OAAS,EACvC1B,GAAE,eAAeQ,KAAKc,GACtBtB,EAAE,uBAAuBS,OACzBT,EAAE,uBAAuBqB,KAAK,KAAM,gBAAkBI,GAAKhB,OAC3Db,+BAA+B+B,aAAaL,GAI9CtB,EAAE4B,UAAUC,MAAM,WAChB,GAAIC,GAAQ9B,EAAE,QACV+B,EAAaC,OAAOC,SAASC,QAIjC,IAFArC,0BAA4B,GAAIsC,qBAAoBnC,EAAE,wBAAyB,iCAAkC,QAE5G+B,EAAY,CACfnC,+BAAiC,GAAIuC,qBAAoBnC,EAAE,yBAA0B,kCAAmC,KAExH,IAAIoC,GAAQpC,EAAE,wBACdoC,GAAMC,OACND,EAAMjC,KAAK,kBAAkBmC,GAAG,QAAS,SAASC,GAChDvC,EAAEwC,MAAMC,UAKZ,GAAIC,IAA0B,EAC1BC,EAAwB3C,EAAE,yBAC1B2C,GAAsBjB,OAAS,IACjCgB,GAA0B,GAGvBA,IACEX,EAKHlC,0BAA0BS,aAJ1BT,0BAA0BS,YAC1BV,+BAA+BgD,iBAOnC5C,EAAE4B,UAAUU,GAAG,8BAA+B,WAC5CI,GAA0B,EACrBX,EAKHlC,0BAA0BS,aAJ1BT,0BAA0BS,YAC1BV,+BAA+BgD,kBAOnCd,EAAMQ,GAAG,QAAS,oCAAqC,WACrDrB,EAAqBjB,EAAEwC,SAGzBV,EAAMQ,GAAG,QAAS,2CAA4C,WAC5D5B,MAGFoB,EAAMQ,GAAG,QAAS,yDAChB,WACErC,MAGJ6B,EAAMQ,GAAG,QAAS,sCAAuC,WACvDO,eAAe7C,EAAE,kCAKnB8B,EAAMQ,GAAG,QAAS,mDAAoD,SAASC,GAC7EA,EAAGO,gBACH,IAAIC,GAAkB/C,EAAEwC,MAAMQ,QAAQ,mBACtCD,GAAgB5C,KAAK,oBAAoB8C,SACzCF,EAAgBG,YAAY,+BAI9BpB,EAAMQ,GAAG,QAAS,6BAA8B,SAASC,GACvDA,EAAGO,gBACH,IAAIK,GAAMnD,EAAEwC,MAAMQ,QAAQ,KAC1BG,GAAIC,OAAOH,SACXE,EAAIhD,KAAK,QAAQ+C,YAAY,eAGjCG","file":"recommended_resources.js","sourcesContent":["var favorite_local_resources_table, all_local_resources_table;\r\nvar pane_class = \".pane-views-recommended-resources-block\";\r\nvar manage_components_title = \"Manage My Profile Topics\";\r\n\r\n(function ($) {\r\n\r\n  function showLGCResourcesView() {\r\n    var $localResourcesTabs = $('#local-resources-tabs');\r\n    $('#user-lgc-topics-small-view').find('label').removeClass('selected');\r\n    favorite_local_resources_table.updateTopics([]);\r\n    favorite_local_resources_table.showTable();\r\n    $('#manage-my-topics-wrapper').hide();\r\n    $('.lgc-header').text('');\r\n    $('.back-to-lgc-widget').hide();\r\n    $('.unfollow-lgc-topic').hide();\r\n    $localResourcesTabs.show();\r\n    $(pane_class).find('.pane-title').show();\r\n    $(pane_class).find('.ui-tabs-nav').show();\r\n  }\r\n\r\n\r\n  /**\r\n   * Loads manage topics view via an ajax request\r\n   */\r\n  function loadManageTopicsView() {\r\n    var $localResourcesTabs = $('#local-resources-tabs');\r\n    $.ajax({\r\n      url: \"manage_my_topics/load_view\",\r\n      beforeSend: function () {\r\n        $localResourcesTabs.hide();\r\n        $(pane_class).find('.pane-title').hide();\r\n        $('.unfollow-lgc-topic').hide();\r\n        $('.back-to-lgc-widget').show();\r\n        $('.lgc-header').text(manage_components_title).show();\r\n        $('#manage-my-topics-wrapper').html('Loading...').show();\r\n      },\r\n      success: function (html_view) {\r\n        $('#manage-my-topics-wrapper').html(html_view);\r\n      }\r\n    });\r\n  }\r\n\r\n  function showFocusedTopicView($lgc_topic_elem) {\r\n    $lgc_topic_elem.addClass('selected');\r\n    $(pane_class).find('.pane-title').hide();\r\n    $(pane_class).find('.ui-tabs-nav').hide();\r\n    var id = $lgc_topic_elem.attr('id');\r\n    var title = $lgc_topic_elem.text();\r\n    var tid_array = id.split('-');\r\n    var tid = tid_array[tid_array.length - 1];\r\n    $('.lgc-header').text(title);\r\n    $('.back-to-lgc-widget').show();\r\n    $('.unfollow-lgc-topic').attr('id', 'unfollow-lgc-' + tid).show();\r\n    favorite_local_resources_table.filterTopics(title);\r\n  }\r\n\r\n\r\n  $(document).ready(function () {\r\n    var $body = $('body');\r\n    var guest_user = Drupal.settings.is_guest;\r\n\r\n    all_local_resources_table = new LocalResourcesTable($(\"#all-local-resources\"), 'generateAllLocalResourcesTable', 'all');\r\n    // Guest user can only view all the content, so they do not have tabs\r\n    if (!guest_user) {\r\n      favorite_local_resources_table = new LocalResourcesTable($(\"#user-local-resources\"), 'generateUserLocalResourcesTable', 'my');\r\n\r\n      var $tabs = $(\"#local-resources-tabs\");\r\n      $tabs.tabs();\r\n      $tabs.find('.ui-corner-top').on('click', function(ev) {\r\n        $(this).focus();\r\n      });\r\n    }\r\n\r\n    // Restrict loading to after first time user preferences if applicable\r\n    var first_time_user_loading = false;\r\n    var first_time_user_block = $('#first-time-user-block');\r\n    if (first_time_user_block.length > 0) {\r\n      first_time_user_loading = true;\r\n    }\r\n\r\n    if (!first_time_user_loading) {\r\n      if (!guest_user) {\r\n        all_local_resources_table.showTable();\r\n        favorite_local_resources_table.ajax_request();\r\n      }\r\n      else {\r\n        all_local_resources_table.showTable();\r\n      }\r\n    }\r\n\r\n    $(document).on('ee:first_time_user_complete', function () {\r\n      first_time_user_loading = false;\r\n      if (!guest_user) {\r\n        all_local_resources_table.showTable();\r\n        favorite_local_resources_table.ajax_request();\r\n      }\r\n      else {\r\n        all_local_resources_table.showTable();\r\n      }\r\n    });\r\n\r\n    $body.on('click', '#user-lgc-topics-small-view label', function () {\r\n      showFocusedTopicView($(this));\r\n    });\r\n\r\n    $body.on('click', '.manage-my-topics-grid, #add-more-topics', function () {\r\n      loadManageTopicsView();\r\n    });\r\n\r\n    $body.on('click', '.back-to-lgc-widget a, .back-to-lgc-widget .left-arrow',\r\n      function () {\r\n        showLGCResourcesView();\r\n      });\r\n\r\n    $body.on('click', '#restrict-to-local-resources-button', function () {\r\n      updateDropdown($('#user-lgc-topics-small-view'));\r\n    });\r\n\r\n\r\n    // Toggle sidebar expanded / collapsed view\r\n    $body.on('click', '#local-resources-tabs .faceted-filters .toggle a', function(ev) {\r\n      ev.preventDefault();\r\n      var $localResources = $(this).parents('.local.resources');\r\n      $localResources.find('.faceted-filters').toggle();\r\n      $localResources.toggleClass('toggle-open toggle-closed');\r\n    });\r\n\r\n    // Toggle facet expanded / collapsed view\r\n    $body.on('click', '#local-resources-tabs h3 a', function(ev) {\r\n      ev.preventDefault();\r\n      var $h3 = $(this).parents('h3');\r\n      $h3.next().toggle();\r\n      $h3.find('span').toggleClass('on off');\r\n    });\r\n  });\r\n}(jQuery));"]}