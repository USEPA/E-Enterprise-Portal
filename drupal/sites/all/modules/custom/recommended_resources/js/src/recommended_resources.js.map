{"version":3,"sources":["recommended_resources.js"],"names":["clearResources","$children","jQuery","trigger","favorite_local_resources_table","all_local_resources_table","pane_class","manage_components_title","$","showLGCResourcesView","$localResourcesTabs","find","removeClass","updateTopics","showTable","hide","text","show","loadManageTopicsView","ajax","url","beforeSend","html","success","html_view","showFocusedTopicView","$lgc_topic_elem","addClass","id","attr","title","tid_array","split","tid","length","filterTopics","document","ready","openLGCDialog","dialogDiv","dialogTitle","dialogContents","dialog","dialogClass","width","maxHeight","modal","open","parent","prepend","close","$body","guest_user","Drupal","settings","is_guest","has_loaded_initial_user_table","LocalResourcesTable","$tabs","tabs","on","ev","this","focus","first_time_user_loading","first_time_user_block","updateDropdown","preventDefault","$localResources","parents","toggle","toggleClass","$h3","next","input_id","e","stopPropagation","lgcExplained"],"mappings":"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","file":"recommended_resources.js","sourcesContent":["var favorite_local_resources_table, all_local_resources_table;\nvar pane_class = \".pane-views-recommended-resources-block\";\nvar manage_components_title = \"Manage My Profile Topics\";\n\nfunction clearResources() {\n  $children = jQuery('.facet-topic-container:visible a').trigger('click');\n}\n\n(function($) {\n  function showLGCResourcesView() {\n    var $localResourcesTabs = $('#local-resources-tabs');\n    $('#user-lgc-topics-small-view').find('label').removeClass('selected');\n    favorite_local_resources_table.updateTopics([]);\n    favorite_local_resources_table.showTable();\n    $('#manage-my-topics-wrapper').hide();\n    $('.lgc-header').text('');\n    $('.back-to-lgc-widget').hide();\n    $('.unfollow-lgc-topic').hide();\n    $localResourcesTabs.show();\n    $(pane_class).find('.pane-title').show();\n    $(pane_class).find('.ui-tabs-nav').show();\n  }\n\n  /**\n   * Loads manage topics view via an ajax request\n   */\n  function loadManageTopicsView() {\n    var $localResourcesTabs = $('#local-resources-tabs');\n    $.ajax({\n      url: \"manage_my_topics/load_view\",\n      beforeSend: function() {\n        $localResourcesTabs.hide();\n        $(pane_class).find('.pane-title').hide();\n        $('.unfollow-lgc-topic').hide();\n        $('.back-to-lgc-widget').show();\n        $('.lgc-header').text(manage_components_title).show();\n        $('#manage-my-topics-wrapper').html('Loading...').show();\n      },\n      success: function(html_view) {\n        $('#manage-my-topics-wrapper').html(html_view);\n      }\n    });\n  }\n\n  function showFocusedTopicView($lgc_topic_elem) {\n    $lgc_topic_elem.addClass('selected');\n    $(pane_class).find('.pane-title').hide();\n    $(pane_class).find('.ui-tabs-nav').hide();\n    var id = $lgc_topic_elem.attr('id');\n    var title = $lgc_topic_elem.text();\n    var tid_array = id.split('-');\n    var tid = tid_array[tid_array.length - 1];\n    $('.lgc-header').text(title);\n    $('.back-to-lgc-widget').show();\n    $('.unfollow-lgc-topic').attr('id', 'unfollow-lgc-' + tid).show();\n    favorite_local_resources_table.filterTopics(title);\n  }\n\n  $(document).ready(function() {\n    var $body = $('body');\n    var guest_user = Drupal.settings.is_guest;\n    var has_loaded_initial_user_table = true;\n\n    all_local_resources_table = new LocalResourcesTable($(\"#all-local-resources\"), 'generateAllLocalResourcesTable', 'all');\n    // Guest user can only view all the content, so they do not have tabs\n    if (!guest_user) {\n      favorite_local_resources_table = new LocalResourcesTable($(\"#user-local-resources\"), 'generateUserLocalResourcesTable', 'my');\n\n      var $tabs = $(\"#local-resources-tabs\");\n      $tabs.tabs();\n      $tabs.find('.ui-corner-top').on('click', function(ev) {\n        $(this).focus();\n      });\n    }\n\n    // Restrict loading to after first time user preferences if applicable\n    var first_time_user_loading = false;\n    var first_time_user_block = $('#first-time-user-block');\n    if (first_time_user_block.length > 0) {\n      first_time_user_loading = true;\n    }\n\n    if (!first_time_user_loading) {\n      all_local_resources_table.showTable();\n    }\n\n    $(document).on('ee:first_time_user_complete', function() {\n      first_time_user_loading = false;\n      all_local_resources_table.showTable();\n    });\n\n    $body.on('click', '#user-lgc-topics-small-view label', function() {\n      showFocusedTopicView($(this));\n    });\n\n    $body.on('click', '.manage-my-topics-grid, #add-more-topics', function() {\n      loadManageTopicsView();\n    });\n\n    $body.on('click', '.back-to-lgc-widget a, .back-to-lgc-widget .left-arrow',\n      function() {\n        showLGCResourcesView();\n      });\n\n    $body.on('click', '#restrict-to-local-resources-button', function() {\n      if (has_loaded_initial_user_table) {\n        favorite_local_resources_table.showTable();\n        has_loaded_initial_user_table = false;\n      }\n      updateDropdown($('#user-lgc-topics-small-view'));\n    });\n\n    // Toggle sidebar expanded / collapsed view\n    $body.on('click', '#local-resources-tabs .faceted-filters .toggle a', function(ev) {\n      ev.preventDefault();\n      var $localResources = $(this).parents('.local.resources');\n      $localResources.find('.faceted-filters').toggle();\n      $localResources.toggleClass('toggle-open toggle-closed');\n    });\n\n    // Toggle facet expanded / collapsed view\n    $body.on('click', '#local-resources-tabs h3 a', function(ev) {\n      ev.preventDefault();\n      var $h3 = $(this).parents('h3');\n      $h3.next().toggle();\n      $h3.find('span').toggleClass('on off');\n    });\n\n    // Prevent dom from focusing on hidden label and scrolling the widget out of view\n    $body.on('click', '.multiselect-to-checkboxes label', function(ev) {\n      var input_id = $(this).attr('for');\n      $('#' + input_id).trigger('click');\n      ev.preventDefault();\n    });\n    \n    $body.on('click', '#resources-lgc-help', function(e) {\n      e.stopPropagation();\n      var lgcExplained = $('#resources-lgc-about').html();\n      dialogDiv = '#resources-lgc-about';\n      dialogTitle = 'Resources for Local Communities Widget';\n      openLGCDialog(dialogDiv, dialogTitle, lgcExplained); \n    });\n\n    function openLGCDialog(dialogDiv, dialogTitle, dialogContents) {\n      $('body').addClass('modal-open');\n      $(dialogDiv).html(dialogContents);\n      $(dialogDiv).dialog({\n        title: dialogTitle,\n        dialogClass: 'about-dialog',\n        width: 500,\n        maxHeight: 400,\n        modal: true,\n        open: function() {\n          $('#resources-lgc-about').parent().find('span.ui-dialog-title').prepend('<span class=\"modal-title-subtext\">More on the </span>');\n        },           \n        close: function() {\n          $('body').removeClass('modal-open');            \n          $(dialogDiv).dialog('destroy');\n          $(dialogDiv).text('');            \n        }\n      });\n    }\n  });\n}(jQuery));\n"]}