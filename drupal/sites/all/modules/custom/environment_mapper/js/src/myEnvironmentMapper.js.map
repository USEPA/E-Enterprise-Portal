{"version":3,"sources":["myEnvironmentMapper.js"],"names":["$","showMap","logged_in_view","error_view","show","hide","missingZipLatLong","updateMyEnvMapperLoc","data","currentZip","latitude","zipCentLat","String","zipCentLon","longitude","createIframe","iFrameURL","$iframe","src","title","width","height","style","id","html","attr","previousZip","first_time_user_loading","document","ready","first_time_user_block","length","on","evt","zip","jQuery"],"mappings":"CAAA,SAAWA,GACT,YAiCA,SAASC,KACP,GAAIC,GAAiBF,EAAE,yBACnBG,EAAaH,EAAE,oBACnBE,GAAeE,OACfD,EAAWE,OAGb,QAASC,KACP,GAAIJ,GAAiBF,EAAE,yBACnBG,EAAaH,EAAE,oBACnBE,GAAeG,OACfF,EAAWC,OAIb,QAASG,GAAqBC,GAC5B,GAAIC,EACF,GAAID,EAAKE,SAAW,GAAKF,EAAKE,SAAW,GAAI,CAC3C,GAAIC,GAAaC,OAAOJ,EAAKE,UACzBG,EAAaD,OAAOJ,EAAKM,UAC7BC,GAAaJ,EAAYE,GACzBZ,QAEAK,KAoBN,QAASS,GAAaJ,EAAYE,GAChC,GAAIG,GAAY,4GAA8GL,EAAa,IAAME,EAE7II,EAAUjB,EAAE,YACdkB,IAAKF,EACLG,MAAO,mCACPC,MAAO,MACPC,OAAQ,MACRC,MAAO,WACPC,GAAI,eAINvB,GAAE,yBAAyBwB,KAAKP,GAEhCjB,EAAE,kBAAkByB,KAAK,OAAQ,oDAAsDhB,EAAa,UAzFtG,GAAIA,GACAiB,EAGAC,GAA0B,CAE9B3B,GAAE4B,UAAUC,MAAM,WAGhB,GAAIC,GAAwB9B,EAAE,yBAC1B8B,GAAsBC,OAAS,IACjCJ,GAA0B,GAE5B3B,EAAE4B,UAAUI,GAAG,8BAA+B,WAC5CL,GAA0B,IAG5B3B,EAAE4B,UAAUI,GAAG,oBAAqB,SAAUC,EAAKzB,GAC5CmB,IACHlB,EAAaD,EAAK0B,IACC,KAAfzB,GAAqBA,IAAeiB,GACtCnB,EAAqBC,GAEvBkB,EAAcjB,QAqEnB0B","file":"myEnvironmentMapper.js","sourcesContent":["(function ($) {\r\n  \"use strict\";\r\n\r\n  var currentZip;\r\n  var previousZip;\r\n\r\n  // Boolean tracking if a user is selecting first time settings to optimize UX\r\n  var first_time_user_loading = false;\r\n\r\n  $(document).ready(function () {\r\n\r\n\r\n    var first_time_user_block = $('#first-time-user-block');\r\n    if (first_time_user_block.length > 0) {\r\n      first_time_user_loading = true;\r\n    }\r\n    $(document).on('ee:first_time_user_complete', function () {\r\n      first_time_user_loading = false;\r\n    });\r\n\r\n    $(document).on('ee:zipCodeQueried', function (evt, data) {\r\n      if (!first_time_user_loading) {\r\n        currentZip = data.zip;\r\n        if (currentZip !== '' && currentZip !== previousZip) {\r\n          updateMyEnvMapperLoc(data);\r\n        }\r\n        previousZip = currentZip;\r\n      }\r\n    });\r\n\r\n\r\n  });\r\n\r\n\r\n  function showMap() {\r\n    var logged_in_view = $('.embedMyEnv-container');\r\n    var error_view = $('#invalid-location');\r\n    logged_in_view.show();\r\n    error_view.hide();\r\n  }\r\n\r\n  function missingZipLatLong() {\r\n    var logged_in_view = $('.embedMyEnv-container');\r\n    var error_view = $('#invalid-location');\r\n    logged_in_view.hide();\r\n    error_view.show();\r\n\r\n  }\r\n\r\n  function updateMyEnvMapperLoc(data) {\r\n    if (currentZip) {\r\n      if (data.latitude > 0 && data.latitude < 90) {\r\n        var zipCentLat = String(data.latitude);\r\n        var zipCentLon = String(data.longitude);\r\n        createIframe(zipCentLat, zipCentLon);\r\n        showMap();\r\n      } else {\r\n        missingZipLatLong();\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Sets error message if iframe does not load in time\r\n   * @param $iframe\r\n   */\r\n  function iframeUnavailable($iframe) {\r\n    var $error_container = $('.error-loading-enviromapper');\r\n    $error_container.text('Unable to load Environment Mapper.');\r\n    $iframe.remove();\r\n  }\r\n\r\n  /**\r\n   * Creates and appends Iframe\r\n   * @param zipCentLat\r\n   * @param zipCentLon\r\n   */\r\n  function createIframe(zipCentLat, zipCentLon) {\r\n    var iFrameURL = \"https://map11.epa.gov/myem/envmapEEP/mainmap.html?pTheme=all&pLayers=afs,triair,triwater,rcra,tsca&ve=11,\" + zipCentLat + \",\" + zipCentLon;\r\n    //Create Iframe\r\n    var $iframe = $('<iframe>', {\r\n      src: iFrameURL,\r\n      title: 'My EnviroMapper map from EPA.gov',\r\n      width: '800',\r\n      height: '500',\r\n      style: 'border:0',\r\n      id: \"myEnviFrame\"\r\n    });\r\n\r\n    //Load Iframe\r\n    $('.embedMyEnv-container').html($iframe);\r\n    // Update extra details text with new link\r\n    $('#myEnvMoreInfo').attr('href', 'http://www3.epa.gov/myenv/myenview2.find?zipcode=' + currentZip + '&GO=go');\r\n  }\r\n\r\n})(jQuery);\r\n"]}